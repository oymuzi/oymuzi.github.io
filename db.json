{"meta":{"version":1,"warehouse":"2.2.0"},"models":{"Asset":[{"_id":"themes/icarus/source/css/back-to-top.css","path":"css/back-to-top.css","modified":1,"renderable":1},{"_id":"themes/icarus/source/css/insight.css","path":"css/insight.css","modified":1,"renderable":1},{"_id":"themes/icarus/source/css/progressbar.css","path":"css/progressbar.css","modified":1,"renderable":1},{"_id":"themes/icarus/source/css/search.css","path":"css/search.css","modified":1,"renderable":1},{"_id":"themes/icarus/source/css/style.styl","path":"css/style.styl","modified":1,"renderable":1},{"_id":"themes/icarus/source/images/avatar.png","path":"images/avatar.png","modified":1,"renderable":1},{"_id":"themes/icarus/source/images/favicon.svg","path":"images/favicon.svg","modified":1,"renderable":1},{"_id":"themes/icarus/source/images/juejin.png","path":"images/juejin.png","modified":1,"renderable":1},{"_id":"themes/icarus/source/images/logo.svg","path":"images/logo.svg","modified":1,"renderable":1},{"_id":"themes/icarus/source/images/og_image.png","path":"images/og_image.png","modified":1,"renderable":1},{"_id":"themes/icarus/source/images/thumbnail.svg","path":"images/thumbnail.svg","modified":1,"renderable":1},{"_id":"themes/icarus/source/js/animation.js","path":"js/animation.js","modified":1,"renderable":1},{"_id":"themes/icarus/source/js/back-to-top.js","path":"js/back-to-top.js","modified":1,"renderable":1},{"_id":"themes/icarus/source/js/clipboard.js","path":"js/clipboard.js","modified":1,"renderable":1},{"_id":"themes/icarus/source/js/gallery.js","path":"js/gallery.js","modified":1,"renderable":1},{"_id":"themes/icarus/source/js/insight.js","path":"js/insight.js","modified":1,"renderable":1},{"_id":"themes/icarus/source/js/main.js","path":"js/main.js","modified":1,"renderable":1}],"Cache":[{"_id":"themes/icarus/.gitignore","hash":"542aaea07afe90211c6a45c90b7d6879a4503043","modified":1562248252000},{"_id":"themes/icarus/LICENSE","hash":"41f72cd544612bc4589c924c776422b800a4eff7","modified":1562248252000},{"_id":"themes/icarus/README.md","hash":"c351bc76d3b4a138989c50f57bd3c52fa95eaa56","modified":1562248252000},{"_id":"themes/icarus/_config.yml","hash":"93eef0ce9ab94473cd8ae0597e406239a5d71cbc","modified":1562927488858},{"_id":"themes/icarus/package.json","hash":"4167e65682af257bdf8531a05730e6c42339996d","modified":1562248252000},{"_id":"source/_posts/hello-world.md","hash":"ca3834bb3b51aa996d5cb57aa5c520c12f953eb5","modified":1562924656080},{"_id":"source/_posts/åŸºäºSVNæäº¤ä»£ç è‡ªåŠ¨æ‰“åŒ….md","hash":"d0bf6d23f067fba9d1a9effcd4373b73f5a127f8","modified":1562924679927},{"_id":"themes/icarus/.github/ISSUE_TEMPLATE.md","hash":"6b17b84116938367757928087a09dcb8489d06f6","modified":1562248252000},{"_id":"themes/icarus/languages/en.yml","hash":"b69c91878f30937f50438ff64dffd3f6bf91bcf5","modified":1562248252000},{"_id":"themes/icarus/languages/es.yml","hash":"8827823e5b2ce967566854c9bfebc7c69098b4ac","modified":1562248252000},{"_id":"themes/icarus/languages/fr.yml","hash":"0017f93a5d491a9c0e55911cdc35316762c5a94e","modified":1562248252000},{"_id":"themes/icarus/languages/id.yml","hash":"92d2d19a62a17b6e99f82a014309bbf6c13c9ae8","modified":1562248252000},{"_id":"themes/icarus/languages/ja.yml","hash":"6eed7771de2353d71b720c6e605cceb3f230b12e","modified":1562248252000},{"_id":"themes/icarus/languages/ko.yml","hash":"eef426a7d580058024260ccc111476d5b1b688d1","modified":1562248252000},{"_id":"themes/icarus/languages/pt-BR.yml","hash":"bcf5bc81ca855d26bbc3b3bfabc7d84429e74b85","modified":1562248252000},{"_id":"themes/icarus/languages/ru.yml","hash":"ba8b4f7d77eb1d1e28aa1f9107bd0bbbdc4cba99","modified":1562248252000},{"_id":"themes/icarus/languages/tr.yml","hash":"eff1c0b3d5c4b328f6dd74a195ff378c898f4d29","modified":1562248252000},{"_id":"themes/icarus/languages/vn.yml","hash":"6d9f4fabca711a6cb0a0efd72aa75c3641beb4a6","modified":1562248252000},{"_id":"themes/icarus/languages/zh-CN.yml","hash":"804f6a1edee49bb6a5ecb8e9d14d3e93eaca37c0","modified":1562248252000},{"_id":"themes/icarus/languages/zh-TW.yml","hash":"79fab0bff625634fb6bb6cadf9c547bd36226dcf","modified":1562248252000},{"_id":"themes/icarus/layout/archive.ejs","hash":"64a81f4c6ca9517169413408d076371e8e09c63a","modified":1562248252000},{"_id":"themes/icarus/layout/categories.ejs","hash":"29d304f2b95a04fbc5e7529f9bdce9648e3545ef","modified":1562248252000},{"_id":"themes/icarus/layout/category.ejs","hash":"bda344da0e6c03899f53abc20ae2a2efab5ab243","modified":1562248252000},{"_id":"themes/icarus/layout/index.ejs","hash":"71120f41d019bf2866a5556747e5e671c8147f85","modified":1562248252000},{"_id":"themes/icarus/layout/layout.ejs","hash":"69e441c03ecf08016a13e8dd4d39633e3ada5310","modified":1562925259008},{"_id":"themes/icarus/layout/page.ejs","hash":"50170783bac99946ae8af483920568de9b2d9801","modified":1562248252000},{"_id":"themes/icarus/layout/post.ejs","hash":"50170783bac99946ae8af483920568de9b2d9801","modified":1562248252000},{"_id":"themes/icarus/layout/tag.ejs","hash":"1feac7aa842882757a479b8ad427f6a72fce70c4","modified":1562248252000},{"_id":"themes/icarus/layout/tags.ejs","hash":"0c527c6b72386f11c18e8aa5249be8c601e69906","modified":1562248252000},{"_id":"themes/icarus/scripts/index.js","hash":"9203e2ba1f821d945edf20fc277f3c58d22bfd00","modified":1562248252000},{"_id":"themes/icarus/includes/common/ConfigGenerator.js","hash":"451397efc7808787419fa3eb6b043c0bd8bbdf30","modified":1562248252000},{"_id":"themes/icarus/includes/common/ConfigValidator.js","hash":"cd3cd12bc042b401825fd7bfd9a6434c8b14e092","modified":1562248252000},{"_id":"themes/icarus/includes/common/utils.js","hash":"c0aeaeb57a42bcc71a92da2249762f91abd83ffe","modified":1562248252000},{"_id":"themes/icarus/includes/filters/highlight.js","hash":"19a4dcd2dee7388544b57e473cfb0fc9eea9623e","modified":1562248252000},{"_id":"themes/icarus/includes/generators/categories.js","hash":"7cb370ac53a05d6b1b9203579716c0ca83d35c36","modified":1562248252000},{"_id":"themes/icarus/includes/generators/category.js","hash":"313e170e55d74526c4e1be7181ef7a21439147c9","modified":1562248252000},{"_id":"themes/icarus/includes/generators/insight.js","hash":"c4b981443927b87cc14a3a583029e13f819d6d71","modified":1562248252000},{"_id":"themes/icarus/includes/generators/tags.js","hash":"8195322c208706427a1cf56361669dca4d86f6f1","modified":1562248252000},{"_id":"themes/icarus/includes/helpers/cdn.js","hash":"7d34ea6400cb3611c374c135304abcb65ef291b7","modified":1562248252000},{"_id":"themes/icarus/includes/helpers/config.js","hash":"173e02987e7a7d5df1e686f6ee4edd8cf494bdd3","modified":1562248252000},{"_id":"themes/icarus/includes/helpers/layout.js","hash":"afdf5e9704cfc087526b4a0403fe7eb04f22190e","modified":1562248252000},{"_id":"themes/icarus/includes/helpers/override.js","hash":"726cf99612fd060753d9da08db2776aec1802e20","modified":1562248252000},{"_id":"themes/icarus/includes/helpers/page.js","hash":"4ce98c781bcbc132672e6d16bf02df5bebcea7b3","modified":1562248252000},{"_id":"themes/icarus/includes/helpers/site.js","hash":"35dd41260dce178a171f6c360fa6d3840bfb1507","modified":1562248252000},{"_id":"themes/icarus/includes/specs/article.spec.js","hash":"a805c1a6f03ccb07d73512aef40d38541ddbb0eb","modified":1562248252000},{"_id":"themes/icarus/includes/specs/comment.spec.js","hash":"b0ef033e363b918134fb5a003143e9bd8fafa300","modified":1562248252000},{"_id":"themes/icarus/includes/specs/config.spec.js","hash":"7a9bac384a73cf9f39173fdb2dfc2813784d8891","modified":1562248252000},{"_id":"themes/icarus/includes/specs/donate.spec.js","hash":"722cb2662569957e8b1d1a467d9632b8cc6e69d6","modified":1562248252000},{"_id":"themes/icarus/includes/specs/footer.spec.js","hash":"8e6d7c5f9a13ce03241b6562259d210b389cb88e","modified":1562248252000},{"_id":"themes/icarus/includes/specs/icon_link.spec.js","hash":"f2a83ac5ccb74fc6f3dfbd25430e142297d8491c","modified":1562248252000},{"_id":"themes/icarus/includes/specs/meta.spec.js","hash":"28863042ad8fcf9ecb86d5288ecd3ce5250a984d","modified":1562248252000},{"_id":"themes/icarus/includes/specs/navbar.spec.js","hash":"7de29c0031738a4de4d31ed4f7b0c43447c7961c","modified":1562248252000},{"_id":"themes/icarus/includes/specs/plugins.spec.js","hash":"2f33728c24d3076dbbd48a7aeb467d2600d07577","modified":1562248252000},{"_id":"themes/icarus/includes/specs/providers.spec.js","hash":"820cc6936ba75e3104cc2e8641716ed65ada8b6f","modified":1562248252000},{"_id":"themes/icarus/includes/specs/search.spec.js","hash":"1e3995cdc471e6a2817cd45e2b6f0fd39b4540ec","modified":1562248252000},{"_id":"themes/icarus/includes/specs/share.spec.js","hash":"5ec65409a17ead13974140fc5ddc19e526586d9f","modified":1562248252000},{"_id":"themes/icarus/includes/specs/sidebar.spec.js","hash":"630c9701affe2549abc61cd4d1e5153af2224fb6","modified":1562248252000},{"_id":"themes/icarus/includes/specs/widgets.spec.js","hash":"48ceaab9ef8221bfffd7baabc57c4d6de7240750","modified":1562248252000},{"_id":"themes/icarus/includes/tasks/check_config.js","hash":"ce7626d643737c90dee6b75435ccdec26b89dacf","modified":1562248252000},{"_id":"themes/icarus/includes/tasks/check_deps.js","hash":"cfc357f27116d1b9285a3b0bec35c3e89ae73711","modified":1562248252000},{"_id":"themes/icarus/includes/tasks/welcome.js","hash":"00d1ef8c9609552b82e9a5140b838a9057c59508","modified":1562248252000},{"_id":"themes/icarus/layout/comment/changyan.ejs","hash":"9ccc7ec354b968e60bdcfcd1dba451d38de61f12","modified":1562248252000},{"_id":"themes/icarus/layout/comment/disqus.ejs","hash":"b5fff46e453d58baa20028a47fd85923494bb85c","modified":1562248252000},{"_id":"themes/icarus/layout/comment/facebook.ejs","hash":"b38ea86a1cae48f671501af74d7f109f63fb3d72","modified":1562248252000},{"_id":"themes/icarus/layout/comment/gitalk.ejs","hash":"8a9172d7c9a8f050dc978a06e0f0998ba2e9c61a","modified":1562248252000},{"_id":"themes/icarus/layout/comment/gitment.ejs","hash":"886026a36495f3c57cdef46bc9e9a94a0e390eb0","modified":1562248252000},{"_id":"themes/icarus/layout/comment/isso.ejs","hash":"cc6a43bd24be764086f88ad7c5c97ff04df87e0b","modified":1562248252000},{"_id":"themes/icarus/layout/comment/livere.ejs","hash":"12ff9a345f6bba2f732f592e39508c2afde89b00","modified":1562248252000},{"_id":"themes/icarus/layout/comment/valine.ejs","hash":"a29cf2e69f66a37ddcec8343c60af1e676dcb77d","modified":1562248252000},{"_id":"themes/icarus/layout/common/article.ejs","hash":"76e4b72b62cf3e34227980aa8c7161ee27b57a7a","modified":1562248252000},{"_id":"themes/icarus/layout/common/footer.ejs","hash":"dc91946bfe2c25507927cffc7f97fb445e839462","modified":1562248252000},{"_id":"themes/icarus/layout/common/head.ejs","hash":"6bedbb14d9e79b88b0010436e506d763709efa26","modified":1562248252000},{"_id":"themes/icarus/layout/common/navbar.ejs","hash":"5082ea45df0f79f955143177287d92bcf3832fcf","modified":1562248252000},{"_id":"themes/icarus/layout/common/paginator.ejs","hash":"7837d80b27f166161b3deeffb571680025c7d723","modified":1562248252000},{"_id":"themes/icarus/layout/common/scripts.ejs","hash":"5414d6bfbf88efa7e72ccf7e44a79d0378ddeb77","modified":1562248252000},{"_id":"themes/icarus/layout/common/widget.ejs","hash":"5417af9f208d2fb5aaeb96031caa261e9683557c","modified":1562248252000},{"_id":"themes/icarus/layout/donate/alipay.ejs","hash":"3290058879973e403a05472a0fe2ac0219d5b961","modified":1562248252000},{"_id":"themes/icarus/layout/donate/patreon.ejs","hash":"8e52a9c28ffaf4b0b786a20977b848c5f60f2274","modified":1562248252000},{"_id":"themes/icarus/layout/donate/paypal.ejs","hash":"3975dee39f9378975b9c10f37d118ad7cb6f5bf6","modified":1562248252000},{"_id":"themes/icarus/layout/donate/wechat.ejs","hash":"051b873e1fc28c1d7c2d6443991b6a2f43813e6b","modified":1562248252000},{"_id":"themes/icarus/layout/plugin/animejs.ejs","hash":"198062ef863c96aa4d6a8225d575afcb60dfb1d1","modified":1562248252000},{"_id":"themes/icarus/layout/plugin/back-to-top.ejs","hash":"79d1118a3d3ebc521ffce452b986b504f0e7d6b7","modified":1562248252000},{"_id":"themes/icarus/layout/plugin/baidu-analytics.ejs","hash":"eb66e313ad43ec4424b2d75bae94e5c8a7568428","modified":1562248252000},{"_id":"themes/icarus/layout/plugin/busuanzi.ejs","hash":"205dedf8f97e328bb3182dc8daebd2e2b2204aca","modified":1562248252000},{"_id":"themes/icarus/layout/plugin/clipboard.ejs","hash":"8662ed9c211f3993b93eedcf5e41c2a1ddbede57","modified":1562248252000},{"_id":"themes/icarus/layout/plugin/gallery.ejs","hash":"ad68fafd923747d6b7c1b5873d00989d1639678c","modified":1562248252000},{"_id":"themes/icarus/layout/plugin/google-analytics.ejs","hash":"282cecb28ac458b71b56cf429c72ffac0f820199","modified":1562248252000},{"_id":"themes/icarus/layout/plugin/hotjar.ejs","hash":"2b97737d802984750a7b4461fcf68818a57a2439","modified":1562248252000},{"_id":"themes/icarus/layout/plugin/mathjax.ejs","hash":"667aabb6b9cb4d707b37975af794d4a3c66b5264","modified":1562248252000},{"_id":"themes/icarus/layout/plugin/outdated-browser.ejs","hash":"fe051093893c64c8575bcc67dc1c146d409e8e80","modified":1562248252000},{"_id":"themes/icarus/layout/plugin/progressbar.ejs","hash":"e594ed6705bccbef27f49d84b6153f6443efbecd","modified":1562248252000},{"_id":"themes/icarus/layout/search/baidu.ejs","hash":"850aa91778100d693a52b10eaa8586c8e3215ee6","modified":1562248252000},{"_id":"themes/icarus/layout/search/google-cse.ejs","hash":"4b881a99325a6a0cebf97ac53e09d8fc67f87d29","modified":1562248252000},{"_id":"themes/icarus/layout/search/insight.ejs","hash":"9a27db2a007582ceee7ca4b1eebddbd456893568","modified":1562248252000},{"_id":"themes/icarus/layout/share/addthis.ejs","hash":"f1c5f337333009d5f00dfbac4864a16ef8f9cb8d","modified":1562248252000},{"_id":"themes/icarus/layout/share/addtoany.ejs","hash":"04cb247d8c83ca7c5b52f3b11bb3ac155b1bc3ab","modified":1562248252000},{"_id":"themes/icarus/layout/share/bdshare.ejs","hash":"f14c8084b7ee16a091f0bd2ae9039e3bfff7e7b7","modified":1562248252000},{"_id":"themes/icarus/layout/share/sharejs.ejs","hash":"65d08316cc479910ea4f526cd1c299d0104daf7f","modified":1562248252000},{"_id":"themes/icarus/layout/share/sharethis.ejs","hash":"4f2c40f790f3be0a4e79db04f02ea41ba2f4d4c0","modified":1562248252000},{"_id":"themes/icarus/layout/widget/category.ejs","hash":"c2a9f2211a21a168c54b0563cdfd58bd25fa39fe","modified":1562248252000},{"_id":"themes/icarus/layout/widget/archive.ejs","hash":"eb738a2ac2935ce7a542964d90088613b281dd15","modified":1562248252000},{"_id":"themes/icarus/layout/widget/links.ejs","hash":"2b707fd65c94b00d8b4c6755fbc6c19709f3d49a","modified":1562248252000},{"_id":"themes/icarus/layout/widget/profile.ejs","hash":"ef66b06afb0c350901c7d55e091d1b2718540706","modified":1562248252000},{"_id":"themes/icarus/layout/widget/recent_posts.ejs","hash":"2166f3190e47bf4746775b5d16654564a88c2041","modified":1562248252000},{"_id":"themes/icarus/layout/widget/tag.ejs","hash":"8c5b8020ca776cc3ebbc7b723915f3173efc28d4","modified":1562248252000},{"_id":"themes/icarus/layout/widget/tagcloud.ejs","hash":"d32e7c56e8e2074da16d9141f9a597841d28d07d","modified":1562248252000},{"_id":"themes/icarus/layout/widget/toc.ejs","hash":"bdc6f22602cdabe7c740f1818e0681ff8508fb64","modified":1562248252000},{"_id":"themes/icarus/source/css/back-to-top.css","hash":"5805bee2445e997d64dfe526b08b5fe0bce357eb","modified":1562248252000},{"_id":"themes/icarus/source/css/insight.css","hash":"22943a610d5cfffedfb823c692f4db2b1f37a4c9","modified":1562248252000},{"_id":"themes/icarus/source/css/progressbar.css","hash":"bbc737b7a8feb19901e792c447a846273779d5c3","modified":1562248252000},{"_id":"themes/icarus/source/css/search.css","hash":"d6a59894819e7431d42b249b6c2fc9ff3b99a488","modified":1562248252000},{"_id":"themes/icarus/source/css/style.styl","hash":"14d07e24e2effe13b53d6c29e750552fdb67bd82","modified":1562927227385},{"_id":"themes/icarus/source/images/avatar.png","hash":"0d8236dcca871735500e9d06bbdbe0853ed6775b","modified":1562248252000},{"_id":"themes/icarus/source/images/favicon.svg","hash":"16fd847265845063a16596761cddb32926073dd2","modified":1562248252000},{"_id":"themes/icarus/source/images/juejin.png","hash":"70c54971ab8fe2427b19a3ac7d4d470d3b5a9078","modified":1562901146966},{"_id":"themes/icarus/source/images/logo.svg","hash":"e9b5c1438ddb576693a15d0713b2a1d9ceda4be9","modified":1562248252000},{"_id":"themes/icarus/source/images/og_image.png","hash":"b03f163096ca9c350ec962feee9836277b5c2509","modified":1562248252000},{"_id":"themes/icarus/source/images/thumbnail.svg","hash":"b9c58ff09ed415e6cf08b42b35faa2bc000d5059","modified":1562248252000},{"_id":"themes/icarus/source/js/animation.js","hash":"d744581909d2d092a584be07c39f9d3f0d009ec7","modified":1562248252000},{"_id":"themes/icarus/source/js/back-to-top.js","hash":"b1dcf30577cefe833dc6151757c0a05ea5b5a643","modified":1562248252000},{"_id":"themes/icarus/source/js/clipboard.js","hash":"6fdd602268727744b6b2c8ad79d684aab3cffda5","modified":1562248252000},{"_id":"themes/icarus/source/js/gallery.js","hash":"88b23abfc3b519413be54533ed0f39e0c68fcdd1","modified":1562248252000},{"_id":"themes/icarus/source/js/insight.js","hash":"8ba56fd5e4232a05ccef5f8b733c7ecca0814633","modified":1562248252000},{"_id":"themes/icarus/source/js/main.js","hash":"7ff7b7fcde5f6d17e0bb5a2a6baf3633c6420c0c","modified":1562248252000}],"Category":[],"Data":[],"Page":[],"Post":[{"title":"Hello World","date":"2019-05-04T09:55:23.000Z","toc":true,"_content":"Welcome to [Hexo](https://hexo.io/)! This is your very first post. Check [documentation](https://hexo.io/docs/) for more info. If you get any problems when using Hexo, you can find the answer in [troubleshooting](https://hexo.io/docs/troubleshooting.html) or you can ask me on [GitHub](https://github.com/hexojs/hexo/issues).\n\n<!-- more -->\n## Quick Start\n\n### Create a new post\n\n``` bash\n$ hexo new \"My New Post\"\n```\n\nMore info: [Writing](https://hexo.io/docs/writing.html)\n\n### Run server\n\n``` bash\n$ hexo server\n```\n\nMore info: [Server](https://hexo.io/docs/server.html)\n\n### Generate static files\n\n``` bash\n$ hexo generate\n```\n\nMore info: [Generating](https://hexo.io/docs/generating.html)\n\n### Deploy to remote sites\n\n``` bash\n$ hexo deploy\n```\n\nMore info: [Deployment](https://hexo.io/docs/deployment.html)\n","source":"_posts/hello-world.md","raw":"---\ntitle: Hello World\ndate: 2019-05-04 17:55:23\ntoc: true\n---\nWelcome to [Hexo](https://hexo.io/)! This is your very first post. Check [documentation](https://hexo.io/docs/) for more info. If you get any problems when using Hexo, you can find the answer in [troubleshooting](https://hexo.io/docs/troubleshooting.html) or you can ask me on [GitHub](https://github.com/hexojs/hexo/issues).\n\n<!-- more -->\n## Quick Start\n\n### Create a new post\n\n``` bash\n$ hexo new \"My New Post\"\n```\n\nMore info: [Writing](https://hexo.io/docs/writing.html)\n\n### Run server\n\n``` bash\n$ hexo server\n```\n\nMore info: [Server](https://hexo.io/docs/server.html)\n\n### Generate static files\n\n``` bash\n$ hexo generate\n```\n\nMore info: [Generating](https://hexo.io/docs/generating.html)\n\n### Deploy to remote sites\n\n``` bash\n$ hexo deploy\n```\n\nMore info: [Deployment](https://hexo.io/docs/deployment.html)\n","slug":"hello-world","published":1,"updated":"2019-07-12T09:44:16.080Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjxzyop200000eqfygoor6dar","content":"<p>Welcome to <a href=\"https://hexo.io/\" target=\"_blank\" rel=\"noopener\">Hexo</a>! This is your very first post. Check <a href=\"https://hexo.io/docs/\" target=\"_blank\" rel=\"noopener\">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href=\"https://hexo.io/docs/troubleshooting.html\" target=\"_blank\" rel=\"noopener\">troubleshooting</a> or you can ask me on <a href=\"https://github.com/hexojs/hexo/issues\" target=\"_blank\" rel=\"noopener\">GitHub</a>.</p>\n<a id=\"more\"></a>\n<h2 id=\"Quick-Start\"><a href=\"#Quick-Start\" class=\"headerlink\" title=\"Quick Start\"></a>Quick Start</h2><h3 id=\"Create-a-new-post\"><a href=\"#Create-a-new-post\" class=\"headerlink\" title=\"Create a new post\"></a>Create a new post</h3><figure class=\"highlight bash hljs\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo new <span class=\"hljs-string\">\"My New Post\"</span></span><br></pre></td></tr></table></figure>\n\n<p>More info: <a href=\"https://hexo.io/docs/writing.html\" target=\"_blank\" rel=\"noopener\">Writing</a></p>\n<h3 id=\"Run-server\"><a href=\"#Run-server\" class=\"headerlink\" title=\"Run server\"></a>Run server</h3><figure class=\"highlight bash hljs\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo server</span><br></pre></td></tr></table></figure>\n\n<p>More info: <a href=\"https://hexo.io/docs/server.html\" target=\"_blank\" rel=\"noopener\">Server</a></p>\n<h3 id=\"Generate-static-files\"><a href=\"#Generate-static-files\" class=\"headerlink\" title=\"Generate static files\"></a>Generate static files</h3><figure class=\"highlight bash hljs\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo generate</span><br></pre></td></tr></table></figure>\n\n<p>More info: <a href=\"https://hexo.io/docs/generating.html\" target=\"_blank\" rel=\"noopener\">Generating</a></p>\n<h3 id=\"Deploy-to-remote-sites\"><a href=\"#Deploy-to-remote-sites\" class=\"headerlink\" title=\"Deploy to remote sites\"></a>Deploy to remote sites</h3><figure class=\"highlight bash hljs\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo deploy</span><br></pre></td></tr></table></figure>\n\n<p>More info: <a href=\"https://hexo.io/docs/deployment.html\" target=\"_blank\" rel=\"noopener\">Deployment</a></p>\n","site":{"data":{}},"excerpt":"<p>Welcome to <a href=\"https://hexo.io/\" target=\"_blank\" rel=\"noopener\">Hexo</a>! This is your very first post. Check <a href=\"https://hexo.io/docs/\" target=\"_blank\" rel=\"noopener\">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href=\"https://hexo.io/docs/troubleshooting.html\" target=\"_blank\" rel=\"noopener\">troubleshooting</a> or you can ask me on <a href=\"https://github.com/hexojs/hexo/issues\" target=\"_blank\" rel=\"noopener\">GitHub</a>.</p>","more":"<h2 id=\"Quick-Start\"><a href=\"#Quick-Start\" class=\"headerlink\" title=\"Quick Start\"></a>Quick Start</h2><h3 id=\"Create-a-new-post\"><a href=\"#Create-a-new-post\" class=\"headerlink\" title=\"Create a new post\"></a>Create a new post</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo new <span class=\"string\">\"My New Post\"</span></span><br></pre></td></tr></table></figure>\n\n<p>More info: <a href=\"https://hexo.io/docs/writing.html\" target=\"_blank\" rel=\"noopener\">Writing</a></p>\n<h3 id=\"Run-server\"><a href=\"#Run-server\" class=\"headerlink\" title=\"Run server\"></a>Run server</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo server</span><br></pre></td></tr></table></figure>\n\n<p>More info: <a href=\"https://hexo.io/docs/server.html\" target=\"_blank\" rel=\"noopener\">Server</a></p>\n<h3 id=\"Generate-static-files\"><a href=\"#Generate-static-files\" class=\"headerlink\" title=\"Generate static files\"></a>Generate static files</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo generate</span><br></pre></td></tr></table></figure>\n\n<p>More info: <a href=\"https://hexo.io/docs/generating.html\" target=\"_blank\" rel=\"noopener\">Generating</a></p>\n<h3 id=\"Deploy-to-remote-sites\"><a href=\"#Deploy-to-remote-sites\" class=\"headerlink\" title=\"Deploy to remote sites\"></a>Deploy to remote sites</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo deploy</span><br></pre></td></tr></table></figure>\n\n<p>More info: <a href=\"https://hexo.io/docs/deployment.html\" target=\"_blank\" rel=\"noopener\">Deployment</a></p>"},{"title":"iOS-åŸºäºSVNæäº¤ä»£ç è‡ªåŠ¨æ‰“åŒ…","date":"2019-03-02T11:04:34.000Z","toc":true,"_content":"\n### å‰è¨€\n\nä¹‹å‰å†™è¿‡ä¸€ç¯‡[åŸºäºJenkinså’ŒFastlaneè‡ªåŠ¨æ‰“åŒ…](https://juejin.im/post/5ca8c81e6fb9a05e6668ab56)çš„æ–‡ç« ï¼Œæ–‡ä¸­ç®€è¿°äº†å¾ˆå¤šçš„çš„ç¯å¢ƒæ­å»ºä»¥åŠä¸€äº›é‡åˆ°çš„é—®é¢˜ã€‚è¿™ç¯‡æ–‡ç« çš„ç›®çš„æ˜¯ä½¿ç”¨è„šæœ¬å’Œ**Jenkins**æ¥è‡ªåŠ¨æ‰“åŒ…ï¼Œä¸ºä½•ä¸åœ¨ä½¿ç”¨ä¹‹å‰çš„**Fastlane**å‘¢ï¼Ÿé¦–å…ˆ**Fastlane**æ˜¯å¾ˆä¸é”™çš„ï¼Œä¹Ÿæ˜¯ä½¿ç”¨**xcodebuild**å‘½ä»¤æ¥å°è£…å®ç°çš„ï¼Œä½†æ˜¯åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­ä¼šæ¶‰åŠåˆ°ä¸€ä¸ªè„šæœ¬çš„è¿ç§»èƒ½åŠ›å³è¿ç”¨åˆ°å…¶ä»–é¡¹ç›®ä¸Šï¼Œæˆ‘è®¤ä¸ºæ˜¯ä¸ç®—é«˜çš„ï¼Œè‡³å°‘åœ¨**Jenkins**ä¸Šã€‚åæ­£**Fastlane**ä¹Ÿæ˜¯åŸºäº**xcodebuild**æ¥è¿›è¡Œç¼–è¯‘æ‰“åŒ…çš„ï¼Œé‚£æˆ‘ä»¬ä½•ä¸ç›´æ¥ç¼–å†™è„šæœ¬è¿›è¡Œæ‰“åŒ…å‘¢ï¼Ÿ\n<!-- more -->\n\nè¿˜æœ‰ä¸€ä¸ªé—®é¢˜å°±æ˜¯å¤§å®¶éƒ½çŸ¥é“ä½¿ç”¨**Git**åŸºäº**Jenkins**çš„è‡ªåŠ¨åŒ–æ‰“åŒ…å¯ä»¥ç›´æ¥åœ¨æ¯æ¬¡æäº¤æ—¶å®ç°è‡ªåŠ¨æ‰“åŒ…ï¼Œä½†æ˜¯åœ¨**Jenkins**ä¸­ä½¿ç”¨**SVN**æˆ‘ä»¬æ²¡æœ‰å‘ç°ç±»ä¼¼è¿™ä¸ªåŠŸèƒ½çš„æ’ä»¶ã€‚æ–‡ä¸­çš„è§£å†³åŠæ³•æ˜¯ä¸€ç§æ›²çº¿æ•‘å›½çš„æ–¹æ³•ï¼Œåœ¨æ–‡ç« çš„ä¸‹åŠéƒ¨åˆ†ä¼šè®²åˆ°ã€‚æˆ‘ä¸€å¼€å§‹çš„æ„æ€è¿˜æ˜¯æƒ³é€šè¿‡å±€åŸŸç½‘æ¥å®ç°ï¼Œä½†æ˜¯è¶Šåˆ°åé¢å‘ç°è¡Œä¸é€šï¼Œæ²¡æœ‰æ„Ÿè§‰åˆ°è‡ªåŠ¨æ‰“åŒ…å¸¦æ¥çš„ä¾¿åˆ©ã€‚**äºæ˜¯æœ‰äº†æœ¬æ–‡è¿™ä¸ªæ–¹æ¡ˆ**ã€‚\n\n\n\n### å‡†å¤‡\n\nâ‘ è¯·ç¡®ä¿æ‰“åŒ…ç”µè„‘çš„ç¯å¢ƒå·²ç»å®‰è£…å¥½äº†HomeBrewã€Jenkins(å»ºè®®ä½¿ç”¨brewå®‰è£…Jenkinså¹¶è¿›è¡Œå¼€æœºè‡ªå¯åŠ¨)\n\nâ‘¡è¯·ç¡®ä¿æ‰“åŒ…ç”µè„‘çš„è¦æ˜¯ä¸²ä¸­æœ‰ä½ éœ€è¦æ‰“åŒ…çš„APPæ‰€éœ€çš„è¯ä¹¦ã€æè¿°æ–‡ä»¶\n\nâ‘¢è¯·ç¡®ä¿æ­¤æ‰“åŒ…è„šæœ¬ç”¨äºåŸºäºæäº¤SVNå’ŒJenkinsç¯å¢ƒä¸­è‡ªåŠ¨æ‰“åŒ…ï¼Œå¦åˆ™å°†ä¼šå¯¼è‡´è„šæœ¬ä¸å¯ç”¨çš„çŠ¶æ€ğŸ˜‚ğŸ˜‚\n\n\n\n### æ‰“åŒ…ç»“æ„\n\nå…·ä½“çš„ç»“æ„å¯ä»¥å‚ç…§ä¸‹å›¾ï¼Œå¦‚æœæœ‰å…¶ä»–çš„ç±»å‹çš„æ‰“åŒ…ï¼Œå¯ä»¥åœ¨Plistæ–‡ä»¶å¤¹ä¸­æ·»åŠ æ–°çš„plistæ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶å¯ä»¥åœ¨æ‰‹åŠ¨æ‰“åŒ…æ—¶å¯¼å‡ºçš„æ–‡ä»¶å¤¹é‡Œæœ‰xxxExportOptions.plistæ–‡ä»¶ã€‚ç„¶ååœ¨é…ç½®æ–‡ä»¶é‡Œé¢è¿›è¡Œæ›´æ”¹ç±»å‹ã€‚\n\n![](http://cloud.minder.mypup.cn/blog/%E8%87%AA%E5%8A%A8%E6%89%93%E5%8C%85%E7%BB%93%E6%9E%84%E5%9B%BE.jpg)\n\n\n\n#### å‰æˆ\n\nä¿®æ”¹é…ç½®æ–‡ä»¶å°±èƒ½ç›´æ¥æ§åˆ¶æ‰“åŒ…ç±»å‹æ˜¯ä¸æ˜¯å¾ˆæ–¹ä¾¿ã€‚ä¸€å¼€å§‹é‡‡ç”¨jsonæ–‡ä»¶æ¥è¿›è¡Œé…ç½®ï¼Œä½¿ç”¨jsonæ–‡ä»¶çš„è¯å¯¹æˆ‘æ¥è¯´æœ‰ä¸¤ä¸ªç¼ºç‚¹ã€‚å…¶ä¸€å°±æ˜¯jsonæ–‡ä»¶ä¸­æ— æ³•è¿›è¡Œæ³¨é‡Šï¼Œè¿™ä¼šå¯¼è‡´åé¢æ¥æ‰‹çš„äººæ— æ³•æ˜ç™½å…¶æ„ï¼Œæˆ–è€…éœ€è¦åœ¨æ·»åŠ ä¸€ä¸ªè¯´æ˜æ–‡æ¡£ï¼›å…¶äºŒæ˜¯å› ä¸ºåœ¨ä½¿ç”¨jsoné…ç½®è·¯å¾„çš„æ—¶å€™è¿˜éœ€è¦å¯¹å€¼è¿›è¡Œå»é™¤åŒå¼•å·ï¼Œå¯ä»¥å®ç°å¾ˆéº»çƒ¦ã€‚å¦å¤–å°±æ˜¯Shellè§£æjsonæ•°æ®è¿˜æ˜¯æœ‰ç‚¹éº»çƒ¦ï¼Œä½¿ç”¨jqè§£ææŒºæ–¹ä¾¿å°±æ˜¯å¾—é…ç½®ä¸€ä¸‹ç¯å¢ƒã€‚å…¶ä¸­global.configä»£ç å¦‚ä¸‹ï¼š\n\n```\n\n\t#æ˜¯å¦éœ€è¦æ‰“åŒ…\n\tis_need_package=true\n\n\t#ç”Ÿäº§ç¯å¢ƒ/å¼€å‘ç¯å¢ƒè¯ä¹¦è®¾ç½®\n\tcode_sign_distribution=\"iPhone Distribution: xxxx xxx (xxx)\"\n\tcode_sign_development=\"iPhone Developer: xxxx xxxx (xxx)\"\n\n\t#é¡¹ç›®çš„target/schemeè®¾ç½® \n\tpackage_target_name=\"xxx\"\n\tpackage_scheme_name=\"xxx\"\n\n\t#æ‰“åŒ…ç»“æœæ ¹ç›®å½•\n\tpackage_root_path=/Users/xxx/Desktop/Package/\n\t#æ‰“åŒ…ipaç›®å½•\n\tpackage_archive_path=/Users/xxx/Desktop/Package/Archive/\n\n\t#æ‰“åŒ…ç±»å‹  AdHocï¼š1 AppStoreï¼š2  Enterpriseï¼š3  Developmentï¼š4\n\tpackage_export_type=1\n\t#æ‰“åŒ…å­˜æ”¾çš„xxxExportOptions.plistæ–‡ä»¶å¤¹\n\tpackage_export_options_dir_path=./AutoPacking/Plist/\n\n\t#æ˜¯å¦ä½¿ç”¨workspaceè¿›è¡Œæ‰“åŒ…\n\tpackage_use_workspace=true\n\t#æ˜¯å¦ä½¿ç”¨Releaseæ¨¡å¼è¿›è¡Œæ‰“åŒ…\n\tpackage_use_release=true\n\n\t#è®°å½•æ‰“åŒ…å‰ç¼€\n\trecord_perfix=\"CEG\"\n```\n\n\n\næ˜¯ä¸æ˜¯è§‰å¾—å¾ˆç®€å•ï¼Œä½†æ˜¯é˜…è¯»æ€§ä¸æ˜¯å¾ˆé«˜å§ï¼Œ åœ¨Xcodeä¸­æ²¡æœ‰é«˜äº®æ˜¾ç¤ºï¼Œéƒ½æ˜¯ä¸€ä¸ªè‰²å®¹æ˜“çŠ¯å›°ã€‚ä½†æ˜¯ä½¿ç”¨è¶…çº§ç®€å•\n\n```\nsource global.config\n```\n\næ˜¯ä¸æ˜¯å¾ˆç®€å•ï¼ŒğŸ˜€ğŸ˜€ï¼Œåªéœ€è¦ä¸€ä¸ªå‘½ä»¤ï¼Œå³å¯è·å¾—å…¨éƒ¨çš„å…¨å±€å˜é‡ï¼Œ$is_need_packageå°±èƒ½è·å¾—å€¼ï¼Œè·¯å¾„ä¹Ÿæ˜¯ï¼Œæ‰€ä»¥æˆ‘é€‰æ‹©äº†è¿™ç§æ–¹å¼æ¥è¿›è¡Œåšé…ç½®æ–‡ä»¶ï¼Œå¯¹ä¸åŒçš„äººæœ‰ä¸åŒçš„æ•ˆæœï¼Œå¯¹æˆ‘ä¸ç†Ÿæ‚‰è„šæœ¬çš„äººçœŸçš„å¤ªæœ‰å¥½äº†ã€‚æœ‰ä¸ªæ³¨æ„ç‚¹å°±æ˜¯ä¸€è¡Œåªèƒ½å†™ä¸€ä¸ªå˜é‡ï¼Œå¹¶ä¸”å˜é‡å’Œå€¼ä¹‹é—´åªèƒ½æœ‰ç­‰äºå·ï¼Œä¸èƒ½æœ‰ç©ºæ ¼å·æ¥è¿›è¡Œå¯¹é½ğŸ¤¡ğŸ¤¡ï¼Œæ˜¯ä¸æ˜¯è§‰å¾—è¿æœ€åçš„ç¾åŒ–æœºä¼šéƒ½æ²¡æœ‰å•¦ğŸ˜ã€‚å…¶å®ä¹ æƒ¯å°±å¥½ã€‚ğŸ™‚\n\n\n\n#### åæˆ\n\nå°ä¼™å­åˆ«ç›¯ç€çœ‹æ ‡é¢˜å“ˆï¼Œæ€æƒ³å¾ˆå±é™©å“ˆğŸ˜…ï¼Œæˆ‘ä¸æ˜¯æ¥å¼€è½¦çš„ï¼Œè¯´å®Œé…ç½®æ–‡ä»¶å°±è¯¥è¯´è¯´è¿™ä¸ªæ‰“åŒ…è„šæœ¬äº†ã€‚è¿˜è®°å¾—å‡†å¤‡å·¥ä½œä¸­è¯´äº†è¦åœ¨**SVN**ä¸­å—ï¼Œå› ä¸ºç”¨åˆ°äº†Jenkinsä¸­å…¨å±€æ„å»ºå‚æ•°**SVN_REVISION**,å¦å¤–çœ‹è¿™ä¸ªè„šæœ¬å…¶å®æœ‰ç‚¹çƒ¦ï¼Œå› ä¸ºå¾ˆå¤§éƒ¨åˆ†ä»£ç æ˜¯åœ¨åšå‰æˆå·¥ä½œğŸ˜‰ğŸ˜‰ï¼ŒçœŸæ­£**xcodebuild**å‘½ä»¤åœ¨æœ«å°¾äº†ã€‚å¦å¤–æˆ‘å†™è„šæœ¬å–œæ¬¢éƒ½æ˜¯å°å†™ï¼Œå…¨å¤§å†™çš„çœ‹ç€å¤´ç—›å•Šï¼Œ æ‰€ä»¥æˆ‘ä¹Ÿä¸çŸ¥é“è¿™ç¬¦ä¸ç¬¦åˆè„šæœ¬çš„ä»£ç è§„èŒƒå§ï¼Œä½†æ˜¯è‡ªæˆ‘æ„Ÿè§‰è‰¯å¥½ğŸ˜ğŸ˜ã€‚\n\n```\n#!/bin/sh\n\n# å½“å‰shellæ‰€å¤„çš„ç›®å½•\nshell_dir_path=$(cd \"$(dirname \"$0\")\"; pwd)\n\n# æŠŠé…ç½®æ–‡ä»¶é‡Œçš„å‚æ•°åœ¨è¯¥è„šæœ¬é‡Œå…¨å±€åŒ–\nsource $shell_dir_path\"/global.config\"\n\necho \"å¼€å§‹æ£€æŸ¥ç¯å¢ƒ...........\"\n\n# å¦‚æœå½’æ¡£æ–‡ä»¶å¤¹ä¸å­˜åœ¨åˆ™åˆ›å»º\nif [ ! -d $package_root_path ]; then\n    mkdir -pv $package_root_path\nfi\n\n# å¦‚æœä¸å­˜åœ¨è®°å½•æ–‡ä»¶åˆ™åˆ›å»ºï¼Œå­˜åœ¨æ–‡ä»¶åˆ™æŠŠæ–‡ä»¶å†…å®¹å˜é‡åŠ å…¥åˆ°å…¨å±€å˜é‡\nif [ -e $package_root_path\"result.txt\" ]; then\n    source $package_root_path\"result.txt\"\n    # åˆ¤æ–­svnæœ€åæäº¤ä¿¡æ¯æ˜¯å¦å·²ç»å½’æ¡£è¿‡ï¼Œå…¶ä¸­SVN_REVISIONæ˜¯SVNæäº¤æ—¶çš„ç¼–å·ï¼Œæ”¹å˜é‡\n    # æ˜¯Jenkinsæä¾›çš„\n    if [ $lastestBuildVersion = $SVN_REVISION ] ; then\n        echo \"è¯¥ç‰ˆæœ¬å·²ç»æ‰“è¿‡åŒ…äº†ï¼Œè¯·é‡æ–°æäº¤ä¸€æ¬¡è®°å½•å¹¶ç¡®ä¿is_need_packageä¸ºtrue\"\n        exit 1\n    else\n        # ä¸ºäº†èŠ‚çœç©ºé—´ï¼Œæ‰€ä»¥æ¯æ¬¡æ‰“åŒ…éƒ½ä¼šåœ¨å¼€å§‹å‰ç§»é™¤ä¹‹å‰æ–‡ä»¶\n        rm -rf $package_archive_path*\n        echo \"ç§»é™¤æ—§é¡¹ç›®å®Œæ¯•ï¼Œå‡†å¤‡å·¥ä½œå·²å°±ç»ª\"\n    fi\nelse\n    # åˆ›å»ºè®°å½•æ–‡æ¡£\n    touch $package_root_path\"/result.txt\"\n    chmod -R 777 $package_root_path\"/result.txt\"\n    echo lastestBuildVersion=0 >> $package_root_path\"/result.txt\"\n\nfi\n\n# æ£€æŸ¥æ˜¯å¦éœ€è¦æ‰“åŒ…\nif ! $is_need_package; then\n    exit 1\nfi\n\n# æ£€æŸ¥æ˜¯å¦è®¾ç½®target/scheme\nif test -z $package_target_name; then\n\techo \"âŒ é¡¹ç›®Targetè®¾ç½®ä¸ºç©º\"\n\texit 1\nfi\n\nif test -z $package_scheme_name; then\n\techo \"âŒ é¡¹ç›®Schemeè®¾ç½®ä¸ºç©º\"\n\texit 1\nfi\n\n# è¯»å–é…ç½®æ–‡ä»¶å½’æ¡£ç±»å‹æ˜¯Releaseè¿˜æ˜¯Debug\nif $package_use_release; then\n    build_configuration=\"Release\"\nelse\n    build_configuration=\"Debug\"\nfi\n\n\n#  AdHoc: 1, AppStore: 2, Enterprise: 3, Development: 4\n# å¯¼å‡ºipaåŒ…çš„plistæ–‡ä»¶å¤¹ï¼Œè¯¥æ–‡ä»¶åœ¨æ‰“åŒ…æ—¶ä¼šç”Ÿæˆ\noptions_dir_path=$package_export_options_dir_path\nif [[ $package_export_type -eq 1 ]]; then\n    export_options_plist_path=$options_dir_path\"AdHocExportOptions.plist\"\n    export_type_name=\"AdHoc\"\nelif [[ $package_export_type -eq 2 ]]; then\n    export_options_plist_path=$options_dir_path\"AppStoreExportOptions.plist\"\n    export_type_name=\"AppStore\"\nelif [[ $package_export_type -eq 3 ]]; then\n    export_options_plist_path=$options_dir_path\"EnterpriseExportOptions.plist\"\n    export_type_name=\"Enterprise\"\nelif [[ $package_export_type -eq 4 ]]; then\n    export_options_plist_path=$options_dir_path\"DevelopmentExportOptions.plist\"\n    export_type_name=\"Development\"\nfi\n\necho \"âœ…âœ…âœ… æ ¡éªŒå‚æ•°ä»¥åŠç¯å¢ƒæˆåŠŸ\"\necho \"âš¡ï¸ âš¡ï¸ âš¡ï¸å³å°†å¼€å§‹æ‰“åŒ… âš¡ï¸ âš¡ï¸ âš¡ï¸\"\n\n##############################è‡ªåŠ¨æ‰“åŒ…éƒ¨åˆ†##############################\n\n# è¿”å›åˆ°å·¥ç¨‹ç›®å½•\ncd ../\nproject_path=`pwd`\n\n# è·å–é¡¹ç›®åç§°\nproject_name=`find . -name *.xcodeproj | awk -F \"[/.]\" '{print $(NF-1)}'`\n# æŒ‡å®šå·¥ç¨‹çš„Info.plist\ncurrent_info_plist_name=\"Info.plist\"\n# é…ç½®Info.plistçš„è·¯å¾„\ncurrent_info_plist_path=\"${project_name}/${current_info_plist_name}\"\n# è·å–é¡¹ç›®çš„ç‰ˆæœ¬å·\nbundle_version=`/usr/libexec/PlistBuddy -c \"Print CFBundleShortVersionString\" ${current_info_plist_path}`\n# è·å–é¡¹ç›®çš„ç¼–è¯‘ç‰ˆæœ¬å·\nbundle_build_version=`/usr/libexec/PlistBuddy -c \"Print CFBundleVersion\" ${current_info_plist_path}`\n\n# å½“å‰ç‰ˆæœ¬å­˜æ”¾å¯¼å‡ºæ–‡ä»¶è·¯å¾„ï¼Œå¯ä»¥æ ¹æ®éœ€æ±‚æ·»åŠ ä¸åŒçš„è·¯å¾„\ncurrentVersionArchivePath=\"${package_archive_path}\"\n\n# åˆ¤æ–­å½’æ¡£å½“å‰ç‰ˆæœ¬æ–‡ä»¶å¤¹æ˜¯å¦å­˜åœ¨ï¼Œä¸å­˜åœ¨åˆ™åˆ›å»º\nif [ ! -d $currentVersionArchivePath ]; then\n    mkdir -pv $currentVersionArchivePath\n    chmod -R 777 $currentVersionArchivePath\nfi\n\n# å½’æ¡£æ–‡ä»¶è·¯å¾„\nexport_archive_path=\"${currentVersionArchivePath}${package_scheme_name}.xcarchive\"\n# ipaå¯¼å‡ºè·¯å¾„\nexport_ipa_path=\"${currentVersionArchivePath}\"\n# è·å–æ—¶é—´ å¦‚:20190630_1420\n# current_date=\"$(date +%Y%m%d_%H%M)\"\n# ipa åå­—, å¯ä»¥æ ¹æ®ç‰ˆæœ¬å·æ¥è¿›è¡Œé‡å‘½å\nipa_name=\"${package_scheme_name}_${SVN_REVISION}.ipa\"\n\necho \"å·¥ç¨‹ç›®å½• = ${project_path}\"\necho \"å·¥ç¨‹Info.plistè·¯å¾„ = ${current_info_plist_path}\"\necho \"æ‰“åŒ…ç±»å‹ = ${build_configuration}\"\necho \"æ‰“åŒ…ä½¿ç”¨çš„plistæ–‡ä»¶è·¯å¾„ = ${export_options_plist_path}\"\n\n###############################æ‰“åŒ…éƒ¨åˆ†#########################################\n\necho \"ğŸ”†ğŸ”†ğŸ”†æ­£åœ¨ä¸ºæ‚¨å¼€å§‹æ‰“åŒ…ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€\"\n\n# æ˜¯å¦ä½¿ç”¨xxx.xcworkspaceå·¥ç¨‹æ–‡ä»¶è¿›è¡Œæ‰“åŒ…\nif $package_use_workspace; then\n\n    if [[ ${build_configuration} == \"Debug\" ]]; then\n        # 1. Clean\n        xcodebuild clean  -workspace ${project_name}.xcworkspace \\\n        -scheme ${package_scheme_name} \\\n        -configuration ${build_configuration}\n\n        # 2. Archive\n        xcodebuild archive  -workspace ${project_name}.xcworkspace \\\n        -scheme ${package_scheme_name} \\\n        -configuration ${build_configuration} \\\n        -archivePath ${export_archive_path} \\\n        CFBundleVersion=${bundle_build_version} \\\n        -destination generic/platform=ios \\\n\n    elif [[ ${build_configuration} == \"Release\" ]]; then\n\n        # 1. Clean\n        xcodebuild clean  -workspace ${project_name}.xcworkspace \\\n        -scheme ${package_scheme_name} \\\n        -configuration ${build_configuration}\n\n        # 2. Archive\n        xcodebuild archive  -workspace ${project_name}.xcworkspace \\\n        -scheme ${package_scheme_name} \\\n        -configuration ${build_configuration} \\\n        -archivePath ${export_archive_path} \\\n        CFBundleVersion=${bundle_build_version} \\\n        -destination generic/platform=ios \\\n\n    fi\n\nelse\n\n    if [[ ${build_configuration} == \"Debug\" ]] ; then\n        # 1. Clean\n        xcodebuild clean  -project ${project_name}.xcodeproj \\\n        -scheme ${package_scheme_name} \\\n        -configuration ${build_configuration} \\\n        -alltargets\n\n        # 2. Archive\n        xcodebuild archive  -project ${project_name}.xcodeproj \\\n        -scheme ${package_scheme_name} \\\n        -configuration ${build_configuration} \\\n        -archivePath ${export_archive_path} \\\n        CFBundleVersion=${bundle_build_version} \\\n        -destination generic/platform=ios \\\n\n    elif [[ ${build_configuration} == \"Release\" ]]; then\n        # 1. Clean\n        xcodebuild clean  -project ${project_name}.xcodeproj \\\n        -scheme ${package_scheme_name} \\\n        -configuration ${build_configuration} \\\n        -alltargets\n\n        # 2. Archive\n        xcodebuild archive  -project ${project_name}.xcodeproj \\\n        -scheme ${package_scheme_name} \\\n        -configuration ${build_configuration} \\\n        -archivePath ${export_archive_path} \\\n        CFBundleVersion=${bundle_build_version} \\\n        -destination generic/platform=ios \\\n\n    fi\nfi\n\n# æ£€æŸ¥æ˜¯å¦æ„å»ºæˆåŠŸ\n# å› ä¸ºxxx.xcarchive æ˜¯ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸æ˜¯ä¸€ä¸ªæ–‡ä»¶\nif [ -d ${export_archive_path} ]; then\n    echo \"ğŸš€ ğŸš€ ğŸš€ é¡¹ç›®æ„å»ºæˆåŠŸ ğŸš€ ğŸš€ ğŸš€\"\nelse\n    echo \"âš ï¸ âš ï¸ âš ï¸ é¡¹ç›®æ„å»ºå¤±è´¥ âš ï¸ âš ï¸ âš ï¸\"\n    exit 1\nfi\n\necho \"å¼€å§‹å¯¼å‡ºipaæ–‡ä»¶\"\n# å¯¼å‡ºipaæ–‡ä»¶\nxcodebuild -exportArchive -archivePath ${export_archive_path} \\\n-exportPath ${export_ipa_path} \\\n-destination generic/platform=ios \\\n-exportOptionsPlist ${export_options_plist_path} \\\n-allowProvisioningUpdates\n# é»˜è®¤å¯¼å‡ºipaæ–‡ä»¶è·¯å¾„\nexport_ipa_name=$export_ipa_path$package_scheme_name\".ipa\"\n\n# åˆ¤æ–­æ˜¯å¦æœ‰è¿™ä¸ªå¯¼å‡ºipaæ–‡ä»¶\nif [ -e $export_ipa_name ]; then\n    # æ›´æ”¹åç§°ä¸º scheme_version.ipa schemeåç§°ä¸ºå·¥ç¨‹åç§°ï¼Œversionä¸ºsvnæœ€åæäº¤çš„ç‰ˆæœ¬\n    mv $export_ipa_name $export_ipa_path$ipa_name\n    # å°†å½“å‰ç‰ˆæœ¬è®¾ä¸ºå·²æ‰“åŒ…çŠ¶æ€\n    echo lastestBuildVersion=$SVN_REVISION > $package_root_path\"result.txt\"\n    echo \"ğŸ‰ ğŸ‰ ğŸ‰ å¯¼å‡º ${ipa_name}.ipa åŒ…æˆåŠŸ ğŸ‰ ğŸ‰ ğŸ‰\"\nelse\n    echo \"âŒ âŒ âŒ å¯¼å‡º ${ipa_name}.ipa åŒ…å¤±è´¥ âŒ âŒ âŒ\"\nfi\n\n# è¾“å‡ºæ‰“åŒ…æ€»ç”¨æ—¶\necho \"æœ¬æ¬¡æ‰“åŒ…æ€»è€—æ—¶: ${SECONDS}s\"\n```\n\næ˜¯ä¸æ˜¯æœ‰ç‚¹å¤´æ™•å“‡ï¼Œæˆ‘æ˜¯å¤´ç—›å•ŠğŸ¤—ğŸ¤—ï¼Œç©è¿‡ä½¿ç”¨**Jenkins**è„šæœ¬è‡ªåŠ¨æ‰“åŒ…çš„äººçœ‹å®Œè¿™ä¸ªåº”è¯¥çŸ¥é“æˆ‘çš„æ›²çº¿æ•‘å›½æ–¹å¼äº†ï¼Œæœ‰çš„åŒå­¦è‚¯å®šè¿˜åœ¨ğŸ˜³ğŸ˜³orğŸ¤”ğŸ¤”ã€‚æˆ‘ä»¬åœ¨**é‡å¤´æˆ**ä¸­è®²ğŸ¤—ğŸ¤—ã€‚\n\n\n\n### é‡å¤´æˆ\n\nçœ‹é£æ ¼æˆ‘å°±ä¸æ˜¯å¼€è½¦çš„äººï¼Œå› ä¸ºå¼€è½¦å“ªæ¥è¿™ä¹ˆå¤šå‰æˆæ˜¯å§ï¼ŸğŸ¤”ğŸ¤”ï¼Œå¼€å§‹å‰¥ä¸æŠ½èŒ§å•¦ã€‚\n\nå‰é¢è¯´åˆ°åœ¨**Jenkins**ä¸­æ²¡æœ‰ç±»ä¼¼**Git**è¿™æ ·çš„æäº¤ä»£ç è‡ªåŠ¨æ‰“åŒ…çš„é’©å­æ’ä»¶ã€‚è€Œæˆ‘ä»¬ä½¿ç”¨**Jenkins**çš„ç›®çš„å°±æ˜¯ä¸ºäº†é‡Šæ”¾ç¨‹åºå‘˜çš„ğŸ‘ï¼Œç•™ç€æ›´å¤šæ—¶é—´å¹²æ­£äº‹ï¼Œå¦‚æœä¸èƒ½å®ç°æäº¤è‡ªåŠ¨æ‰“åŒ…é‚£æœ‰æ— **Jenkins**éƒ½ä¸€æ ·äº†ï¼Œè¿˜ä¸å¦‚è‡ªå·±å†™ä¸ªè„šæœ¬æ‰“åŒ…å‘¢ï¼Œæ˜¯å§ï¼Ÿå¦‚æœæ˜¯ä½ ä½ ä¼šæ€ä¹ˆåšå‘¢ï¼Ÿ\n\næˆ‘ä»¬çŸ¥é“Jenkinsæœ‰ä¸ªå®šæœŸæ‰§è¡Œä»»åŠ¡çš„é€‰é¡¹ï¼Œæˆ‘ä»¬åªéœ€å¡«ä¸Šå‚æ•°ï¼šH/2 * * * *  ç„¶åå°±ä¼šæ¯ä¸¤åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ï¼Œæ˜¯ä¸æ˜¯æƒ³è¯´ä¸ºå•¥ä¸è®¾ç½®1åˆ†é’Ÿï¼Œæˆ‘ä¹Ÿæƒ³å“‡ï¼Œ**Jenkins**ä¸è®©å•ŠğŸ˜ğŸ˜ã€‚ä½†æ˜¯æ€»ä¸èƒ½è®©è¿™å®¶ä¼™æ¯ä¸¤åˆ†é’Ÿä¸€ç›´æ‰“å§ï¼Œè¦†ç›–è¿˜å¥½ï¼Œä½†æ˜¯æ¯ä¸¤åˆ†é’Ÿå°±æœ‰ä¸€ä¸ªæ–°çš„å®‰è£…åŒ…ä¸Šä¼ è‡³æµ‹è¯•æœåŠ¡å™¨ä¹Ÿä¸å¥½å§ï¼Œæ„Ÿè§‰ä¼šè¢«æµ‹è¯•äººå‘˜æ‰“å±ğŸ˜±ğŸ˜±ã€‚é‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦è§£å†³è¿™ä¸ªæ‰“æ–­æ‰“åŒ…çš„æ¡ä»¶ğŸ¤”ã€‚æ—¢ä¸èƒ½åœ¨å·¥ç¨‹ä¸­è®¾ç½®ï¼Œä¸ç„¶**Jenkins**æ¯æ¬¡æ‰§è¡Œä»»åŠ¡å°±è¦†ç›–äº†ï¼Œä¹Ÿå°±æ˜¯åªèƒ½åœ¨æ‰“åŒ…ç”µè„‘ä¸Šä¿å­˜ä¸€ä¸ªçŠ¶æ€ã€‚é‚£ä¹ˆå¾ˆå¥½è§£å†³å•¦ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨è„šæœ¬ä¸­åˆ›å»ºä¸€ä¸ªæ–‡ä»¶æ¥è®°å½•ä¸Šæ¬¡æ‰“åŒ…çš„**SVN_REVISION**ï¼Œå°±èƒ½è®©è„šæœ¬è¯»å–æ–‡ä»¶è®°å½•åˆ¤æ–­æ˜¯å¦å·²ç»æ‰“è¿‡åŒ…äº†ï¼Œæ²¡æœ‰æ‰“è¿‡åŒ…æ‰æ‰§è¡Œç¨‹åºï¼Œå¦åˆ™é€€å‡ºç¨‹åºã€‚ğŸ˜‰ğŸ˜‰ç°åœ¨æƒ³æƒ³æ˜¯ä¸æ˜¯å¾ˆç®€å•å“‡ï¼Œç„¶åå°±å¯ä»¥å°½æƒ…çš„å“’å“’å“’ã€‚\n\n\n\nä½¿ç”¨FTPä¸Šä¼ è‡³æµ‹è¯•æœåŠ¡å™¨è¿™éƒ¨åˆ†è¯¥å¦‚ä½•è§£å†³å‘¢ï¼Ÿå› ä¸ºæ¶‰åŠåˆ°å¯å˜å‚æ•°ï¼Œè„šæœ¬é‚£ä¹ˆå·®çš„æˆ‘åªèƒ½ä½¿ç”¨åœŸåŠæ³•ï¼Œä¸€æ‹›ä¸€æ‹›æ¥ï¼Œå¹²åˆ°ä¸æœä¸ºæ­¢ğŸ˜ğŸ˜ã€‚è¿™éƒ¨åˆ†è„šæœ¬æ˜¯ä¸Šé¢é‚£é•¿ä¸²ä»£ç çš„æœ«å°¾åçš„ä»£ç ã€‚\n\n```\n############################ä¸Šä¼ éƒ¨åˆ†#####################################\n\nfunction createUploadShell(){\n    touch upload.sh\n    chmod -R 777 upload.sh\n    echo \"cd ${package_archive_path}\" >> upload.sh\n    echo \"ftp -i -n -v << !\" >> upload.sh\n    echo \"open 117.xx.xxx.xxx\" >> upload.sh\n    echo \"user oymuzi xxxx\" >> upload.sh\n    echo \"cd ./${upload_dir_path}\" >> upload.sh\n    current_date=\"$(date +%Y%m%d%H%M%S)\"\n    ipa_new_name=$package_scheme_name\"_\"$current_date\".ipa\"\n    echo \"binary\" >> upload.sh\n    echo \"put ${upload_volumes_name}${package_archive_path}${ipa_name} ./${ipa_new_name}\" >> upload.sh\n    echo \"close\" >> upload.sh\n    echo \"bye\" >> upload.sh\n    echo \"!\" >> upload.sh\n}\n\ncd $package_archive_path\ncreateUploadShell\necho \"åˆ›å»ºä¸Šä¼ è„šæœ¬æˆåŠŸ\"\n\necho \"ğŸš€ ğŸš€ ğŸš€ å¼€å§‹ä¸Šä¼ è‡³äº‘ç«¯  ğŸš€ ğŸš€ ğŸš€\"\nsh upload.sh\necho \"ä¸Šä¼ è‡³äº‘ç«¯å®Œæˆ\"\n\nrm -f upload.sh\n```\n\nå¯¹ï¼Œå°±æ˜¯è¿™ä¹ˆfeel å€çˆ½ï¼Œå¤§ä½¬å¯ä»¥è‡ªå·±è¿›è¡Œæ›´æ”¹è„šæœ¬ã€‚å…¶ä¸­ä¸€ç‚¹å°±æ˜¯ä½¿ç”¨FTPå‘½ä»¤å¿…é¡»ä½¿ç”¨`ftp -i -n -v << !  ä½ æƒ³è¦çš„æ‰§è¡Œçš„FTPå‘½ä»¤  !`ã€‚è‡³äºä¸Šä¼ å…¬å¸æœåŠ¡å™¨è¿˜æ˜¯è’²å…¬è‹±ç­‰å¹³å°ï¼Œè¿™ä¸ªå¯ä»¥æ ¹æ®å„è‡ªå…¬å¸çš„è§„åˆ™å§ï¼Œè‡ªå·±è¿›è¡Œä¿®æ”¹å“ˆã€‚\n\n\n\næºç åœ°å€ï¼š[OMPackaging](<https://github.com/oymuzi/OMPackaging>)(æ³¨ï¼šæ­¤demoä»…ä¸ºäº†å±•ç¤ºæºç ï¼ŒæŒ‰ç…§æºç å’Œæ–‡ç« æ‰€è¯´çš„åŠæ³•è®¾ç½®ç¯å¢ƒå³å¯æ­£å¸¸æ‰“åŒ…)\n\n\n\n### è¨€å½’æ­£ä¼ \n\nåˆ©ç”¨**Jenkins**çš„å®šæ­»æ‰§è¡Œä»»åŠ¡åŠŸèƒ½ï¼Œåœ¨æœ¬åœ°ä¿å­˜ä¸€ä¸ªæ‰“åŒ…çš„çŠ¶æ€ï¼Œç„¶åå°±èƒ½æ¯æ¬¡æäº¤ä»£ç åè¿›è¡Œè‡ªåŠ¨æ‰“åŒ…ï¼Œæœ‰1-2åˆ†é’Ÿçš„å»¶è¿Ÿï¼Œè€Œä¸”è¦æ‰§è¡Œæ‰“åŒ…å¿…é¡»ç¡®ä¿é…ç½®æ–‡ä»¶ä¸­çš„`is_need_package`ä¸ºtrueå¹¶æäº¤ä¸€æ¬¡ä»£ç ã€‚åœ¨ä¸Šä¼ è‡³æµ‹è¯•æœåŠ¡å™¨ï¼Œæµ‹è¯•äººå‘˜å°±èƒ½ç›´æ¥ä¸‹è½½å®‰è£…ã€‚è¿™ä¸ªæ–¹æ¡ˆè™½ç„¶æœ‰äº›å»¶è¿Ÿï¼Œä½†æ˜¯è§£å†³äº†è‡ªåŠ¨æ‰“åŒ…çš„é—®é¢˜ã€‚\n\n\n\n\n\nå‚è€ƒï¼š\n\n[Mac shell ä¸Šä¼ æ–‡ä»¶(åœ¨shellä¸­ä½¿ç”¨FTPå‘½ä»¤)](https://blog.csdn.net/weixinyi21cn/article/details/79151620)\n\n[Building from the Command Line with Xcode FAQ](https://developer.apple.com/library/archive/technotes/tn2339/_index.html)\n\n","source":"_posts/åŸºäºSVNæäº¤ä»£ç è‡ªåŠ¨æ‰“åŒ….md","raw":"---\ntitle: iOS-åŸºäºSVNæäº¤ä»£ç è‡ªåŠ¨æ‰“åŒ…\ndate: 2019-03-02 19:04:34\ntoc: true\n---\n\n### å‰è¨€\n\nä¹‹å‰å†™è¿‡ä¸€ç¯‡[åŸºäºJenkinså’ŒFastlaneè‡ªåŠ¨æ‰“åŒ…](https://juejin.im/post/5ca8c81e6fb9a05e6668ab56)çš„æ–‡ç« ï¼Œæ–‡ä¸­ç®€è¿°äº†å¾ˆå¤šçš„çš„ç¯å¢ƒæ­å»ºä»¥åŠä¸€äº›é‡åˆ°çš„é—®é¢˜ã€‚è¿™ç¯‡æ–‡ç« çš„ç›®çš„æ˜¯ä½¿ç”¨è„šæœ¬å’Œ**Jenkins**æ¥è‡ªåŠ¨æ‰“åŒ…ï¼Œä¸ºä½•ä¸åœ¨ä½¿ç”¨ä¹‹å‰çš„**Fastlane**å‘¢ï¼Ÿé¦–å…ˆ**Fastlane**æ˜¯å¾ˆä¸é”™çš„ï¼Œä¹Ÿæ˜¯ä½¿ç”¨**xcodebuild**å‘½ä»¤æ¥å°è£…å®ç°çš„ï¼Œä½†æ˜¯åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­ä¼šæ¶‰åŠåˆ°ä¸€ä¸ªè„šæœ¬çš„è¿ç§»èƒ½åŠ›å³è¿ç”¨åˆ°å…¶ä»–é¡¹ç›®ä¸Šï¼Œæˆ‘è®¤ä¸ºæ˜¯ä¸ç®—é«˜çš„ï¼Œè‡³å°‘åœ¨**Jenkins**ä¸Šã€‚åæ­£**Fastlane**ä¹Ÿæ˜¯åŸºäº**xcodebuild**æ¥è¿›è¡Œç¼–è¯‘æ‰“åŒ…çš„ï¼Œé‚£æˆ‘ä»¬ä½•ä¸ç›´æ¥ç¼–å†™è„šæœ¬è¿›è¡Œæ‰“åŒ…å‘¢ï¼Ÿ\n<!-- more -->\n\nè¿˜æœ‰ä¸€ä¸ªé—®é¢˜å°±æ˜¯å¤§å®¶éƒ½çŸ¥é“ä½¿ç”¨**Git**åŸºäº**Jenkins**çš„è‡ªåŠ¨åŒ–æ‰“åŒ…å¯ä»¥ç›´æ¥åœ¨æ¯æ¬¡æäº¤æ—¶å®ç°è‡ªåŠ¨æ‰“åŒ…ï¼Œä½†æ˜¯åœ¨**Jenkins**ä¸­ä½¿ç”¨**SVN**æˆ‘ä»¬æ²¡æœ‰å‘ç°ç±»ä¼¼è¿™ä¸ªåŠŸèƒ½çš„æ’ä»¶ã€‚æ–‡ä¸­çš„è§£å†³åŠæ³•æ˜¯ä¸€ç§æ›²çº¿æ•‘å›½çš„æ–¹æ³•ï¼Œåœ¨æ–‡ç« çš„ä¸‹åŠéƒ¨åˆ†ä¼šè®²åˆ°ã€‚æˆ‘ä¸€å¼€å§‹çš„æ„æ€è¿˜æ˜¯æƒ³é€šè¿‡å±€åŸŸç½‘æ¥å®ç°ï¼Œä½†æ˜¯è¶Šåˆ°åé¢å‘ç°è¡Œä¸é€šï¼Œæ²¡æœ‰æ„Ÿè§‰åˆ°è‡ªåŠ¨æ‰“åŒ…å¸¦æ¥çš„ä¾¿åˆ©ã€‚**äºæ˜¯æœ‰äº†æœ¬æ–‡è¿™ä¸ªæ–¹æ¡ˆ**ã€‚\n\n\n\n### å‡†å¤‡\n\nâ‘ è¯·ç¡®ä¿æ‰“åŒ…ç”µè„‘çš„ç¯å¢ƒå·²ç»å®‰è£…å¥½äº†HomeBrewã€Jenkins(å»ºè®®ä½¿ç”¨brewå®‰è£…Jenkinså¹¶è¿›è¡Œå¼€æœºè‡ªå¯åŠ¨)\n\nâ‘¡è¯·ç¡®ä¿æ‰“åŒ…ç”µè„‘çš„è¦æ˜¯ä¸²ä¸­æœ‰ä½ éœ€è¦æ‰“åŒ…çš„APPæ‰€éœ€çš„è¯ä¹¦ã€æè¿°æ–‡ä»¶\n\nâ‘¢è¯·ç¡®ä¿æ­¤æ‰“åŒ…è„šæœ¬ç”¨äºåŸºäºæäº¤SVNå’ŒJenkinsç¯å¢ƒä¸­è‡ªåŠ¨æ‰“åŒ…ï¼Œå¦åˆ™å°†ä¼šå¯¼è‡´è„šæœ¬ä¸å¯ç”¨çš„çŠ¶æ€ğŸ˜‚ğŸ˜‚\n\n\n\n### æ‰“åŒ…ç»“æ„\n\nå…·ä½“çš„ç»“æ„å¯ä»¥å‚ç…§ä¸‹å›¾ï¼Œå¦‚æœæœ‰å…¶ä»–çš„ç±»å‹çš„æ‰“åŒ…ï¼Œå¯ä»¥åœ¨Plistæ–‡ä»¶å¤¹ä¸­æ·»åŠ æ–°çš„plistæ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶å¯ä»¥åœ¨æ‰‹åŠ¨æ‰“åŒ…æ—¶å¯¼å‡ºçš„æ–‡ä»¶å¤¹é‡Œæœ‰xxxExportOptions.plistæ–‡ä»¶ã€‚ç„¶ååœ¨é…ç½®æ–‡ä»¶é‡Œé¢è¿›è¡Œæ›´æ”¹ç±»å‹ã€‚\n\n![](http://cloud.minder.mypup.cn/blog/%E8%87%AA%E5%8A%A8%E6%89%93%E5%8C%85%E7%BB%93%E6%9E%84%E5%9B%BE.jpg)\n\n\n\n#### å‰æˆ\n\nä¿®æ”¹é…ç½®æ–‡ä»¶å°±èƒ½ç›´æ¥æ§åˆ¶æ‰“åŒ…ç±»å‹æ˜¯ä¸æ˜¯å¾ˆæ–¹ä¾¿ã€‚ä¸€å¼€å§‹é‡‡ç”¨jsonæ–‡ä»¶æ¥è¿›è¡Œé…ç½®ï¼Œä½¿ç”¨jsonæ–‡ä»¶çš„è¯å¯¹æˆ‘æ¥è¯´æœ‰ä¸¤ä¸ªç¼ºç‚¹ã€‚å…¶ä¸€å°±æ˜¯jsonæ–‡ä»¶ä¸­æ— æ³•è¿›è¡Œæ³¨é‡Šï¼Œè¿™ä¼šå¯¼è‡´åé¢æ¥æ‰‹çš„äººæ— æ³•æ˜ç™½å…¶æ„ï¼Œæˆ–è€…éœ€è¦åœ¨æ·»åŠ ä¸€ä¸ªè¯´æ˜æ–‡æ¡£ï¼›å…¶äºŒæ˜¯å› ä¸ºåœ¨ä½¿ç”¨jsoné…ç½®è·¯å¾„çš„æ—¶å€™è¿˜éœ€è¦å¯¹å€¼è¿›è¡Œå»é™¤åŒå¼•å·ï¼Œå¯ä»¥å®ç°å¾ˆéº»çƒ¦ã€‚å¦å¤–å°±æ˜¯Shellè§£æjsonæ•°æ®è¿˜æ˜¯æœ‰ç‚¹éº»çƒ¦ï¼Œä½¿ç”¨jqè§£ææŒºæ–¹ä¾¿å°±æ˜¯å¾—é…ç½®ä¸€ä¸‹ç¯å¢ƒã€‚å…¶ä¸­global.configä»£ç å¦‚ä¸‹ï¼š\n\n```\n\n\t#æ˜¯å¦éœ€è¦æ‰“åŒ…\n\tis_need_package=true\n\n\t#ç”Ÿäº§ç¯å¢ƒ/å¼€å‘ç¯å¢ƒè¯ä¹¦è®¾ç½®\n\tcode_sign_distribution=\"iPhone Distribution: xxxx xxx (xxx)\"\n\tcode_sign_development=\"iPhone Developer: xxxx xxxx (xxx)\"\n\n\t#é¡¹ç›®çš„target/schemeè®¾ç½® \n\tpackage_target_name=\"xxx\"\n\tpackage_scheme_name=\"xxx\"\n\n\t#æ‰“åŒ…ç»“æœæ ¹ç›®å½•\n\tpackage_root_path=/Users/xxx/Desktop/Package/\n\t#æ‰“åŒ…ipaç›®å½•\n\tpackage_archive_path=/Users/xxx/Desktop/Package/Archive/\n\n\t#æ‰“åŒ…ç±»å‹  AdHocï¼š1 AppStoreï¼š2  Enterpriseï¼š3  Developmentï¼š4\n\tpackage_export_type=1\n\t#æ‰“åŒ…å­˜æ”¾çš„xxxExportOptions.plistæ–‡ä»¶å¤¹\n\tpackage_export_options_dir_path=./AutoPacking/Plist/\n\n\t#æ˜¯å¦ä½¿ç”¨workspaceè¿›è¡Œæ‰“åŒ…\n\tpackage_use_workspace=true\n\t#æ˜¯å¦ä½¿ç”¨Releaseæ¨¡å¼è¿›è¡Œæ‰“åŒ…\n\tpackage_use_release=true\n\n\t#è®°å½•æ‰“åŒ…å‰ç¼€\n\trecord_perfix=\"CEG\"\n```\n\n\n\næ˜¯ä¸æ˜¯è§‰å¾—å¾ˆç®€å•ï¼Œä½†æ˜¯é˜…è¯»æ€§ä¸æ˜¯å¾ˆé«˜å§ï¼Œ åœ¨Xcodeä¸­æ²¡æœ‰é«˜äº®æ˜¾ç¤ºï¼Œéƒ½æ˜¯ä¸€ä¸ªè‰²å®¹æ˜“çŠ¯å›°ã€‚ä½†æ˜¯ä½¿ç”¨è¶…çº§ç®€å•\n\n```\nsource global.config\n```\n\næ˜¯ä¸æ˜¯å¾ˆç®€å•ï¼ŒğŸ˜€ğŸ˜€ï¼Œåªéœ€è¦ä¸€ä¸ªå‘½ä»¤ï¼Œå³å¯è·å¾—å…¨éƒ¨çš„å…¨å±€å˜é‡ï¼Œ$is_need_packageå°±èƒ½è·å¾—å€¼ï¼Œè·¯å¾„ä¹Ÿæ˜¯ï¼Œæ‰€ä»¥æˆ‘é€‰æ‹©äº†è¿™ç§æ–¹å¼æ¥è¿›è¡Œåšé…ç½®æ–‡ä»¶ï¼Œå¯¹ä¸åŒçš„äººæœ‰ä¸åŒçš„æ•ˆæœï¼Œå¯¹æˆ‘ä¸ç†Ÿæ‚‰è„šæœ¬çš„äººçœŸçš„å¤ªæœ‰å¥½äº†ã€‚æœ‰ä¸ªæ³¨æ„ç‚¹å°±æ˜¯ä¸€è¡Œåªèƒ½å†™ä¸€ä¸ªå˜é‡ï¼Œå¹¶ä¸”å˜é‡å’Œå€¼ä¹‹é—´åªèƒ½æœ‰ç­‰äºå·ï¼Œä¸èƒ½æœ‰ç©ºæ ¼å·æ¥è¿›è¡Œå¯¹é½ğŸ¤¡ğŸ¤¡ï¼Œæ˜¯ä¸æ˜¯è§‰å¾—è¿æœ€åçš„ç¾åŒ–æœºä¼šéƒ½æ²¡æœ‰å•¦ğŸ˜ã€‚å…¶å®ä¹ æƒ¯å°±å¥½ã€‚ğŸ™‚\n\n\n\n#### åæˆ\n\nå°ä¼™å­åˆ«ç›¯ç€çœ‹æ ‡é¢˜å“ˆï¼Œæ€æƒ³å¾ˆå±é™©å“ˆğŸ˜…ï¼Œæˆ‘ä¸æ˜¯æ¥å¼€è½¦çš„ï¼Œè¯´å®Œé…ç½®æ–‡ä»¶å°±è¯¥è¯´è¯´è¿™ä¸ªæ‰“åŒ…è„šæœ¬äº†ã€‚è¿˜è®°å¾—å‡†å¤‡å·¥ä½œä¸­è¯´äº†è¦åœ¨**SVN**ä¸­å—ï¼Œå› ä¸ºç”¨åˆ°äº†Jenkinsä¸­å…¨å±€æ„å»ºå‚æ•°**SVN_REVISION**,å¦å¤–çœ‹è¿™ä¸ªè„šæœ¬å…¶å®æœ‰ç‚¹çƒ¦ï¼Œå› ä¸ºå¾ˆå¤§éƒ¨åˆ†ä»£ç æ˜¯åœ¨åšå‰æˆå·¥ä½œğŸ˜‰ğŸ˜‰ï¼ŒçœŸæ­£**xcodebuild**å‘½ä»¤åœ¨æœ«å°¾äº†ã€‚å¦å¤–æˆ‘å†™è„šæœ¬å–œæ¬¢éƒ½æ˜¯å°å†™ï¼Œå…¨å¤§å†™çš„çœ‹ç€å¤´ç—›å•Šï¼Œ æ‰€ä»¥æˆ‘ä¹Ÿä¸çŸ¥é“è¿™ç¬¦ä¸ç¬¦åˆè„šæœ¬çš„ä»£ç è§„èŒƒå§ï¼Œä½†æ˜¯è‡ªæˆ‘æ„Ÿè§‰è‰¯å¥½ğŸ˜ğŸ˜ã€‚\n\n```\n#!/bin/sh\n\n# å½“å‰shellæ‰€å¤„çš„ç›®å½•\nshell_dir_path=$(cd \"$(dirname \"$0\")\"; pwd)\n\n# æŠŠé…ç½®æ–‡ä»¶é‡Œçš„å‚æ•°åœ¨è¯¥è„šæœ¬é‡Œå…¨å±€åŒ–\nsource $shell_dir_path\"/global.config\"\n\necho \"å¼€å§‹æ£€æŸ¥ç¯å¢ƒ...........\"\n\n# å¦‚æœå½’æ¡£æ–‡ä»¶å¤¹ä¸å­˜åœ¨åˆ™åˆ›å»º\nif [ ! -d $package_root_path ]; then\n    mkdir -pv $package_root_path\nfi\n\n# å¦‚æœä¸å­˜åœ¨è®°å½•æ–‡ä»¶åˆ™åˆ›å»ºï¼Œå­˜åœ¨æ–‡ä»¶åˆ™æŠŠæ–‡ä»¶å†…å®¹å˜é‡åŠ å…¥åˆ°å…¨å±€å˜é‡\nif [ -e $package_root_path\"result.txt\" ]; then\n    source $package_root_path\"result.txt\"\n    # åˆ¤æ–­svnæœ€åæäº¤ä¿¡æ¯æ˜¯å¦å·²ç»å½’æ¡£è¿‡ï¼Œå…¶ä¸­SVN_REVISIONæ˜¯SVNæäº¤æ—¶çš„ç¼–å·ï¼Œæ”¹å˜é‡\n    # æ˜¯Jenkinsæä¾›çš„\n    if [ $lastestBuildVersion = $SVN_REVISION ] ; then\n        echo \"è¯¥ç‰ˆæœ¬å·²ç»æ‰“è¿‡åŒ…äº†ï¼Œè¯·é‡æ–°æäº¤ä¸€æ¬¡è®°å½•å¹¶ç¡®ä¿is_need_packageä¸ºtrue\"\n        exit 1\n    else\n        # ä¸ºäº†èŠ‚çœç©ºé—´ï¼Œæ‰€ä»¥æ¯æ¬¡æ‰“åŒ…éƒ½ä¼šåœ¨å¼€å§‹å‰ç§»é™¤ä¹‹å‰æ–‡ä»¶\n        rm -rf $package_archive_path*\n        echo \"ç§»é™¤æ—§é¡¹ç›®å®Œæ¯•ï¼Œå‡†å¤‡å·¥ä½œå·²å°±ç»ª\"\n    fi\nelse\n    # åˆ›å»ºè®°å½•æ–‡æ¡£\n    touch $package_root_path\"/result.txt\"\n    chmod -R 777 $package_root_path\"/result.txt\"\n    echo lastestBuildVersion=0 >> $package_root_path\"/result.txt\"\n\nfi\n\n# æ£€æŸ¥æ˜¯å¦éœ€è¦æ‰“åŒ…\nif ! $is_need_package; then\n    exit 1\nfi\n\n# æ£€æŸ¥æ˜¯å¦è®¾ç½®target/scheme\nif test -z $package_target_name; then\n\techo \"âŒ é¡¹ç›®Targetè®¾ç½®ä¸ºç©º\"\n\texit 1\nfi\n\nif test -z $package_scheme_name; then\n\techo \"âŒ é¡¹ç›®Schemeè®¾ç½®ä¸ºç©º\"\n\texit 1\nfi\n\n# è¯»å–é…ç½®æ–‡ä»¶å½’æ¡£ç±»å‹æ˜¯Releaseè¿˜æ˜¯Debug\nif $package_use_release; then\n    build_configuration=\"Release\"\nelse\n    build_configuration=\"Debug\"\nfi\n\n\n#  AdHoc: 1, AppStore: 2, Enterprise: 3, Development: 4\n# å¯¼å‡ºipaåŒ…çš„plistæ–‡ä»¶å¤¹ï¼Œè¯¥æ–‡ä»¶åœ¨æ‰“åŒ…æ—¶ä¼šç”Ÿæˆ\noptions_dir_path=$package_export_options_dir_path\nif [[ $package_export_type -eq 1 ]]; then\n    export_options_plist_path=$options_dir_path\"AdHocExportOptions.plist\"\n    export_type_name=\"AdHoc\"\nelif [[ $package_export_type -eq 2 ]]; then\n    export_options_plist_path=$options_dir_path\"AppStoreExportOptions.plist\"\n    export_type_name=\"AppStore\"\nelif [[ $package_export_type -eq 3 ]]; then\n    export_options_plist_path=$options_dir_path\"EnterpriseExportOptions.plist\"\n    export_type_name=\"Enterprise\"\nelif [[ $package_export_type -eq 4 ]]; then\n    export_options_plist_path=$options_dir_path\"DevelopmentExportOptions.plist\"\n    export_type_name=\"Development\"\nfi\n\necho \"âœ…âœ…âœ… æ ¡éªŒå‚æ•°ä»¥åŠç¯å¢ƒæˆåŠŸ\"\necho \"âš¡ï¸ âš¡ï¸ âš¡ï¸å³å°†å¼€å§‹æ‰“åŒ… âš¡ï¸ âš¡ï¸ âš¡ï¸\"\n\n##############################è‡ªåŠ¨æ‰“åŒ…éƒ¨åˆ†##############################\n\n# è¿”å›åˆ°å·¥ç¨‹ç›®å½•\ncd ../\nproject_path=`pwd`\n\n# è·å–é¡¹ç›®åç§°\nproject_name=`find . -name *.xcodeproj | awk -F \"[/.]\" '{print $(NF-1)}'`\n# æŒ‡å®šå·¥ç¨‹çš„Info.plist\ncurrent_info_plist_name=\"Info.plist\"\n# é…ç½®Info.plistçš„è·¯å¾„\ncurrent_info_plist_path=\"${project_name}/${current_info_plist_name}\"\n# è·å–é¡¹ç›®çš„ç‰ˆæœ¬å·\nbundle_version=`/usr/libexec/PlistBuddy -c \"Print CFBundleShortVersionString\" ${current_info_plist_path}`\n# è·å–é¡¹ç›®çš„ç¼–è¯‘ç‰ˆæœ¬å·\nbundle_build_version=`/usr/libexec/PlistBuddy -c \"Print CFBundleVersion\" ${current_info_plist_path}`\n\n# å½“å‰ç‰ˆæœ¬å­˜æ”¾å¯¼å‡ºæ–‡ä»¶è·¯å¾„ï¼Œå¯ä»¥æ ¹æ®éœ€æ±‚æ·»åŠ ä¸åŒçš„è·¯å¾„\ncurrentVersionArchivePath=\"${package_archive_path}\"\n\n# åˆ¤æ–­å½’æ¡£å½“å‰ç‰ˆæœ¬æ–‡ä»¶å¤¹æ˜¯å¦å­˜åœ¨ï¼Œä¸å­˜åœ¨åˆ™åˆ›å»º\nif [ ! -d $currentVersionArchivePath ]; then\n    mkdir -pv $currentVersionArchivePath\n    chmod -R 777 $currentVersionArchivePath\nfi\n\n# å½’æ¡£æ–‡ä»¶è·¯å¾„\nexport_archive_path=\"${currentVersionArchivePath}${package_scheme_name}.xcarchive\"\n# ipaå¯¼å‡ºè·¯å¾„\nexport_ipa_path=\"${currentVersionArchivePath}\"\n# è·å–æ—¶é—´ å¦‚:20190630_1420\n# current_date=\"$(date +%Y%m%d_%H%M)\"\n# ipa åå­—, å¯ä»¥æ ¹æ®ç‰ˆæœ¬å·æ¥è¿›è¡Œé‡å‘½å\nipa_name=\"${package_scheme_name}_${SVN_REVISION}.ipa\"\n\necho \"å·¥ç¨‹ç›®å½• = ${project_path}\"\necho \"å·¥ç¨‹Info.plistè·¯å¾„ = ${current_info_plist_path}\"\necho \"æ‰“åŒ…ç±»å‹ = ${build_configuration}\"\necho \"æ‰“åŒ…ä½¿ç”¨çš„plistæ–‡ä»¶è·¯å¾„ = ${export_options_plist_path}\"\n\n###############################æ‰“åŒ…éƒ¨åˆ†#########################################\n\necho \"ğŸ”†ğŸ”†ğŸ”†æ­£åœ¨ä¸ºæ‚¨å¼€å§‹æ‰“åŒ…ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€\"\n\n# æ˜¯å¦ä½¿ç”¨xxx.xcworkspaceå·¥ç¨‹æ–‡ä»¶è¿›è¡Œæ‰“åŒ…\nif $package_use_workspace; then\n\n    if [[ ${build_configuration} == \"Debug\" ]]; then\n        # 1. Clean\n        xcodebuild clean  -workspace ${project_name}.xcworkspace \\\n        -scheme ${package_scheme_name} \\\n        -configuration ${build_configuration}\n\n        # 2. Archive\n        xcodebuild archive  -workspace ${project_name}.xcworkspace \\\n        -scheme ${package_scheme_name} \\\n        -configuration ${build_configuration} \\\n        -archivePath ${export_archive_path} \\\n        CFBundleVersion=${bundle_build_version} \\\n        -destination generic/platform=ios \\\n\n    elif [[ ${build_configuration} == \"Release\" ]]; then\n\n        # 1. Clean\n        xcodebuild clean  -workspace ${project_name}.xcworkspace \\\n        -scheme ${package_scheme_name} \\\n        -configuration ${build_configuration}\n\n        # 2. Archive\n        xcodebuild archive  -workspace ${project_name}.xcworkspace \\\n        -scheme ${package_scheme_name} \\\n        -configuration ${build_configuration} \\\n        -archivePath ${export_archive_path} \\\n        CFBundleVersion=${bundle_build_version} \\\n        -destination generic/platform=ios \\\n\n    fi\n\nelse\n\n    if [[ ${build_configuration} == \"Debug\" ]] ; then\n        # 1. Clean\n        xcodebuild clean  -project ${project_name}.xcodeproj \\\n        -scheme ${package_scheme_name} \\\n        -configuration ${build_configuration} \\\n        -alltargets\n\n        # 2. Archive\n        xcodebuild archive  -project ${project_name}.xcodeproj \\\n        -scheme ${package_scheme_name} \\\n        -configuration ${build_configuration} \\\n        -archivePath ${export_archive_path} \\\n        CFBundleVersion=${bundle_build_version} \\\n        -destination generic/platform=ios \\\n\n    elif [[ ${build_configuration} == \"Release\" ]]; then\n        # 1. Clean\n        xcodebuild clean  -project ${project_name}.xcodeproj \\\n        -scheme ${package_scheme_name} \\\n        -configuration ${build_configuration} \\\n        -alltargets\n\n        # 2. Archive\n        xcodebuild archive  -project ${project_name}.xcodeproj \\\n        -scheme ${package_scheme_name} \\\n        -configuration ${build_configuration} \\\n        -archivePath ${export_archive_path} \\\n        CFBundleVersion=${bundle_build_version} \\\n        -destination generic/platform=ios \\\n\n    fi\nfi\n\n# æ£€æŸ¥æ˜¯å¦æ„å»ºæˆåŠŸ\n# å› ä¸ºxxx.xcarchive æ˜¯ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸æ˜¯ä¸€ä¸ªæ–‡ä»¶\nif [ -d ${export_archive_path} ]; then\n    echo \"ğŸš€ ğŸš€ ğŸš€ é¡¹ç›®æ„å»ºæˆåŠŸ ğŸš€ ğŸš€ ğŸš€\"\nelse\n    echo \"âš ï¸ âš ï¸ âš ï¸ é¡¹ç›®æ„å»ºå¤±è´¥ âš ï¸ âš ï¸ âš ï¸\"\n    exit 1\nfi\n\necho \"å¼€å§‹å¯¼å‡ºipaæ–‡ä»¶\"\n# å¯¼å‡ºipaæ–‡ä»¶\nxcodebuild -exportArchive -archivePath ${export_archive_path} \\\n-exportPath ${export_ipa_path} \\\n-destination generic/platform=ios \\\n-exportOptionsPlist ${export_options_plist_path} \\\n-allowProvisioningUpdates\n# é»˜è®¤å¯¼å‡ºipaæ–‡ä»¶è·¯å¾„\nexport_ipa_name=$export_ipa_path$package_scheme_name\".ipa\"\n\n# åˆ¤æ–­æ˜¯å¦æœ‰è¿™ä¸ªå¯¼å‡ºipaæ–‡ä»¶\nif [ -e $export_ipa_name ]; then\n    # æ›´æ”¹åç§°ä¸º scheme_version.ipa schemeåç§°ä¸ºå·¥ç¨‹åç§°ï¼Œversionä¸ºsvnæœ€åæäº¤çš„ç‰ˆæœ¬\n    mv $export_ipa_name $export_ipa_path$ipa_name\n    # å°†å½“å‰ç‰ˆæœ¬è®¾ä¸ºå·²æ‰“åŒ…çŠ¶æ€\n    echo lastestBuildVersion=$SVN_REVISION > $package_root_path\"result.txt\"\n    echo \"ğŸ‰ ğŸ‰ ğŸ‰ å¯¼å‡º ${ipa_name}.ipa åŒ…æˆåŠŸ ğŸ‰ ğŸ‰ ğŸ‰\"\nelse\n    echo \"âŒ âŒ âŒ å¯¼å‡º ${ipa_name}.ipa åŒ…å¤±è´¥ âŒ âŒ âŒ\"\nfi\n\n# è¾“å‡ºæ‰“åŒ…æ€»ç”¨æ—¶\necho \"æœ¬æ¬¡æ‰“åŒ…æ€»è€—æ—¶: ${SECONDS}s\"\n```\n\næ˜¯ä¸æ˜¯æœ‰ç‚¹å¤´æ™•å“‡ï¼Œæˆ‘æ˜¯å¤´ç—›å•ŠğŸ¤—ğŸ¤—ï¼Œç©è¿‡ä½¿ç”¨**Jenkins**è„šæœ¬è‡ªåŠ¨æ‰“åŒ…çš„äººçœ‹å®Œè¿™ä¸ªåº”è¯¥çŸ¥é“æˆ‘çš„æ›²çº¿æ•‘å›½æ–¹å¼äº†ï¼Œæœ‰çš„åŒå­¦è‚¯å®šè¿˜åœ¨ğŸ˜³ğŸ˜³orğŸ¤”ğŸ¤”ã€‚æˆ‘ä»¬åœ¨**é‡å¤´æˆ**ä¸­è®²ğŸ¤—ğŸ¤—ã€‚\n\n\n\n### é‡å¤´æˆ\n\nçœ‹é£æ ¼æˆ‘å°±ä¸æ˜¯å¼€è½¦çš„äººï¼Œå› ä¸ºå¼€è½¦å“ªæ¥è¿™ä¹ˆå¤šå‰æˆæ˜¯å§ï¼ŸğŸ¤”ğŸ¤”ï¼Œå¼€å§‹å‰¥ä¸æŠ½èŒ§å•¦ã€‚\n\nå‰é¢è¯´åˆ°åœ¨**Jenkins**ä¸­æ²¡æœ‰ç±»ä¼¼**Git**è¿™æ ·çš„æäº¤ä»£ç è‡ªåŠ¨æ‰“åŒ…çš„é’©å­æ’ä»¶ã€‚è€Œæˆ‘ä»¬ä½¿ç”¨**Jenkins**çš„ç›®çš„å°±æ˜¯ä¸ºäº†é‡Šæ”¾ç¨‹åºå‘˜çš„ğŸ‘ï¼Œç•™ç€æ›´å¤šæ—¶é—´å¹²æ­£äº‹ï¼Œå¦‚æœä¸èƒ½å®ç°æäº¤è‡ªåŠ¨æ‰“åŒ…é‚£æœ‰æ— **Jenkins**éƒ½ä¸€æ ·äº†ï¼Œè¿˜ä¸å¦‚è‡ªå·±å†™ä¸ªè„šæœ¬æ‰“åŒ…å‘¢ï¼Œæ˜¯å§ï¼Ÿå¦‚æœæ˜¯ä½ ä½ ä¼šæ€ä¹ˆåšå‘¢ï¼Ÿ\n\næˆ‘ä»¬çŸ¥é“Jenkinsæœ‰ä¸ªå®šæœŸæ‰§è¡Œä»»åŠ¡çš„é€‰é¡¹ï¼Œæˆ‘ä»¬åªéœ€å¡«ä¸Šå‚æ•°ï¼šH/2 * * * *  ç„¶åå°±ä¼šæ¯ä¸¤åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ï¼Œæ˜¯ä¸æ˜¯æƒ³è¯´ä¸ºå•¥ä¸è®¾ç½®1åˆ†é’Ÿï¼Œæˆ‘ä¹Ÿæƒ³å“‡ï¼Œ**Jenkins**ä¸è®©å•ŠğŸ˜ğŸ˜ã€‚ä½†æ˜¯æ€»ä¸èƒ½è®©è¿™å®¶ä¼™æ¯ä¸¤åˆ†é’Ÿä¸€ç›´æ‰“å§ï¼Œè¦†ç›–è¿˜å¥½ï¼Œä½†æ˜¯æ¯ä¸¤åˆ†é’Ÿå°±æœ‰ä¸€ä¸ªæ–°çš„å®‰è£…åŒ…ä¸Šä¼ è‡³æµ‹è¯•æœåŠ¡å™¨ä¹Ÿä¸å¥½å§ï¼Œæ„Ÿè§‰ä¼šè¢«æµ‹è¯•äººå‘˜æ‰“å±ğŸ˜±ğŸ˜±ã€‚é‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦è§£å†³è¿™ä¸ªæ‰“æ–­æ‰“åŒ…çš„æ¡ä»¶ğŸ¤”ã€‚æ—¢ä¸èƒ½åœ¨å·¥ç¨‹ä¸­è®¾ç½®ï¼Œä¸ç„¶**Jenkins**æ¯æ¬¡æ‰§è¡Œä»»åŠ¡å°±è¦†ç›–äº†ï¼Œä¹Ÿå°±æ˜¯åªèƒ½åœ¨æ‰“åŒ…ç”µè„‘ä¸Šä¿å­˜ä¸€ä¸ªçŠ¶æ€ã€‚é‚£ä¹ˆå¾ˆå¥½è§£å†³å•¦ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨è„šæœ¬ä¸­åˆ›å»ºä¸€ä¸ªæ–‡ä»¶æ¥è®°å½•ä¸Šæ¬¡æ‰“åŒ…çš„**SVN_REVISION**ï¼Œå°±èƒ½è®©è„šæœ¬è¯»å–æ–‡ä»¶è®°å½•åˆ¤æ–­æ˜¯å¦å·²ç»æ‰“è¿‡åŒ…äº†ï¼Œæ²¡æœ‰æ‰“è¿‡åŒ…æ‰æ‰§è¡Œç¨‹åºï¼Œå¦åˆ™é€€å‡ºç¨‹åºã€‚ğŸ˜‰ğŸ˜‰ç°åœ¨æƒ³æƒ³æ˜¯ä¸æ˜¯å¾ˆç®€å•å“‡ï¼Œç„¶åå°±å¯ä»¥å°½æƒ…çš„å“’å“’å“’ã€‚\n\n\n\nä½¿ç”¨FTPä¸Šä¼ è‡³æµ‹è¯•æœåŠ¡å™¨è¿™éƒ¨åˆ†è¯¥å¦‚ä½•è§£å†³å‘¢ï¼Ÿå› ä¸ºæ¶‰åŠåˆ°å¯å˜å‚æ•°ï¼Œè„šæœ¬é‚£ä¹ˆå·®çš„æˆ‘åªèƒ½ä½¿ç”¨åœŸåŠæ³•ï¼Œä¸€æ‹›ä¸€æ‹›æ¥ï¼Œå¹²åˆ°ä¸æœä¸ºæ­¢ğŸ˜ğŸ˜ã€‚è¿™éƒ¨åˆ†è„šæœ¬æ˜¯ä¸Šé¢é‚£é•¿ä¸²ä»£ç çš„æœ«å°¾åçš„ä»£ç ã€‚\n\n```\n############################ä¸Šä¼ éƒ¨åˆ†#####################################\n\nfunction createUploadShell(){\n    touch upload.sh\n    chmod -R 777 upload.sh\n    echo \"cd ${package_archive_path}\" >> upload.sh\n    echo \"ftp -i -n -v << !\" >> upload.sh\n    echo \"open 117.xx.xxx.xxx\" >> upload.sh\n    echo \"user oymuzi xxxx\" >> upload.sh\n    echo \"cd ./${upload_dir_path}\" >> upload.sh\n    current_date=\"$(date +%Y%m%d%H%M%S)\"\n    ipa_new_name=$package_scheme_name\"_\"$current_date\".ipa\"\n    echo \"binary\" >> upload.sh\n    echo \"put ${upload_volumes_name}${package_archive_path}${ipa_name} ./${ipa_new_name}\" >> upload.sh\n    echo \"close\" >> upload.sh\n    echo \"bye\" >> upload.sh\n    echo \"!\" >> upload.sh\n}\n\ncd $package_archive_path\ncreateUploadShell\necho \"åˆ›å»ºä¸Šä¼ è„šæœ¬æˆåŠŸ\"\n\necho \"ğŸš€ ğŸš€ ğŸš€ å¼€å§‹ä¸Šä¼ è‡³äº‘ç«¯  ğŸš€ ğŸš€ ğŸš€\"\nsh upload.sh\necho \"ä¸Šä¼ è‡³äº‘ç«¯å®Œæˆ\"\n\nrm -f upload.sh\n```\n\nå¯¹ï¼Œå°±æ˜¯è¿™ä¹ˆfeel å€çˆ½ï¼Œå¤§ä½¬å¯ä»¥è‡ªå·±è¿›è¡Œæ›´æ”¹è„šæœ¬ã€‚å…¶ä¸­ä¸€ç‚¹å°±æ˜¯ä½¿ç”¨FTPå‘½ä»¤å¿…é¡»ä½¿ç”¨`ftp -i -n -v << !  ä½ æƒ³è¦çš„æ‰§è¡Œçš„FTPå‘½ä»¤  !`ã€‚è‡³äºä¸Šä¼ å…¬å¸æœåŠ¡å™¨è¿˜æ˜¯è’²å…¬è‹±ç­‰å¹³å°ï¼Œè¿™ä¸ªå¯ä»¥æ ¹æ®å„è‡ªå…¬å¸çš„è§„åˆ™å§ï¼Œè‡ªå·±è¿›è¡Œä¿®æ”¹å“ˆã€‚\n\n\n\næºç åœ°å€ï¼š[OMPackaging](<https://github.com/oymuzi/OMPackaging>)(æ³¨ï¼šæ­¤demoä»…ä¸ºäº†å±•ç¤ºæºç ï¼ŒæŒ‰ç…§æºç å’Œæ–‡ç« æ‰€è¯´çš„åŠæ³•è®¾ç½®ç¯å¢ƒå³å¯æ­£å¸¸æ‰“åŒ…)\n\n\n\n### è¨€å½’æ­£ä¼ \n\nåˆ©ç”¨**Jenkins**çš„å®šæ­»æ‰§è¡Œä»»åŠ¡åŠŸèƒ½ï¼Œåœ¨æœ¬åœ°ä¿å­˜ä¸€ä¸ªæ‰“åŒ…çš„çŠ¶æ€ï¼Œç„¶åå°±èƒ½æ¯æ¬¡æäº¤ä»£ç åè¿›è¡Œè‡ªåŠ¨æ‰“åŒ…ï¼Œæœ‰1-2åˆ†é’Ÿçš„å»¶è¿Ÿï¼Œè€Œä¸”è¦æ‰§è¡Œæ‰“åŒ…å¿…é¡»ç¡®ä¿é…ç½®æ–‡ä»¶ä¸­çš„`is_need_package`ä¸ºtrueå¹¶æäº¤ä¸€æ¬¡ä»£ç ã€‚åœ¨ä¸Šä¼ è‡³æµ‹è¯•æœåŠ¡å™¨ï¼Œæµ‹è¯•äººå‘˜å°±èƒ½ç›´æ¥ä¸‹è½½å®‰è£…ã€‚è¿™ä¸ªæ–¹æ¡ˆè™½ç„¶æœ‰äº›å»¶è¿Ÿï¼Œä½†æ˜¯è§£å†³äº†è‡ªåŠ¨æ‰“åŒ…çš„é—®é¢˜ã€‚\n\n\n\n\n\nå‚è€ƒï¼š\n\n[Mac shell ä¸Šä¼ æ–‡ä»¶(åœ¨shellä¸­ä½¿ç”¨FTPå‘½ä»¤)](https://blog.csdn.net/weixinyi21cn/article/details/79151620)\n\n[Building from the Command Line with Xcode FAQ](https://developer.apple.com/library/archive/technotes/tn2339/_index.html)\n\n","slug":"åŸºäºSVNæäº¤ä»£ç è‡ªåŠ¨æ‰“åŒ…","published":1,"updated":"2019-07-12T09:44:39.927Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjxzyop2n0001eqfys41wb78a","content":"<h3 id=\"å‰è¨€\"><a href=\"#å‰è¨€\" class=\"headerlink\" title=\"å‰è¨€\"></a>å‰è¨€</h3><p>ä¹‹å‰å†™è¿‡ä¸€ç¯‡<a href=\"https://juejin.im/post/5ca8c81e6fb9a05e6668ab56\" target=\"_blank\" rel=\"noopener\">åŸºäºJenkinså’ŒFastlaneè‡ªåŠ¨æ‰“åŒ…</a>çš„æ–‡ç« ï¼Œæ–‡ä¸­ç®€è¿°äº†å¾ˆå¤šçš„çš„ç¯å¢ƒæ­å»ºä»¥åŠä¸€äº›é‡åˆ°çš„é—®é¢˜ã€‚è¿™ç¯‡æ–‡ç« çš„ç›®çš„æ˜¯ä½¿ç”¨è„šæœ¬å’Œ<strong>Jenkins</strong>æ¥è‡ªåŠ¨æ‰“åŒ…ï¼Œä¸ºä½•ä¸åœ¨ä½¿ç”¨ä¹‹å‰çš„<strong>Fastlane</strong>å‘¢ï¼Ÿé¦–å…ˆ<strong>Fastlane</strong>æ˜¯å¾ˆä¸é”™çš„ï¼Œä¹Ÿæ˜¯ä½¿ç”¨<strong>xcodebuild</strong>å‘½ä»¤æ¥å°è£…å®ç°çš„ï¼Œä½†æ˜¯åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­ä¼šæ¶‰åŠåˆ°ä¸€ä¸ªè„šæœ¬çš„è¿ç§»èƒ½åŠ›å³è¿ç”¨åˆ°å…¶ä»–é¡¹ç›®ä¸Šï¼Œæˆ‘è®¤ä¸ºæ˜¯ä¸ç®—é«˜çš„ï¼Œè‡³å°‘åœ¨<strong>Jenkins</strong>ä¸Šã€‚åæ­£<strong>Fastlane</strong>ä¹Ÿæ˜¯åŸºäº<strong>xcodebuild</strong>æ¥è¿›è¡Œç¼–è¯‘æ‰“åŒ…çš„ï¼Œé‚£æˆ‘ä»¬ä½•ä¸ç›´æ¥ç¼–å†™è„šæœ¬è¿›è¡Œæ‰“åŒ…å‘¢ï¼Ÿ</p>\n<a id=\"more\"></a>\n\n<p>è¿˜æœ‰ä¸€ä¸ªé—®é¢˜å°±æ˜¯å¤§å®¶éƒ½çŸ¥é“ä½¿ç”¨<strong>Git</strong>åŸºäº<strong>Jenkins</strong>çš„è‡ªåŠ¨åŒ–æ‰“åŒ…å¯ä»¥ç›´æ¥åœ¨æ¯æ¬¡æäº¤æ—¶å®ç°è‡ªåŠ¨æ‰“åŒ…ï¼Œä½†æ˜¯åœ¨<strong>Jenkins</strong>ä¸­ä½¿ç”¨<strong>SVN</strong>æˆ‘ä»¬æ²¡æœ‰å‘ç°ç±»ä¼¼è¿™ä¸ªåŠŸèƒ½çš„æ’ä»¶ã€‚æ–‡ä¸­çš„è§£å†³åŠæ³•æ˜¯ä¸€ç§æ›²çº¿æ•‘å›½çš„æ–¹æ³•ï¼Œåœ¨æ–‡ç« çš„ä¸‹åŠéƒ¨åˆ†ä¼šè®²åˆ°ã€‚æˆ‘ä¸€å¼€å§‹çš„æ„æ€è¿˜æ˜¯æƒ³é€šè¿‡å±€åŸŸç½‘æ¥å®ç°ï¼Œä½†æ˜¯è¶Šåˆ°åé¢å‘ç°è¡Œä¸é€šï¼Œæ²¡æœ‰æ„Ÿè§‰åˆ°è‡ªåŠ¨æ‰“åŒ…å¸¦æ¥çš„ä¾¿åˆ©ã€‚<strong>äºæ˜¯æœ‰äº†æœ¬æ–‡è¿™ä¸ªæ–¹æ¡ˆ</strong>ã€‚</p>\n<h3 id=\"å‡†å¤‡\"><a href=\"#å‡†å¤‡\" class=\"headerlink\" title=\"å‡†å¤‡\"></a>å‡†å¤‡</h3><p>â‘ è¯·ç¡®ä¿æ‰“åŒ…ç”µè„‘çš„ç¯å¢ƒå·²ç»å®‰è£…å¥½äº†HomeBrewã€Jenkins(å»ºè®®ä½¿ç”¨brewå®‰è£…Jenkinså¹¶è¿›è¡Œå¼€æœºè‡ªå¯åŠ¨)</p>\n<p>â‘¡è¯·ç¡®ä¿æ‰“åŒ…ç”µè„‘çš„è¦æ˜¯ä¸²ä¸­æœ‰ä½ éœ€è¦æ‰“åŒ…çš„APPæ‰€éœ€çš„è¯ä¹¦ã€æè¿°æ–‡ä»¶</p>\n<p>â‘¢è¯·ç¡®ä¿æ­¤æ‰“åŒ…è„šæœ¬ç”¨äºåŸºäºæäº¤SVNå’ŒJenkinsç¯å¢ƒä¸­è‡ªåŠ¨æ‰“åŒ…ï¼Œå¦åˆ™å°†ä¼šå¯¼è‡´è„šæœ¬ä¸å¯ç”¨çš„çŠ¶æ€ğŸ˜‚ğŸ˜‚</p>\n<h3 id=\"æ‰“åŒ…ç»“æ„\"><a href=\"#æ‰“åŒ…ç»“æ„\" class=\"headerlink\" title=\"æ‰“åŒ…ç»“æ„\"></a>æ‰“åŒ…ç»“æ„</h3><p>å…·ä½“çš„ç»“æ„å¯ä»¥å‚ç…§ä¸‹å›¾ï¼Œå¦‚æœæœ‰å…¶ä»–çš„ç±»å‹çš„æ‰“åŒ…ï¼Œå¯ä»¥åœ¨Plistæ–‡ä»¶å¤¹ä¸­æ·»åŠ æ–°çš„plistæ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶å¯ä»¥åœ¨æ‰‹åŠ¨æ‰“åŒ…æ—¶å¯¼å‡ºçš„æ–‡ä»¶å¤¹é‡Œæœ‰xxxExportOptions.plistæ–‡ä»¶ã€‚ç„¶ååœ¨é…ç½®æ–‡ä»¶é‡Œé¢è¿›è¡Œæ›´æ”¹ç±»å‹ã€‚</p>\n<p><img src=\"http://cloud.minder.mypup.cn/blog/%E8%87%AA%E5%8A%A8%E6%89%93%E5%8C%85%E7%BB%93%E6%9E%84%E5%9B%BE.jpg\" alt></p>\n<h4 id=\"å‰æˆ\"><a href=\"#å‰æˆ\" class=\"headerlink\" title=\"å‰æˆ\"></a>å‰æˆ</h4><p>ä¿®æ”¹é…ç½®æ–‡ä»¶å°±èƒ½ç›´æ¥æ§åˆ¶æ‰“åŒ…ç±»å‹æ˜¯ä¸æ˜¯å¾ˆæ–¹ä¾¿ã€‚ä¸€å¼€å§‹é‡‡ç”¨jsonæ–‡ä»¶æ¥è¿›è¡Œé…ç½®ï¼Œä½¿ç”¨jsonæ–‡ä»¶çš„è¯å¯¹æˆ‘æ¥è¯´æœ‰ä¸¤ä¸ªç¼ºç‚¹ã€‚å…¶ä¸€å°±æ˜¯jsonæ–‡ä»¶ä¸­æ— æ³•è¿›è¡Œæ³¨é‡Šï¼Œè¿™ä¼šå¯¼è‡´åé¢æ¥æ‰‹çš„äººæ— æ³•æ˜ç™½å…¶æ„ï¼Œæˆ–è€…éœ€è¦åœ¨æ·»åŠ ä¸€ä¸ªè¯´æ˜æ–‡æ¡£ï¼›å…¶äºŒæ˜¯å› ä¸ºåœ¨ä½¿ç”¨jsoné…ç½®è·¯å¾„çš„æ—¶å€™è¿˜éœ€è¦å¯¹å€¼è¿›è¡Œå»é™¤åŒå¼•å·ï¼Œå¯ä»¥å®ç°å¾ˆéº»çƒ¦ã€‚å¦å¤–å°±æ˜¯Shellè§£æjsonæ•°æ®è¿˜æ˜¯æœ‰ç‚¹éº»çƒ¦ï¼Œä½¿ç”¨jqè§£ææŒºæ–¹ä¾¿å°±æ˜¯å¾—é…ç½®ä¸€ä¸‹ç¯å¢ƒã€‚å…¶ä¸­global.configä»£ç å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight plain hljs\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">#æ˜¯å¦éœ€è¦æ‰“åŒ…</span><br><span class=\"line\">is_need_package=true</span><br><span class=\"line\"></span><br><span class=\"line\">#ç”Ÿäº§ç¯å¢ƒ/å¼€å‘ç¯å¢ƒè¯ä¹¦è®¾ç½®</span><br><span class=\"line\">code_sign_distribution=&quot;iPhone Distribution: xxxx xxx (xxx)&quot;</span><br><span class=\"line\">code_sign_development=&quot;iPhone Developer: xxxx xxxx (xxx)&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">#é¡¹ç›®çš„target/schemeè®¾ç½® </span><br><span class=\"line\">package_target_name=&quot;xxx&quot;</span><br><span class=\"line\">package_scheme_name=&quot;xxx&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">#æ‰“åŒ…ç»“æœæ ¹ç›®å½•</span><br><span class=\"line\">package_root_path=/Users/xxx/Desktop/Package/</span><br><span class=\"line\">#æ‰“åŒ…ipaç›®å½•</span><br><span class=\"line\">package_archive_path=/Users/xxx/Desktop/Package/Archive/</span><br><span class=\"line\"></span><br><span class=\"line\">#æ‰“åŒ…ç±»å‹  AdHocï¼š1 AppStoreï¼š2  Enterpriseï¼š3  Developmentï¼š4</span><br><span class=\"line\">package_export_type=1</span><br><span class=\"line\">#æ‰“åŒ…å­˜æ”¾çš„xxxExportOptions.plistæ–‡ä»¶å¤¹</span><br><span class=\"line\">package_export_options_dir_path=./AutoPacking/Plist/</span><br><span class=\"line\"></span><br><span class=\"line\">#æ˜¯å¦ä½¿ç”¨workspaceè¿›è¡Œæ‰“åŒ…</span><br><span class=\"line\">package_use_workspace=true</span><br><span class=\"line\">#æ˜¯å¦ä½¿ç”¨Releaseæ¨¡å¼è¿›è¡Œæ‰“åŒ…</span><br><span class=\"line\">package_use_release=true</span><br><span class=\"line\"></span><br><span class=\"line\">#è®°å½•æ‰“åŒ…å‰ç¼€</span><br><span class=\"line\">record_perfix=&quot;CEG&quot;</span><br></pre></td></tr></table></figure>\n\n<p>æ˜¯ä¸æ˜¯è§‰å¾—å¾ˆç®€å•ï¼Œä½†æ˜¯é˜…è¯»æ€§ä¸æ˜¯å¾ˆé«˜å§ï¼Œ åœ¨Xcodeä¸­æ²¡æœ‰é«˜äº®æ˜¾ç¤ºï¼Œéƒ½æ˜¯ä¸€ä¸ªè‰²å®¹æ˜“çŠ¯å›°ã€‚ä½†æ˜¯ä½¿ç”¨è¶…çº§ç®€å•</p>\n<figure class=\"highlight plain hljs\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">source global.config</span><br></pre></td></tr></table></figure>\n\n<p>æ˜¯ä¸æ˜¯å¾ˆç®€å•ï¼ŒğŸ˜€ğŸ˜€ï¼Œåªéœ€è¦ä¸€ä¸ªå‘½ä»¤ï¼Œå³å¯è·å¾—å…¨éƒ¨çš„å…¨å±€å˜é‡ï¼Œ$is_need_packageå°±èƒ½è·å¾—å€¼ï¼Œè·¯å¾„ä¹Ÿæ˜¯ï¼Œæ‰€ä»¥æˆ‘é€‰æ‹©äº†è¿™ç§æ–¹å¼æ¥è¿›è¡Œåšé…ç½®æ–‡ä»¶ï¼Œå¯¹ä¸åŒçš„äººæœ‰ä¸åŒçš„æ•ˆæœï¼Œå¯¹æˆ‘ä¸ç†Ÿæ‚‰è„šæœ¬çš„äººçœŸçš„å¤ªæœ‰å¥½äº†ã€‚æœ‰ä¸ªæ³¨æ„ç‚¹å°±æ˜¯ä¸€è¡Œåªèƒ½å†™ä¸€ä¸ªå˜é‡ï¼Œå¹¶ä¸”å˜é‡å’Œå€¼ä¹‹é—´åªèƒ½æœ‰ç­‰äºå·ï¼Œä¸èƒ½æœ‰ç©ºæ ¼å·æ¥è¿›è¡Œå¯¹é½ğŸ¤¡ğŸ¤¡ï¼Œæ˜¯ä¸æ˜¯è§‰å¾—è¿æœ€åçš„ç¾åŒ–æœºä¼šéƒ½æ²¡æœ‰å•¦ğŸ˜ã€‚å…¶å®ä¹ æƒ¯å°±å¥½ã€‚ğŸ™‚</p>\n<h4 id=\"åæˆ\"><a href=\"#åæˆ\" class=\"headerlink\" title=\"åæˆ\"></a>åæˆ</h4><p>å°ä¼™å­åˆ«ç›¯ç€çœ‹æ ‡é¢˜å“ˆï¼Œæ€æƒ³å¾ˆå±é™©å“ˆğŸ˜…ï¼Œæˆ‘ä¸æ˜¯æ¥å¼€è½¦çš„ï¼Œè¯´å®Œé…ç½®æ–‡ä»¶å°±è¯¥è¯´è¯´è¿™ä¸ªæ‰“åŒ…è„šæœ¬äº†ã€‚è¿˜è®°å¾—å‡†å¤‡å·¥ä½œä¸­è¯´äº†è¦åœ¨<strong>SVN</strong>ä¸­å—ï¼Œå› ä¸ºç”¨åˆ°äº†Jenkinsä¸­å…¨å±€æ„å»ºå‚æ•°<strong>SVN_REVISION</strong>,å¦å¤–çœ‹è¿™ä¸ªè„šæœ¬å…¶å®æœ‰ç‚¹çƒ¦ï¼Œå› ä¸ºå¾ˆå¤§éƒ¨åˆ†ä»£ç æ˜¯åœ¨åšå‰æˆå·¥ä½œğŸ˜‰ğŸ˜‰ï¼ŒçœŸæ­£<strong>xcodebuild</strong>å‘½ä»¤åœ¨æœ«å°¾äº†ã€‚å¦å¤–æˆ‘å†™è„šæœ¬å–œæ¬¢éƒ½æ˜¯å°å†™ï¼Œå…¨å¤§å†™çš„çœ‹ç€å¤´ç—›å•Šï¼Œ æ‰€ä»¥æˆ‘ä¹Ÿä¸çŸ¥é“è¿™ç¬¦ä¸ç¬¦åˆè„šæœ¬çš„ä»£ç è§„èŒƒå§ï¼Œä½†æ˜¯è‡ªæˆ‘æ„Ÿè§‰è‰¯å¥½ğŸ˜ğŸ˜ã€‚</p>\n<figure class=\"highlight plain hljs\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br><span class=\"line\">187</span><br><span class=\"line\">188</span><br><span class=\"line\">189</span><br><span class=\"line\">190</span><br><span class=\"line\">191</span><br><span class=\"line\">192</span><br><span class=\"line\">193</span><br><span class=\"line\">194</span><br><span class=\"line\">195</span><br><span class=\"line\">196</span><br><span class=\"line\">197</span><br><span class=\"line\">198</span><br><span class=\"line\">199</span><br><span class=\"line\">200</span><br><span class=\"line\">201</span><br><span class=\"line\">202</span><br><span class=\"line\">203</span><br><span class=\"line\">204</span><br><span class=\"line\">205</span><br><span class=\"line\">206</span><br><span class=\"line\">207</span><br><span class=\"line\">208</span><br><span class=\"line\">209</span><br><span class=\"line\">210</span><br><span class=\"line\">211</span><br><span class=\"line\">212</span><br><span class=\"line\">213</span><br><span class=\"line\">214</span><br><span class=\"line\">215</span><br><span class=\"line\">216</span><br><span class=\"line\">217</span><br><span class=\"line\">218</span><br><span class=\"line\">219</span><br><span class=\"line\">220</span><br><span class=\"line\">221</span><br><span class=\"line\">222</span><br><span class=\"line\">223</span><br><span class=\"line\">224</span><br><span class=\"line\">225</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#!/bin/sh</span><br><span class=\"line\"></span><br><span class=\"line\"># å½“å‰shellæ‰€å¤„çš„ç›®å½•</span><br><span class=\"line\">shell_dir_path=$(cd &quot;$(dirname &quot;$0&quot;)&quot;; pwd)</span><br><span class=\"line\"></span><br><span class=\"line\"># æŠŠé…ç½®æ–‡ä»¶é‡Œçš„å‚æ•°åœ¨è¯¥è„šæœ¬é‡Œå…¨å±€åŒ–</span><br><span class=\"line\">source $shell_dir_path&quot;/global.config&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">echo &quot;å¼€å§‹æ£€æŸ¥ç¯å¢ƒ...........&quot;</span><br><span class=\"line\"></span><br><span class=\"line\"># å¦‚æœå½’æ¡£æ–‡ä»¶å¤¹ä¸å­˜åœ¨åˆ™åˆ›å»º</span><br><span class=\"line\">if [ ! -d $package_root_path ]; then</span><br><span class=\"line\">    mkdir -pv $package_root_path</span><br><span class=\"line\">fi</span><br><span class=\"line\"></span><br><span class=\"line\"># å¦‚æœä¸å­˜åœ¨è®°å½•æ–‡ä»¶åˆ™åˆ›å»ºï¼Œå­˜åœ¨æ–‡ä»¶åˆ™æŠŠæ–‡ä»¶å†…å®¹å˜é‡åŠ å…¥åˆ°å…¨å±€å˜é‡</span><br><span class=\"line\">if [ -e $package_root_path&quot;result.txt&quot; ]; then</span><br><span class=\"line\">    source $package_root_path&quot;result.txt&quot;</span><br><span class=\"line\">    # åˆ¤æ–­svnæœ€åæäº¤ä¿¡æ¯æ˜¯å¦å·²ç»å½’æ¡£è¿‡ï¼Œå…¶ä¸­SVN_REVISIONæ˜¯SVNæäº¤æ—¶çš„ç¼–å·ï¼Œæ”¹å˜é‡</span><br><span class=\"line\">    # æ˜¯Jenkinsæä¾›çš„</span><br><span class=\"line\">    if [ $lastestBuildVersion = $SVN_REVISION ] ; then</span><br><span class=\"line\">        echo &quot;è¯¥ç‰ˆæœ¬å·²ç»æ‰“è¿‡åŒ…äº†ï¼Œè¯·é‡æ–°æäº¤ä¸€æ¬¡è®°å½•å¹¶ç¡®ä¿is_need_packageä¸ºtrue&quot;</span><br><span class=\"line\">        exit 1</span><br><span class=\"line\">    else</span><br><span class=\"line\">        # ä¸ºäº†èŠ‚çœç©ºé—´ï¼Œæ‰€ä»¥æ¯æ¬¡æ‰“åŒ…éƒ½ä¼šåœ¨å¼€å§‹å‰ç§»é™¤ä¹‹å‰æ–‡ä»¶</span><br><span class=\"line\">        rm -rf $package_archive_path*</span><br><span class=\"line\">        echo &quot;ç§»é™¤æ—§é¡¹ç›®å®Œæ¯•ï¼Œå‡†å¤‡å·¥ä½œå·²å°±ç»ª&quot;</span><br><span class=\"line\">    fi</span><br><span class=\"line\">else</span><br><span class=\"line\">    # åˆ›å»ºè®°å½•æ–‡æ¡£</span><br><span class=\"line\">    touch $package_root_path&quot;/result.txt&quot;</span><br><span class=\"line\">    chmod -R 777 $package_root_path&quot;/result.txt&quot;</span><br><span class=\"line\">    echo lastestBuildVersion=0 &gt;&gt; $package_root_path&quot;/result.txt&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">fi</span><br><span class=\"line\"></span><br><span class=\"line\"># æ£€æŸ¥æ˜¯å¦éœ€è¦æ‰“åŒ…</span><br><span class=\"line\">if ! $is_need_package; then</span><br><span class=\"line\">    exit 1</span><br><span class=\"line\">fi</span><br><span class=\"line\"></span><br><span class=\"line\"># æ£€æŸ¥æ˜¯å¦è®¾ç½®target/scheme</span><br><span class=\"line\">if test -z $package_target_name; then</span><br><span class=\"line\">\techo &quot;âŒ é¡¹ç›®Targetè®¾ç½®ä¸ºç©º&quot;</span><br><span class=\"line\">\texit 1</span><br><span class=\"line\">fi</span><br><span class=\"line\"></span><br><span class=\"line\">if test -z $package_scheme_name; then</span><br><span class=\"line\">\techo &quot;âŒ é¡¹ç›®Schemeè®¾ç½®ä¸ºç©º&quot;</span><br><span class=\"line\">\texit 1</span><br><span class=\"line\">fi</span><br><span class=\"line\"></span><br><span class=\"line\"># è¯»å–é…ç½®æ–‡ä»¶å½’æ¡£ç±»å‹æ˜¯Releaseè¿˜æ˜¯Debug</span><br><span class=\"line\">if $package_use_release; then</span><br><span class=\"line\">    build_configuration=&quot;Release&quot;</span><br><span class=\"line\">else</span><br><span class=\"line\">    build_configuration=&quot;Debug&quot;</span><br><span class=\"line\">fi</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">#  AdHoc: 1, AppStore: 2, Enterprise: 3, Development: 4</span><br><span class=\"line\"># å¯¼å‡ºipaåŒ…çš„plistæ–‡ä»¶å¤¹ï¼Œè¯¥æ–‡ä»¶åœ¨æ‰“åŒ…æ—¶ä¼šç”Ÿæˆ</span><br><span class=\"line\">options_dir_path=$package_export_options_dir_path</span><br><span class=\"line\">if [[ $package_export_type -eq 1 ]]; then</span><br><span class=\"line\">    export_options_plist_path=$options_dir_path&quot;AdHocExportOptions.plist&quot;</span><br><span class=\"line\">    export_type_name=&quot;AdHoc&quot;</span><br><span class=\"line\">elif [[ $package_export_type -eq 2 ]]; then</span><br><span class=\"line\">    export_options_plist_path=$options_dir_path&quot;AppStoreExportOptions.plist&quot;</span><br><span class=\"line\">    export_type_name=&quot;AppStore&quot;</span><br><span class=\"line\">elif [[ $package_export_type -eq 3 ]]; then</span><br><span class=\"line\">    export_options_plist_path=$options_dir_path&quot;EnterpriseExportOptions.plist&quot;</span><br><span class=\"line\">    export_type_name=&quot;Enterprise&quot;</span><br><span class=\"line\">elif [[ $package_export_type -eq 4 ]]; then</span><br><span class=\"line\">    export_options_plist_path=$options_dir_path&quot;DevelopmentExportOptions.plist&quot;</span><br><span class=\"line\">    export_type_name=&quot;Development&quot;</span><br><span class=\"line\">fi</span><br><span class=\"line\"></span><br><span class=\"line\">echo &quot;âœ…âœ…âœ… æ ¡éªŒå‚æ•°ä»¥åŠç¯å¢ƒæˆåŠŸ&quot;</span><br><span class=\"line\">echo &quot;âš¡ï¸ âš¡ï¸ âš¡ï¸å³å°†å¼€å§‹æ‰“åŒ… âš¡ï¸ âš¡ï¸ âš¡ï¸&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">##############################è‡ªåŠ¨æ‰“åŒ…éƒ¨åˆ†##############################</span><br><span class=\"line\"></span><br><span class=\"line\"># è¿”å›åˆ°å·¥ç¨‹ç›®å½•</span><br><span class=\"line\">cd ../</span><br><span class=\"line\">project_path=`pwd`</span><br><span class=\"line\"></span><br><span class=\"line\"># è·å–é¡¹ç›®åç§°</span><br><span class=\"line\">project_name=`find . -name *.xcodeproj | awk -F &quot;[/.]&quot; &apos;&#123;print $(NF-1)&#125;&apos;`</span><br><span class=\"line\"># æŒ‡å®šå·¥ç¨‹çš„Info.plist</span><br><span class=\"line\">current_info_plist_name=&quot;Info.plist&quot;</span><br><span class=\"line\"># é…ç½®Info.plistçš„è·¯å¾„</span><br><span class=\"line\">current_info_plist_path=&quot;$&#123;project_name&#125;/$&#123;current_info_plist_name&#125;&quot;</span><br><span class=\"line\"># è·å–é¡¹ç›®çš„ç‰ˆæœ¬å·</span><br><span class=\"line\">bundle_version=`/usr/libexec/PlistBuddy -c &quot;Print CFBundleShortVersionString&quot; $&#123;current_info_plist_path&#125;`</span><br><span class=\"line\"># è·å–é¡¹ç›®çš„ç¼–è¯‘ç‰ˆæœ¬å·</span><br><span class=\"line\">bundle_build_version=`/usr/libexec/PlistBuddy -c &quot;Print CFBundleVersion&quot; $&#123;current_info_plist_path&#125;`</span><br><span class=\"line\"></span><br><span class=\"line\"># å½“å‰ç‰ˆæœ¬å­˜æ”¾å¯¼å‡ºæ–‡ä»¶è·¯å¾„ï¼Œå¯ä»¥æ ¹æ®éœ€æ±‚æ·»åŠ ä¸åŒçš„è·¯å¾„</span><br><span class=\"line\">currentVersionArchivePath=&quot;$&#123;package_archive_path&#125;&quot;</span><br><span class=\"line\"></span><br><span class=\"line\"># åˆ¤æ–­å½’æ¡£å½“å‰ç‰ˆæœ¬æ–‡ä»¶å¤¹æ˜¯å¦å­˜åœ¨ï¼Œä¸å­˜åœ¨åˆ™åˆ›å»º</span><br><span class=\"line\">if [ ! -d $currentVersionArchivePath ]; then</span><br><span class=\"line\">    mkdir -pv $currentVersionArchivePath</span><br><span class=\"line\">    chmod -R 777 $currentVersionArchivePath</span><br><span class=\"line\">fi</span><br><span class=\"line\"></span><br><span class=\"line\"># å½’æ¡£æ–‡ä»¶è·¯å¾„</span><br><span class=\"line\">export_archive_path=&quot;$&#123;currentVersionArchivePath&#125;$&#123;package_scheme_name&#125;.xcarchive&quot;</span><br><span class=\"line\"># ipaå¯¼å‡ºè·¯å¾„</span><br><span class=\"line\">export_ipa_path=&quot;$&#123;currentVersionArchivePath&#125;&quot;</span><br><span class=\"line\"># è·å–æ—¶é—´ å¦‚:20190630_1420</span><br><span class=\"line\"># current_date=&quot;$(date +%Y%m%d_%H%M)&quot;</span><br><span class=\"line\"># ipa åå­—, å¯ä»¥æ ¹æ®ç‰ˆæœ¬å·æ¥è¿›è¡Œé‡å‘½å</span><br><span class=\"line\">ipa_name=&quot;$&#123;package_scheme_name&#125;_$&#123;SVN_REVISION&#125;.ipa&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">echo &quot;å·¥ç¨‹ç›®å½• = $&#123;project_path&#125;&quot;</span><br><span class=\"line\">echo &quot;å·¥ç¨‹Info.plistè·¯å¾„ = $&#123;current_info_plist_path&#125;&quot;</span><br><span class=\"line\">echo &quot;æ‰“åŒ…ç±»å‹ = $&#123;build_configuration&#125;&quot;</span><br><span class=\"line\">echo &quot;æ‰“åŒ…ä½¿ç”¨çš„plistæ–‡ä»¶è·¯å¾„ = $&#123;export_options_plist_path&#125;&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">###############################æ‰“åŒ…éƒ¨åˆ†#########################################</span><br><span class=\"line\"></span><br><span class=\"line\">echo &quot;ğŸ”†ğŸ”†ğŸ”†æ­£åœ¨ä¸ºæ‚¨å¼€å§‹æ‰“åŒ…ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€&quot;</span><br><span class=\"line\"></span><br><span class=\"line\"># æ˜¯å¦ä½¿ç”¨xxx.xcworkspaceå·¥ç¨‹æ–‡ä»¶è¿›è¡Œæ‰“åŒ…</span><br><span class=\"line\">if $package_use_workspace; then</span><br><span class=\"line\"></span><br><span class=\"line\">    if [[ $&#123;build_configuration&#125; == &quot;Debug&quot; ]]; then</span><br><span class=\"line\">        # 1. Clean</span><br><span class=\"line\">        xcodebuild clean  -workspace $&#123;project_name&#125;.xcworkspace \\</span><br><span class=\"line\">        -scheme $&#123;package_scheme_name&#125; \\</span><br><span class=\"line\">        -configuration $&#123;build_configuration&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        # 2. Archive</span><br><span class=\"line\">        xcodebuild archive  -workspace $&#123;project_name&#125;.xcworkspace \\</span><br><span class=\"line\">        -scheme $&#123;package_scheme_name&#125; \\</span><br><span class=\"line\">        -configuration $&#123;build_configuration&#125; \\</span><br><span class=\"line\">        -archivePath $&#123;export_archive_path&#125; \\</span><br><span class=\"line\">        CFBundleVersion=$&#123;bundle_build_version&#125; \\</span><br><span class=\"line\">        -destination generic/platform=ios \\</span><br><span class=\"line\"></span><br><span class=\"line\">    elif [[ $&#123;build_configuration&#125; == &quot;Release&quot; ]]; then</span><br><span class=\"line\"></span><br><span class=\"line\">        # 1. Clean</span><br><span class=\"line\">        xcodebuild clean  -workspace $&#123;project_name&#125;.xcworkspace \\</span><br><span class=\"line\">        -scheme $&#123;package_scheme_name&#125; \\</span><br><span class=\"line\">        -configuration $&#123;build_configuration&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        # 2. Archive</span><br><span class=\"line\">        xcodebuild archive  -workspace $&#123;project_name&#125;.xcworkspace \\</span><br><span class=\"line\">        -scheme $&#123;package_scheme_name&#125; \\</span><br><span class=\"line\">        -configuration $&#123;build_configuration&#125; \\</span><br><span class=\"line\">        -archivePath $&#123;export_archive_path&#125; \\</span><br><span class=\"line\">        CFBundleVersion=$&#123;bundle_build_version&#125; \\</span><br><span class=\"line\">        -destination generic/platform=ios \\</span><br><span class=\"line\"></span><br><span class=\"line\">    fi</span><br><span class=\"line\"></span><br><span class=\"line\">else</span><br><span class=\"line\"></span><br><span class=\"line\">    if [[ $&#123;build_configuration&#125; == &quot;Debug&quot; ]] ; then</span><br><span class=\"line\">        # 1. Clean</span><br><span class=\"line\">        xcodebuild clean  -project $&#123;project_name&#125;.xcodeproj \\</span><br><span class=\"line\">        -scheme $&#123;package_scheme_name&#125; \\</span><br><span class=\"line\">        -configuration $&#123;build_configuration&#125; \\</span><br><span class=\"line\">        -alltargets</span><br><span class=\"line\"></span><br><span class=\"line\">        # 2. Archive</span><br><span class=\"line\">        xcodebuild archive  -project $&#123;project_name&#125;.xcodeproj \\</span><br><span class=\"line\">        -scheme $&#123;package_scheme_name&#125; \\</span><br><span class=\"line\">        -configuration $&#123;build_configuration&#125; \\</span><br><span class=\"line\">        -archivePath $&#123;export_archive_path&#125; \\</span><br><span class=\"line\">        CFBundleVersion=$&#123;bundle_build_version&#125; \\</span><br><span class=\"line\">        -destination generic/platform=ios \\</span><br><span class=\"line\"></span><br><span class=\"line\">    elif [[ $&#123;build_configuration&#125; == &quot;Release&quot; ]]; then</span><br><span class=\"line\">        # 1. Clean</span><br><span class=\"line\">        xcodebuild clean  -project $&#123;project_name&#125;.xcodeproj \\</span><br><span class=\"line\">        -scheme $&#123;package_scheme_name&#125; \\</span><br><span class=\"line\">        -configuration $&#123;build_configuration&#125; \\</span><br><span class=\"line\">        -alltargets</span><br><span class=\"line\"></span><br><span class=\"line\">        # 2. Archive</span><br><span class=\"line\">        xcodebuild archive  -project $&#123;project_name&#125;.xcodeproj \\</span><br><span class=\"line\">        -scheme $&#123;package_scheme_name&#125; \\</span><br><span class=\"line\">        -configuration $&#123;build_configuration&#125; \\</span><br><span class=\"line\">        -archivePath $&#123;export_archive_path&#125; \\</span><br><span class=\"line\">        CFBundleVersion=$&#123;bundle_build_version&#125; \\</span><br><span class=\"line\">        -destination generic/platform=ios \\</span><br><span class=\"line\"></span><br><span class=\"line\">    fi</span><br><span class=\"line\">fi</span><br><span class=\"line\"></span><br><span class=\"line\"># æ£€æŸ¥æ˜¯å¦æ„å»ºæˆåŠŸ</span><br><span class=\"line\"># å› ä¸ºxxx.xcarchive æ˜¯ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸æ˜¯ä¸€ä¸ªæ–‡ä»¶</span><br><span class=\"line\">if [ -d $&#123;export_archive_path&#125; ]; then</span><br><span class=\"line\">    echo &quot;ğŸš€ ğŸš€ ğŸš€ é¡¹ç›®æ„å»ºæˆåŠŸ ğŸš€ ğŸš€ ğŸš€&quot;</span><br><span class=\"line\">else</span><br><span class=\"line\">    echo &quot;âš ï¸ âš ï¸ âš ï¸ é¡¹ç›®æ„å»ºå¤±è´¥ âš ï¸ âš ï¸ âš ï¸&quot;</span><br><span class=\"line\">    exit 1</span><br><span class=\"line\">fi</span><br><span class=\"line\"></span><br><span class=\"line\">echo &quot;å¼€å§‹å¯¼å‡ºipaæ–‡ä»¶&quot;</span><br><span class=\"line\"># å¯¼å‡ºipaæ–‡ä»¶</span><br><span class=\"line\">xcodebuild -exportArchive -archivePath $&#123;export_archive_path&#125; \\</span><br><span class=\"line\">-exportPath $&#123;export_ipa_path&#125; \\</span><br><span class=\"line\">-destination generic/platform=ios \\</span><br><span class=\"line\">-exportOptionsPlist $&#123;export_options_plist_path&#125; \\</span><br><span class=\"line\">-allowProvisioningUpdates</span><br><span class=\"line\"># é»˜è®¤å¯¼å‡ºipaæ–‡ä»¶è·¯å¾„</span><br><span class=\"line\">export_ipa_name=$export_ipa_path$package_scheme_name&quot;.ipa&quot;</span><br><span class=\"line\"></span><br><span class=\"line\"># åˆ¤æ–­æ˜¯å¦æœ‰è¿™ä¸ªå¯¼å‡ºipaæ–‡ä»¶</span><br><span class=\"line\">if [ -e $export_ipa_name ]; then</span><br><span class=\"line\">    # æ›´æ”¹åç§°ä¸º scheme_version.ipa schemeåç§°ä¸ºå·¥ç¨‹åç§°ï¼Œversionä¸ºsvnæœ€åæäº¤çš„ç‰ˆæœ¬</span><br><span class=\"line\">    mv $export_ipa_name $export_ipa_path$ipa_name</span><br><span class=\"line\">    # å°†å½“å‰ç‰ˆæœ¬è®¾ä¸ºå·²æ‰“åŒ…çŠ¶æ€</span><br><span class=\"line\">    echo lastestBuildVersion=$SVN_REVISION &gt; $package_root_path&quot;result.txt&quot;</span><br><span class=\"line\">    echo &quot;ğŸ‰ ğŸ‰ ğŸ‰ å¯¼å‡º $&#123;ipa_name&#125;.ipa åŒ…æˆåŠŸ ğŸ‰ ğŸ‰ ğŸ‰&quot;</span><br><span class=\"line\">else</span><br><span class=\"line\">    echo &quot;âŒ âŒ âŒ å¯¼å‡º $&#123;ipa_name&#125;.ipa åŒ…å¤±è´¥ âŒ âŒ âŒ&quot;</span><br><span class=\"line\">fi</span><br><span class=\"line\"></span><br><span class=\"line\"># è¾“å‡ºæ‰“åŒ…æ€»ç”¨æ—¶</span><br><span class=\"line\">echo &quot;æœ¬æ¬¡æ‰“åŒ…æ€»è€—æ—¶: $&#123;SECONDS&#125;s&quot;</span><br></pre></td></tr></table></figure>\n\n<p>æ˜¯ä¸æ˜¯æœ‰ç‚¹å¤´æ™•å“‡ï¼Œæˆ‘æ˜¯å¤´ç—›å•ŠğŸ¤—ğŸ¤—ï¼Œç©è¿‡ä½¿ç”¨<strong>Jenkins</strong>è„šæœ¬è‡ªåŠ¨æ‰“åŒ…çš„äººçœ‹å®Œè¿™ä¸ªåº”è¯¥çŸ¥é“æˆ‘çš„æ›²çº¿æ•‘å›½æ–¹å¼äº†ï¼Œæœ‰çš„åŒå­¦è‚¯å®šè¿˜åœ¨ğŸ˜³ğŸ˜³orğŸ¤”ğŸ¤”ã€‚æˆ‘ä»¬åœ¨<strong>é‡å¤´æˆ</strong>ä¸­è®²ğŸ¤—ğŸ¤—ã€‚</p>\n<h3 id=\"é‡å¤´æˆ\"><a href=\"#é‡å¤´æˆ\" class=\"headerlink\" title=\"é‡å¤´æˆ\"></a>é‡å¤´æˆ</h3><p>çœ‹é£æ ¼æˆ‘å°±ä¸æ˜¯å¼€è½¦çš„äººï¼Œå› ä¸ºå¼€è½¦å“ªæ¥è¿™ä¹ˆå¤šå‰æˆæ˜¯å§ï¼ŸğŸ¤”ğŸ¤”ï¼Œå¼€å§‹å‰¥ä¸æŠ½èŒ§å•¦ã€‚</p>\n<p>å‰é¢è¯´åˆ°åœ¨<strong>Jenkins</strong>ä¸­æ²¡æœ‰ç±»ä¼¼<strong>Git</strong>è¿™æ ·çš„æäº¤ä»£ç è‡ªåŠ¨æ‰“åŒ…çš„é’©å­æ’ä»¶ã€‚è€Œæˆ‘ä»¬ä½¿ç”¨<strong>Jenkins</strong>çš„ç›®çš„å°±æ˜¯ä¸ºäº†é‡Šæ”¾ç¨‹åºå‘˜çš„ğŸ‘ï¼Œç•™ç€æ›´å¤šæ—¶é—´å¹²æ­£äº‹ï¼Œå¦‚æœä¸èƒ½å®ç°æäº¤è‡ªåŠ¨æ‰“åŒ…é‚£æœ‰æ— <strong>Jenkins</strong>éƒ½ä¸€æ ·äº†ï¼Œè¿˜ä¸å¦‚è‡ªå·±å†™ä¸ªè„šæœ¬æ‰“åŒ…å‘¢ï¼Œæ˜¯å§ï¼Ÿå¦‚æœæ˜¯ä½ ä½ ä¼šæ€ä¹ˆåšå‘¢ï¼Ÿ</p>\n<p>æˆ‘ä»¬çŸ¥é“Jenkinsæœ‰ä¸ªå®šæœŸæ‰§è¡Œä»»åŠ¡çš„é€‰é¡¹ï¼Œæˆ‘ä»¬åªéœ€å¡«ä¸Šå‚æ•°ï¼šH/2 * * * *  ç„¶åå°±ä¼šæ¯ä¸¤åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ï¼Œæ˜¯ä¸æ˜¯æƒ³è¯´ä¸ºå•¥ä¸è®¾ç½®1åˆ†é’Ÿï¼Œæˆ‘ä¹Ÿæƒ³å“‡ï¼Œ<strong>Jenkins</strong>ä¸è®©å•ŠğŸ˜ğŸ˜ã€‚ä½†æ˜¯æ€»ä¸èƒ½è®©è¿™å®¶ä¼™æ¯ä¸¤åˆ†é’Ÿä¸€ç›´æ‰“å§ï¼Œè¦†ç›–è¿˜å¥½ï¼Œä½†æ˜¯æ¯ä¸¤åˆ†é’Ÿå°±æœ‰ä¸€ä¸ªæ–°çš„å®‰è£…åŒ…ä¸Šä¼ è‡³æµ‹è¯•æœåŠ¡å™¨ä¹Ÿä¸å¥½å§ï¼Œæ„Ÿè§‰ä¼šè¢«æµ‹è¯•äººå‘˜æ‰“å±ğŸ˜±ğŸ˜±ã€‚é‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦è§£å†³è¿™ä¸ªæ‰“æ–­æ‰“åŒ…çš„æ¡ä»¶ğŸ¤”ã€‚æ—¢ä¸èƒ½åœ¨å·¥ç¨‹ä¸­è®¾ç½®ï¼Œä¸ç„¶<strong>Jenkins</strong>æ¯æ¬¡æ‰§è¡Œä»»åŠ¡å°±è¦†ç›–äº†ï¼Œä¹Ÿå°±æ˜¯åªèƒ½åœ¨æ‰“åŒ…ç”µè„‘ä¸Šä¿å­˜ä¸€ä¸ªçŠ¶æ€ã€‚é‚£ä¹ˆå¾ˆå¥½è§£å†³å•¦ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨è„šæœ¬ä¸­åˆ›å»ºä¸€ä¸ªæ–‡ä»¶æ¥è®°å½•ä¸Šæ¬¡æ‰“åŒ…çš„<strong>SVN_REVISION</strong>ï¼Œå°±èƒ½è®©è„šæœ¬è¯»å–æ–‡ä»¶è®°å½•åˆ¤æ–­æ˜¯å¦å·²ç»æ‰“è¿‡åŒ…äº†ï¼Œæ²¡æœ‰æ‰“è¿‡åŒ…æ‰æ‰§è¡Œç¨‹åºï¼Œå¦åˆ™é€€å‡ºç¨‹åºã€‚ğŸ˜‰ğŸ˜‰ç°åœ¨æƒ³æƒ³æ˜¯ä¸æ˜¯å¾ˆç®€å•å“‡ï¼Œç„¶åå°±å¯ä»¥å°½æƒ…çš„å“’å“’å“’ã€‚</p>\n<p>ä½¿ç”¨FTPä¸Šä¼ è‡³æµ‹è¯•æœåŠ¡å™¨è¿™éƒ¨åˆ†è¯¥å¦‚ä½•è§£å†³å‘¢ï¼Ÿå› ä¸ºæ¶‰åŠåˆ°å¯å˜å‚æ•°ï¼Œè„šæœ¬é‚£ä¹ˆå·®çš„æˆ‘åªèƒ½ä½¿ç”¨åœŸåŠæ³•ï¼Œä¸€æ‹›ä¸€æ‹›æ¥ï¼Œå¹²åˆ°ä¸æœä¸ºæ­¢ğŸ˜ğŸ˜ã€‚è¿™éƒ¨åˆ†è„šæœ¬æ˜¯ä¸Šé¢é‚£é•¿ä¸²ä»£ç çš„æœ«å°¾åçš„ä»£ç ã€‚</p>\n<figure class=\"highlight plain hljs\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">############################ä¸Šä¼ éƒ¨åˆ†#####################################</span><br><span class=\"line\"></span><br><span class=\"line\">function createUploadShell()&#123;</span><br><span class=\"line\">    touch upload.sh</span><br><span class=\"line\">    chmod -R 777 upload.sh</span><br><span class=\"line\">    echo &quot;cd $&#123;package_archive_path&#125;&quot; &gt;&gt; upload.sh</span><br><span class=\"line\">    echo &quot;ftp -i -n -v &lt;&lt; !&quot; &gt;&gt; upload.sh</span><br><span class=\"line\">    echo &quot;open 117.xx.xxx.xxx&quot; &gt;&gt; upload.sh</span><br><span class=\"line\">    echo &quot;user oymuzi xxxx&quot; &gt;&gt; upload.sh</span><br><span class=\"line\">    echo &quot;cd ./$&#123;upload_dir_path&#125;&quot; &gt;&gt; upload.sh</span><br><span class=\"line\">    current_date=&quot;$(date +%Y%m%d%H%M%S)&quot;</span><br><span class=\"line\">    ipa_new_name=$package_scheme_name&quot;_&quot;$current_date&quot;.ipa&quot;</span><br><span class=\"line\">    echo &quot;binary&quot; &gt;&gt; upload.sh</span><br><span class=\"line\">    echo &quot;put $&#123;upload_volumes_name&#125;$&#123;package_archive_path&#125;$&#123;ipa_name&#125; ./$&#123;ipa_new_name&#125;&quot; &gt;&gt; upload.sh</span><br><span class=\"line\">    echo &quot;close&quot; &gt;&gt; upload.sh</span><br><span class=\"line\">    echo &quot;bye&quot; &gt;&gt; upload.sh</span><br><span class=\"line\">    echo &quot;!&quot; &gt;&gt; upload.sh</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">cd $package_archive_path</span><br><span class=\"line\">createUploadShell</span><br><span class=\"line\">echo &quot;åˆ›å»ºä¸Šä¼ è„šæœ¬æˆåŠŸ&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">echo &quot;ğŸš€ ğŸš€ ğŸš€ å¼€å§‹ä¸Šä¼ è‡³äº‘ç«¯  ğŸš€ ğŸš€ ğŸš€&quot;</span><br><span class=\"line\">sh upload.sh</span><br><span class=\"line\">echo &quot;ä¸Šä¼ è‡³äº‘ç«¯å®Œæˆ&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">rm -f upload.sh</span><br></pre></td></tr></table></figure>\n\n<p>å¯¹ï¼Œå°±æ˜¯è¿™ä¹ˆfeel å€çˆ½ï¼Œå¤§ä½¬å¯ä»¥è‡ªå·±è¿›è¡Œæ›´æ”¹è„šæœ¬ã€‚å…¶ä¸­ä¸€ç‚¹å°±æ˜¯ä½¿ç”¨FTPå‘½ä»¤å¿…é¡»ä½¿ç”¨<code>ftp -i -n -v &lt;&lt; !  ä½ æƒ³è¦çš„æ‰§è¡Œçš„FTPå‘½ä»¤  !</code>ã€‚è‡³äºä¸Šä¼ å…¬å¸æœåŠ¡å™¨è¿˜æ˜¯è’²å…¬è‹±ç­‰å¹³å°ï¼Œè¿™ä¸ªå¯ä»¥æ ¹æ®å„è‡ªå…¬å¸çš„è§„åˆ™å§ï¼Œè‡ªå·±è¿›è¡Œä¿®æ”¹å“ˆã€‚</p>\n<p>æºç åœ°å€ï¼š<a href=\"https://github.com/oymuzi/OMPackaging\" target=\"_blank\" rel=\"noopener\">OMPackaging</a>(æ³¨ï¼šæ­¤demoä»…ä¸ºäº†å±•ç¤ºæºç ï¼ŒæŒ‰ç…§æºç å’Œæ–‡ç« æ‰€è¯´çš„åŠæ³•è®¾ç½®ç¯å¢ƒå³å¯æ­£å¸¸æ‰“åŒ…)</p>\n<h3 id=\"è¨€å½’æ­£ä¼ \"><a href=\"#è¨€å½’æ­£ä¼ \" class=\"headerlink\" title=\"è¨€å½’æ­£ä¼ \"></a>è¨€å½’æ­£ä¼ </h3><p>åˆ©ç”¨<strong>Jenkins</strong>çš„å®šæ­»æ‰§è¡Œä»»åŠ¡åŠŸèƒ½ï¼Œåœ¨æœ¬åœ°ä¿å­˜ä¸€ä¸ªæ‰“åŒ…çš„çŠ¶æ€ï¼Œç„¶åå°±èƒ½æ¯æ¬¡æäº¤ä»£ç åè¿›è¡Œè‡ªåŠ¨æ‰“åŒ…ï¼Œæœ‰1-2åˆ†é’Ÿçš„å»¶è¿Ÿï¼Œè€Œä¸”è¦æ‰§è¡Œæ‰“åŒ…å¿…é¡»ç¡®ä¿é…ç½®æ–‡ä»¶ä¸­çš„<code>is_need_package</code>ä¸ºtrueå¹¶æäº¤ä¸€æ¬¡ä»£ç ã€‚åœ¨ä¸Šä¼ è‡³æµ‹è¯•æœåŠ¡å™¨ï¼Œæµ‹è¯•äººå‘˜å°±èƒ½ç›´æ¥ä¸‹è½½å®‰è£…ã€‚è¿™ä¸ªæ–¹æ¡ˆè™½ç„¶æœ‰äº›å»¶è¿Ÿï¼Œä½†æ˜¯è§£å†³äº†è‡ªåŠ¨æ‰“åŒ…çš„é—®é¢˜ã€‚</p>\n<p>å‚è€ƒï¼š</p>\n<p><a href=\"https://blog.csdn.net/weixinyi21cn/article/details/79151620\" target=\"_blank\" rel=\"noopener\">Mac shell ä¸Šä¼ æ–‡ä»¶(åœ¨shellä¸­ä½¿ç”¨FTPå‘½ä»¤)</a></p>\n<p><a href=\"https://developer.apple.com/library/archive/technotes/tn2339/_index.html\" target=\"_blank\" rel=\"noopener\">Building from the Command Line with Xcode FAQ</a></p>\n","site":{"data":{}},"excerpt":"<h3 id=\"å‰è¨€\"><a href=\"#å‰è¨€\" class=\"headerlink\" title=\"å‰è¨€\"></a>å‰è¨€</h3><p>ä¹‹å‰å†™è¿‡ä¸€ç¯‡<a href=\"https://juejin.im/post/5ca8c81e6fb9a05e6668ab56\" target=\"_blank\" rel=\"noopener\">åŸºäºJenkinså’ŒFastlaneè‡ªåŠ¨æ‰“åŒ…</a>çš„æ–‡ç« ï¼Œæ–‡ä¸­ç®€è¿°äº†å¾ˆå¤šçš„çš„ç¯å¢ƒæ­å»ºä»¥åŠä¸€äº›é‡åˆ°çš„é—®é¢˜ã€‚è¿™ç¯‡æ–‡ç« çš„ç›®çš„æ˜¯ä½¿ç”¨è„šæœ¬å’Œ<strong>Jenkins</strong>æ¥è‡ªåŠ¨æ‰“åŒ…ï¼Œä¸ºä½•ä¸åœ¨ä½¿ç”¨ä¹‹å‰çš„<strong>Fastlane</strong>å‘¢ï¼Ÿé¦–å…ˆ<strong>Fastlane</strong>æ˜¯å¾ˆä¸é”™çš„ï¼Œä¹Ÿæ˜¯ä½¿ç”¨<strong>xcodebuild</strong>å‘½ä»¤æ¥å°è£…å®ç°çš„ï¼Œä½†æ˜¯åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­ä¼šæ¶‰åŠåˆ°ä¸€ä¸ªè„šæœ¬çš„è¿ç§»èƒ½åŠ›å³è¿ç”¨åˆ°å…¶ä»–é¡¹ç›®ä¸Šï¼Œæˆ‘è®¤ä¸ºæ˜¯ä¸ç®—é«˜çš„ï¼Œè‡³å°‘åœ¨<strong>Jenkins</strong>ä¸Šã€‚åæ­£<strong>Fastlane</strong>ä¹Ÿæ˜¯åŸºäº<strong>xcodebuild</strong>æ¥è¿›è¡Œç¼–è¯‘æ‰“åŒ…çš„ï¼Œé‚£æˆ‘ä»¬ä½•ä¸ç›´æ¥ç¼–å†™è„šæœ¬è¿›è¡Œæ‰“åŒ…å‘¢ï¼Ÿ</p>","more":"<p>è¿˜æœ‰ä¸€ä¸ªé—®é¢˜å°±æ˜¯å¤§å®¶éƒ½çŸ¥é“ä½¿ç”¨<strong>Git</strong>åŸºäº<strong>Jenkins</strong>çš„è‡ªåŠ¨åŒ–æ‰“åŒ…å¯ä»¥ç›´æ¥åœ¨æ¯æ¬¡æäº¤æ—¶å®ç°è‡ªåŠ¨æ‰“åŒ…ï¼Œä½†æ˜¯åœ¨<strong>Jenkins</strong>ä¸­ä½¿ç”¨<strong>SVN</strong>æˆ‘ä»¬æ²¡æœ‰å‘ç°ç±»ä¼¼è¿™ä¸ªåŠŸèƒ½çš„æ’ä»¶ã€‚æ–‡ä¸­çš„è§£å†³åŠæ³•æ˜¯ä¸€ç§æ›²çº¿æ•‘å›½çš„æ–¹æ³•ï¼Œåœ¨æ–‡ç« çš„ä¸‹åŠéƒ¨åˆ†ä¼šè®²åˆ°ã€‚æˆ‘ä¸€å¼€å§‹çš„æ„æ€è¿˜æ˜¯æƒ³é€šè¿‡å±€åŸŸç½‘æ¥å®ç°ï¼Œä½†æ˜¯è¶Šåˆ°åé¢å‘ç°è¡Œä¸é€šï¼Œæ²¡æœ‰æ„Ÿè§‰åˆ°è‡ªåŠ¨æ‰“åŒ…å¸¦æ¥çš„ä¾¿åˆ©ã€‚<strong>äºæ˜¯æœ‰äº†æœ¬æ–‡è¿™ä¸ªæ–¹æ¡ˆ</strong>ã€‚</p>\n<h3 id=\"å‡†å¤‡\"><a href=\"#å‡†å¤‡\" class=\"headerlink\" title=\"å‡†å¤‡\"></a>å‡†å¤‡</h3><p>â‘ è¯·ç¡®ä¿æ‰“åŒ…ç”µè„‘çš„ç¯å¢ƒå·²ç»å®‰è£…å¥½äº†HomeBrewã€Jenkins(å»ºè®®ä½¿ç”¨brewå®‰è£…Jenkinså¹¶è¿›è¡Œå¼€æœºè‡ªå¯åŠ¨)</p>\n<p>â‘¡è¯·ç¡®ä¿æ‰“åŒ…ç”µè„‘çš„è¦æ˜¯ä¸²ä¸­æœ‰ä½ éœ€è¦æ‰“åŒ…çš„APPæ‰€éœ€çš„è¯ä¹¦ã€æè¿°æ–‡ä»¶</p>\n<p>â‘¢è¯·ç¡®ä¿æ­¤æ‰“åŒ…è„šæœ¬ç”¨äºåŸºäºæäº¤SVNå’ŒJenkinsç¯å¢ƒä¸­è‡ªåŠ¨æ‰“åŒ…ï¼Œå¦åˆ™å°†ä¼šå¯¼è‡´è„šæœ¬ä¸å¯ç”¨çš„çŠ¶æ€ğŸ˜‚ğŸ˜‚</p>\n<h3 id=\"æ‰“åŒ…ç»“æ„\"><a href=\"#æ‰“åŒ…ç»“æ„\" class=\"headerlink\" title=\"æ‰“åŒ…ç»“æ„\"></a>æ‰“åŒ…ç»“æ„</h3><p>å…·ä½“çš„ç»“æ„å¯ä»¥å‚ç…§ä¸‹å›¾ï¼Œå¦‚æœæœ‰å…¶ä»–çš„ç±»å‹çš„æ‰“åŒ…ï¼Œå¯ä»¥åœ¨Plistæ–‡ä»¶å¤¹ä¸­æ·»åŠ æ–°çš„plistæ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶å¯ä»¥åœ¨æ‰‹åŠ¨æ‰“åŒ…æ—¶å¯¼å‡ºçš„æ–‡ä»¶å¤¹é‡Œæœ‰xxxExportOptions.plistæ–‡ä»¶ã€‚ç„¶ååœ¨é…ç½®æ–‡ä»¶é‡Œé¢è¿›è¡Œæ›´æ”¹ç±»å‹ã€‚</p>\n<p><img src=\"http://cloud.minder.mypup.cn/blog/%E8%87%AA%E5%8A%A8%E6%89%93%E5%8C%85%E7%BB%93%E6%9E%84%E5%9B%BE.jpg\" alt></p>\n<h4 id=\"å‰æˆ\"><a href=\"#å‰æˆ\" class=\"headerlink\" title=\"å‰æˆ\"></a>å‰æˆ</h4><p>ä¿®æ”¹é…ç½®æ–‡ä»¶å°±èƒ½ç›´æ¥æ§åˆ¶æ‰“åŒ…ç±»å‹æ˜¯ä¸æ˜¯å¾ˆæ–¹ä¾¿ã€‚ä¸€å¼€å§‹é‡‡ç”¨jsonæ–‡ä»¶æ¥è¿›è¡Œé…ç½®ï¼Œä½¿ç”¨jsonæ–‡ä»¶çš„è¯å¯¹æˆ‘æ¥è¯´æœ‰ä¸¤ä¸ªç¼ºç‚¹ã€‚å…¶ä¸€å°±æ˜¯jsonæ–‡ä»¶ä¸­æ— æ³•è¿›è¡Œæ³¨é‡Šï¼Œè¿™ä¼šå¯¼è‡´åé¢æ¥æ‰‹çš„äººæ— æ³•æ˜ç™½å…¶æ„ï¼Œæˆ–è€…éœ€è¦åœ¨æ·»åŠ ä¸€ä¸ªè¯´æ˜æ–‡æ¡£ï¼›å…¶äºŒæ˜¯å› ä¸ºåœ¨ä½¿ç”¨jsoné…ç½®è·¯å¾„çš„æ—¶å€™è¿˜éœ€è¦å¯¹å€¼è¿›è¡Œå»é™¤åŒå¼•å·ï¼Œå¯ä»¥å®ç°å¾ˆéº»çƒ¦ã€‚å¦å¤–å°±æ˜¯Shellè§£æjsonæ•°æ®è¿˜æ˜¯æœ‰ç‚¹éº»çƒ¦ï¼Œä½¿ç”¨jqè§£ææŒºæ–¹ä¾¿å°±æ˜¯å¾—é…ç½®ä¸€ä¸‹ç¯å¢ƒã€‚å…¶ä¸­global.configä»£ç å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">#æ˜¯å¦éœ€è¦æ‰“åŒ…</span><br><span class=\"line\">is_need_package=true</span><br><span class=\"line\"></span><br><span class=\"line\">#ç”Ÿäº§ç¯å¢ƒ/å¼€å‘ç¯å¢ƒè¯ä¹¦è®¾ç½®</span><br><span class=\"line\">code_sign_distribution=&quot;iPhone Distribution: xxxx xxx (xxx)&quot;</span><br><span class=\"line\">code_sign_development=&quot;iPhone Developer: xxxx xxxx (xxx)&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">#é¡¹ç›®çš„target/schemeè®¾ç½® </span><br><span class=\"line\">package_target_name=&quot;xxx&quot;</span><br><span class=\"line\">package_scheme_name=&quot;xxx&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">#æ‰“åŒ…ç»“æœæ ¹ç›®å½•</span><br><span class=\"line\">package_root_path=/Users/xxx/Desktop/Package/</span><br><span class=\"line\">#æ‰“åŒ…ipaç›®å½•</span><br><span class=\"line\">package_archive_path=/Users/xxx/Desktop/Package/Archive/</span><br><span class=\"line\"></span><br><span class=\"line\">#æ‰“åŒ…ç±»å‹  AdHocï¼š1 AppStoreï¼š2  Enterpriseï¼š3  Developmentï¼š4</span><br><span class=\"line\">package_export_type=1</span><br><span class=\"line\">#æ‰“åŒ…å­˜æ”¾çš„xxxExportOptions.plistæ–‡ä»¶å¤¹</span><br><span class=\"line\">package_export_options_dir_path=./AutoPacking/Plist/</span><br><span class=\"line\"></span><br><span class=\"line\">#æ˜¯å¦ä½¿ç”¨workspaceè¿›è¡Œæ‰“åŒ…</span><br><span class=\"line\">package_use_workspace=true</span><br><span class=\"line\">#æ˜¯å¦ä½¿ç”¨Releaseæ¨¡å¼è¿›è¡Œæ‰“åŒ…</span><br><span class=\"line\">package_use_release=true</span><br><span class=\"line\"></span><br><span class=\"line\">#è®°å½•æ‰“åŒ…å‰ç¼€</span><br><span class=\"line\">record_perfix=&quot;CEG&quot;</span><br></pre></td></tr></table></figure>\n\n<p>æ˜¯ä¸æ˜¯è§‰å¾—å¾ˆç®€å•ï¼Œä½†æ˜¯é˜…è¯»æ€§ä¸æ˜¯å¾ˆé«˜å§ï¼Œ åœ¨Xcodeä¸­æ²¡æœ‰é«˜äº®æ˜¾ç¤ºï¼Œéƒ½æ˜¯ä¸€ä¸ªè‰²å®¹æ˜“çŠ¯å›°ã€‚ä½†æ˜¯ä½¿ç”¨è¶…çº§ç®€å•</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">source global.config</span><br></pre></td></tr></table></figure>\n\n<p>æ˜¯ä¸æ˜¯å¾ˆç®€å•ï¼ŒğŸ˜€ğŸ˜€ï¼Œåªéœ€è¦ä¸€ä¸ªå‘½ä»¤ï¼Œå³å¯è·å¾—å…¨éƒ¨çš„å…¨å±€å˜é‡ï¼Œ$is_need_packageå°±èƒ½è·å¾—å€¼ï¼Œè·¯å¾„ä¹Ÿæ˜¯ï¼Œæ‰€ä»¥æˆ‘é€‰æ‹©äº†è¿™ç§æ–¹å¼æ¥è¿›è¡Œåšé…ç½®æ–‡ä»¶ï¼Œå¯¹ä¸åŒçš„äººæœ‰ä¸åŒçš„æ•ˆæœï¼Œå¯¹æˆ‘ä¸ç†Ÿæ‚‰è„šæœ¬çš„äººçœŸçš„å¤ªæœ‰å¥½äº†ã€‚æœ‰ä¸ªæ³¨æ„ç‚¹å°±æ˜¯ä¸€è¡Œåªèƒ½å†™ä¸€ä¸ªå˜é‡ï¼Œå¹¶ä¸”å˜é‡å’Œå€¼ä¹‹é—´åªèƒ½æœ‰ç­‰äºå·ï¼Œä¸èƒ½æœ‰ç©ºæ ¼å·æ¥è¿›è¡Œå¯¹é½ğŸ¤¡ğŸ¤¡ï¼Œæ˜¯ä¸æ˜¯è§‰å¾—è¿æœ€åçš„ç¾åŒ–æœºä¼šéƒ½æ²¡æœ‰å•¦ğŸ˜ã€‚å…¶å®ä¹ æƒ¯å°±å¥½ã€‚ğŸ™‚</p>\n<h4 id=\"åæˆ\"><a href=\"#åæˆ\" class=\"headerlink\" title=\"åæˆ\"></a>åæˆ</h4><p>å°ä¼™å­åˆ«ç›¯ç€çœ‹æ ‡é¢˜å“ˆï¼Œæ€æƒ³å¾ˆå±é™©å“ˆğŸ˜…ï¼Œæˆ‘ä¸æ˜¯æ¥å¼€è½¦çš„ï¼Œè¯´å®Œé…ç½®æ–‡ä»¶å°±è¯¥è¯´è¯´è¿™ä¸ªæ‰“åŒ…è„šæœ¬äº†ã€‚è¿˜è®°å¾—å‡†å¤‡å·¥ä½œä¸­è¯´äº†è¦åœ¨<strong>SVN</strong>ä¸­å—ï¼Œå› ä¸ºç”¨åˆ°äº†Jenkinsä¸­å…¨å±€æ„å»ºå‚æ•°<strong>SVN_REVISION</strong>,å¦å¤–çœ‹è¿™ä¸ªè„šæœ¬å…¶å®æœ‰ç‚¹çƒ¦ï¼Œå› ä¸ºå¾ˆå¤§éƒ¨åˆ†ä»£ç æ˜¯åœ¨åšå‰æˆå·¥ä½œğŸ˜‰ğŸ˜‰ï¼ŒçœŸæ­£<strong>xcodebuild</strong>å‘½ä»¤åœ¨æœ«å°¾äº†ã€‚å¦å¤–æˆ‘å†™è„šæœ¬å–œæ¬¢éƒ½æ˜¯å°å†™ï¼Œå…¨å¤§å†™çš„çœ‹ç€å¤´ç—›å•Šï¼Œ æ‰€ä»¥æˆ‘ä¹Ÿä¸çŸ¥é“è¿™ç¬¦ä¸ç¬¦åˆè„šæœ¬çš„ä»£ç è§„èŒƒå§ï¼Œä½†æ˜¯è‡ªæˆ‘æ„Ÿè§‰è‰¯å¥½ğŸ˜ğŸ˜ã€‚</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br><span class=\"line\">187</span><br><span class=\"line\">188</span><br><span class=\"line\">189</span><br><span class=\"line\">190</span><br><span class=\"line\">191</span><br><span class=\"line\">192</span><br><span class=\"line\">193</span><br><span class=\"line\">194</span><br><span class=\"line\">195</span><br><span class=\"line\">196</span><br><span class=\"line\">197</span><br><span class=\"line\">198</span><br><span class=\"line\">199</span><br><span class=\"line\">200</span><br><span class=\"line\">201</span><br><span class=\"line\">202</span><br><span class=\"line\">203</span><br><span class=\"line\">204</span><br><span class=\"line\">205</span><br><span class=\"line\">206</span><br><span class=\"line\">207</span><br><span class=\"line\">208</span><br><span class=\"line\">209</span><br><span class=\"line\">210</span><br><span class=\"line\">211</span><br><span class=\"line\">212</span><br><span class=\"line\">213</span><br><span class=\"line\">214</span><br><span class=\"line\">215</span><br><span class=\"line\">216</span><br><span class=\"line\">217</span><br><span class=\"line\">218</span><br><span class=\"line\">219</span><br><span class=\"line\">220</span><br><span class=\"line\">221</span><br><span class=\"line\">222</span><br><span class=\"line\">223</span><br><span class=\"line\">224</span><br><span class=\"line\">225</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#!/bin/sh</span><br><span class=\"line\"></span><br><span class=\"line\"># å½“å‰shellæ‰€å¤„çš„ç›®å½•</span><br><span class=\"line\">shell_dir_path=$(cd &quot;$(dirname &quot;$0&quot;)&quot;; pwd)</span><br><span class=\"line\"></span><br><span class=\"line\"># æŠŠé…ç½®æ–‡ä»¶é‡Œçš„å‚æ•°åœ¨è¯¥è„šæœ¬é‡Œå…¨å±€åŒ–</span><br><span class=\"line\">source $shell_dir_path&quot;/global.config&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">echo &quot;å¼€å§‹æ£€æŸ¥ç¯å¢ƒ...........&quot;</span><br><span class=\"line\"></span><br><span class=\"line\"># å¦‚æœå½’æ¡£æ–‡ä»¶å¤¹ä¸å­˜åœ¨åˆ™åˆ›å»º</span><br><span class=\"line\">if [ ! -d $package_root_path ]; then</span><br><span class=\"line\">    mkdir -pv $package_root_path</span><br><span class=\"line\">fi</span><br><span class=\"line\"></span><br><span class=\"line\"># å¦‚æœä¸å­˜åœ¨è®°å½•æ–‡ä»¶åˆ™åˆ›å»ºï¼Œå­˜åœ¨æ–‡ä»¶åˆ™æŠŠæ–‡ä»¶å†…å®¹å˜é‡åŠ å…¥åˆ°å…¨å±€å˜é‡</span><br><span class=\"line\">if [ -e $package_root_path&quot;result.txt&quot; ]; then</span><br><span class=\"line\">    source $package_root_path&quot;result.txt&quot;</span><br><span class=\"line\">    # åˆ¤æ–­svnæœ€åæäº¤ä¿¡æ¯æ˜¯å¦å·²ç»å½’æ¡£è¿‡ï¼Œå…¶ä¸­SVN_REVISIONæ˜¯SVNæäº¤æ—¶çš„ç¼–å·ï¼Œæ”¹å˜é‡</span><br><span class=\"line\">    # æ˜¯Jenkinsæä¾›çš„</span><br><span class=\"line\">    if [ $lastestBuildVersion = $SVN_REVISION ] ; then</span><br><span class=\"line\">        echo &quot;è¯¥ç‰ˆæœ¬å·²ç»æ‰“è¿‡åŒ…äº†ï¼Œè¯·é‡æ–°æäº¤ä¸€æ¬¡è®°å½•å¹¶ç¡®ä¿is_need_packageä¸ºtrue&quot;</span><br><span class=\"line\">        exit 1</span><br><span class=\"line\">    else</span><br><span class=\"line\">        # ä¸ºäº†èŠ‚çœç©ºé—´ï¼Œæ‰€ä»¥æ¯æ¬¡æ‰“åŒ…éƒ½ä¼šåœ¨å¼€å§‹å‰ç§»é™¤ä¹‹å‰æ–‡ä»¶</span><br><span class=\"line\">        rm -rf $package_archive_path*</span><br><span class=\"line\">        echo &quot;ç§»é™¤æ—§é¡¹ç›®å®Œæ¯•ï¼Œå‡†å¤‡å·¥ä½œå·²å°±ç»ª&quot;</span><br><span class=\"line\">    fi</span><br><span class=\"line\">else</span><br><span class=\"line\">    # åˆ›å»ºè®°å½•æ–‡æ¡£</span><br><span class=\"line\">    touch $package_root_path&quot;/result.txt&quot;</span><br><span class=\"line\">    chmod -R 777 $package_root_path&quot;/result.txt&quot;</span><br><span class=\"line\">    echo lastestBuildVersion=0 &gt;&gt; $package_root_path&quot;/result.txt&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">fi</span><br><span class=\"line\"></span><br><span class=\"line\"># æ£€æŸ¥æ˜¯å¦éœ€è¦æ‰“åŒ…</span><br><span class=\"line\">if ! $is_need_package; then</span><br><span class=\"line\">    exit 1</span><br><span class=\"line\">fi</span><br><span class=\"line\"></span><br><span class=\"line\"># æ£€æŸ¥æ˜¯å¦è®¾ç½®target/scheme</span><br><span class=\"line\">if test -z $package_target_name; then</span><br><span class=\"line\">\techo &quot;âŒ é¡¹ç›®Targetè®¾ç½®ä¸ºç©º&quot;</span><br><span class=\"line\">\texit 1</span><br><span class=\"line\">fi</span><br><span class=\"line\"></span><br><span class=\"line\">if test -z $package_scheme_name; then</span><br><span class=\"line\">\techo &quot;âŒ é¡¹ç›®Schemeè®¾ç½®ä¸ºç©º&quot;</span><br><span class=\"line\">\texit 1</span><br><span class=\"line\">fi</span><br><span class=\"line\"></span><br><span class=\"line\"># è¯»å–é…ç½®æ–‡ä»¶å½’æ¡£ç±»å‹æ˜¯Releaseè¿˜æ˜¯Debug</span><br><span class=\"line\">if $package_use_release; then</span><br><span class=\"line\">    build_configuration=&quot;Release&quot;</span><br><span class=\"line\">else</span><br><span class=\"line\">    build_configuration=&quot;Debug&quot;</span><br><span class=\"line\">fi</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">#  AdHoc: 1, AppStore: 2, Enterprise: 3, Development: 4</span><br><span class=\"line\"># å¯¼å‡ºipaåŒ…çš„plistæ–‡ä»¶å¤¹ï¼Œè¯¥æ–‡ä»¶åœ¨æ‰“åŒ…æ—¶ä¼šç”Ÿæˆ</span><br><span class=\"line\">options_dir_path=$package_export_options_dir_path</span><br><span class=\"line\">if [[ $package_export_type -eq 1 ]]; then</span><br><span class=\"line\">    export_options_plist_path=$options_dir_path&quot;AdHocExportOptions.plist&quot;</span><br><span class=\"line\">    export_type_name=&quot;AdHoc&quot;</span><br><span class=\"line\">elif [[ $package_export_type -eq 2 ]]; then</span><br><span class=\"line\">    export_options_plist_path=$options_dir_path&quot;AppStoreExportOptions.plist&quot;</span><br><span class=\"line\">    export_type_name=&quot;AppStore&quot;</span><br><span class=\"line\">elif [[ $package_export_type -eq 3 ]]; then</span><br><span class=\"line\">    export_options_plist_path=$options_dir_path&quot;EnterpriseExportOptions.plist&quot;</span><br><span class=\"line\">    export_type_name=&quot;Enterprise&quot;</span><br><span class=\"line\">elif [[ $package_export_type -eq 4 ]]; then</span><br><span class=\"line\">    export_options_plist_path=$options_dir_path&quot;DevelopmentExportOptions.plist&quot;</span><br><span class=\"line\">    export_type_name=&quot;Development&quot;</span><br><span class=\"line\">fi</span><br><span class=\"line\"></span><br><span class=\"line\">echo &quot;âœ…âœ…âœ… æ ¡éªŒå‚æ•°ä»¥åŠç¯å¢ƒæˆåŠŸ&quot;</span><br><span class=\"line\">echo &quot;âš¡ï¸ âš¡ï¸ âš¡ï¸å³å°†å¼€å§‹æ‰“åŒ… âš¡ï¸ âš¡ï¸ âš¡ï¸&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">##############################è‡ªåŠ¨æ‰“åŒ…éƒ¨åˆ†##############################</span><br><span class=\"line\"></span><br><span class=\"line\"># è¿”å›åˆ°å·¥ç¨‹ç›®å½•</span><br><span class=\"line\">cd ../</span><br><span class=\"line\">project_path=`pwd`</span><br><span class=\"line\"></span><br><span class=\"line\"># è·å–é¡¹ç›®åç§°</span><br><span class=\"line\">project_name=`find . -name *.xcodeproj | awk -F &quot;[/.]&quot; &apos;&#123;print $(NF-1)&#125;&apos;`</span><br><span class=\"line\"># æŒ‡å®šå·¥ç¨‹çš„Info.plist</span><br><span class=\"line\">current_info_plist_name=&quot;Info.plist&quot;</span><br><span class=\"line\"># é…ç½®Info.plistçš„è·¯å¾„</span><br><span class=\"line\">current_info_plist_path=&quot;$&#123;project_name&#125;/$&#123;current_info_plist_name&#125;&quot;</span><br><span class=\"line\"># è·å–é¡¹ç›®çš„ç‰ˆæœ¬å·</span><br><span class=\"line\">bundle_version=`/usr/libexec/PlistBuddy -c &quot;Print CFBundleShortVersionString&quot; $&#123;current_info_plist_path&#125;`</span><br><span class=\"line\"># è·å–é¡¹ç›®çš„ç¼–è¯‘ç‰ˆæœ¬å·</span><br><span class=\"line\">bundle_build_version=`/usr/libexec/PlistBuddy -c &quot;Print CFBundleVersion&quot; $&#123;current_info_plist_path&#125;`</span><br><span class=\"line\"></span><br><span class=\"line\"># å½“å‰ç‰ˆæœ¬å­˜æ”¾å¯¼å‡ºæ–‡ä»¶è·¯å¾„ï¼Œå¯ä»¥æ ¹æ®éœ€æ±‚æ·»åŠ ä¸åŒçš„è·¯å¾„</span><br><span class=\"line\">currentVersionArchivePath=&quot;$&#123;package_archive_path&#125;&quot;</span><br><span class=\"line\"></span><br><span class=\"line\"># åˆ¤æ–­å½’æ¡£å½“å‰ç‰ˆæœ¬æ–‡ä»¶å¤¹æ˜¯å¦å­˜åœ¨ï¼Œä¸å­˜åœ¨åˆ™åˆ›å»º</span><br><span class=\"line\">if [ ! -d $currentVersionArchivePath ]; then</span><br><span class=\"line\">    mkdir -pv $currentVersionArchivePath</span><br><span class=\"line\">    chmod -R 777 $currentVersionArchivePath</span><br><span class=\"line\">fi</span><br><span class=\"line\"></span><br><span class=\"line\"># å½’æ¡£æ–‡ä»¶è·¯å¾„</span><br><span class=\"line\">export_archive_path=&quot;$&#123;currentVersionArchivePath&#125;$&#123;package_scheme_name&#125;.xcarchive&quot;</span><br><span class=\"line\"># ipaå¯¼å‡ºè·¯å¾„</span><br><span class=\"line\">export_ipa_path=&quot;$&#123;currentVersionArchivePath&#125;&quot;</span><br><span class=\"line\"># è·å–æ—¶é—´ å¦‚:20190630_1420</span><br><span class=\"line\"># current_date=&quot;$(date +%Y%m%d_%H%M)&quot;</span><br><span class=\"line\"># ipa åå­—, å¯ä»¥æ ¹æ®ç‰ˆæœ¬å·æ¥è¿›è¡Œé‡å‘½å</span><br><span class=\"line\">ipa_name=&quot;$&#123;package_scheme_name&#125;_$&#123;SVN_REVISION&#125;.ipa&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">echo &quot;å·¥ç¨‹ç›®å½• = $&#123;project_path&#125;&quot;</span><br><span class=\"line\">echo &quot;å·¥ç¨‹Info.plistè·¯å¾„ = $&#123;current_info_plist_path&#125;&quot;</span><br><span class=\"line\">echo &quot;æ‰“åŒ…ç±»å‹ = $&#123;build_configuration&#125;&quot;</span><br><span class=\"line\">echo &quot;æ‰“åŒ…ä½¿ç”¨çš„plistæ–‡ä»¶è·¯å¾„ = $&#123;export_options_plist_path&#125;&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">###############################æ‰“åŒ…éƒ¨åˆ†#########################################</span><br><span class=\"line\"></span><br><span class=\"line\">echo &quot;ğŸ”†ğŸ”†ğŸ”†æ­£åœ¨ä¸ºæ‚¨å¼€å§‹æ‰“åŒ…ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€&quot;</span><br><span class=\"line\"></span><br><span class=\"line\"># æ˜¯å¦ä½¿ç”¨xxx.xcworkspaceå·¥ç¨‹æ–‡ä»¶è¿›è¡Œæ‰“åŒ…</span><br><span class=\"line\">if $package_use_workspace; then</span><br><span class=\"line\"></span><br><span class=\"line\">    if [[ $&#123;build_configuration&#125; == &quot;Debug&quot; ]]; then</span><br><span class=\"line\">        # 1. Clean</span><br><span class=\"line\">        xcodebuild clean  -workspace $&#123;project_name&#125;.xcworkspace \\</span><br><span class=\"line\">        -scheme $&#123;package_scheme_name&#125; \\</span><br><span class=\"line\">        -configuration $&#123;build_configuration&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        # 2. Archive</span><br><span class=\"line\">        xcodebuild archive  -workspace $&#123;project_name&#125;.xcworkspace \\</span><br><span class=\"line\">        -scheme $&#123;package_scheme_name&#125; \\</span><br><span class=\"line\">        -configuration $&#123;build_configuration&#125; \\</span><br><span class=\"line\">        -archivePath $&#123;export_archive_path&#125; \\</span><br><span class=\"line\">        CFBundleVersion=$&#123;bundle_build_version&#125; \\</span><br><span class=\"line\">        -destination generic/platform=ios \\</span><br><span class=\"line\"></span><br><span class=\"line\">    elif [[ $&#123;build_configuration&#125; == &quot;Release&quot; ]]; then</span><br><span class=\"line\"></span><br><span class=\"line\">        # 1. Clean</span><br><span class=\"line\">        xcodebuild clean  -workspace $&#123;project_name&#125;.xcworkspace \\</span><br><span class=\"line\">        -scheme $&#123;package_scheme_name&#125; \\</span><br><span class=\"line\">        -configuration $&#123;build_configuration&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        # 2. Archive</span><br><span class=\"line\">        xcodebuild archive  -workspace $&#123;project_name&#125;.xcworkspace \\</span><br><span class=\"line\">        -scheme $&#123;package_scheme_name&#125; \\</span><br><span class=\"line\">        -configuration $&#123;build_configuration&#125; \\</span><br><span class=\"line\">        -archivePath $&#123;export_archive_path&#125; \\</span><br><span class=\"line\">        CFBundleVersion=$&#123;bundle_build_version&#125; \\</span><br><span class=\"line\">        -destination generic/platform=ios \\</span><br><span class=\"line\"></span><br><span class=\"line\">    fi</span><br><span class=\"line\"></span><br><span class=\"line\">else</span><br><span class=\"line\"></span><br><span class=\"line\">    if [[ $&#123;build_configuration&#125; == &quot;Debug&quot; ]] ; then</span><br><span class=\"line\">        # 1. Clean</span><br><span class=\"line\">        xcodebuild clean  -project $&#123;project_name&#125;.xcodeproj \\</span><br><span class=\"line\">        -scheme $&#123;package_scheme_name&#125; \\</span><br><span class=\"line\">        -configuration $&#123;build_configuration&#125; \\</span><br><span class=\"line\">        -alltargets</span><br><span class=\"line\"></span><br><span class=\"line\">        # 2. Archive</span><br><span class=\"line\">        xcodebuild archive  -project $&#123;project_name&#125;.xcodeproj \\</span><br><span class=\"line\">        -scheme $&#123;package_scheme_name&#125; \\</span><br><span class=\"line\">        -configuration $&#123;build_configuration&#125; \\</span><br><span class=\"line\">        -archivePath $&#123;export_archive_path&#125; \\</span><br><span class=\"line\">        CFBundleVersion=$&#123;bundle_build_version&#125; \\</span><br><span class=\"line\">        -destination generic/platform=ios \\</span><br><span class=\"line\"></span><br><span class=\"line\">    elif [[ $&#123;build_configuration&#125; == &quot;Release&quot; ]]; then</span><br><span class=\"line\">        # 1. Clean</span><br><span class=\"line\">        xcodebuild clean  -project $&#123;project_name&#125;.xcodeproj \\</span><br><span class=\"line\">        -scheme $&#123;package_scheme_name&#125; \\</span><br><span class=\"line\">        -configuration $&#123;build_configuration&#125; \\</span><br><span class=\"line\">        -alltargets</span><br><span class=\"line\"></span><br><span class=\"line\">        # 2. Archive</span><br><span class=\"line\">        xcodebuild archive  -project $&#123;project_name&#125;.xcodeproj \\</span><br><span class=\"line\">        -scheme $&#123;package_scheme_name&#125; \\</span><br><span class=\"line\">        -configuration $&#123;build_configuration&#125; \\</span><br><span class=\"line\">        -archivePath $&#123;export_archive_path&#125; \\</span><br><span class=\"line\">        CFBundleVersion=$&#123;bundle_build_version&#125; \\</span><br><span class=\"line\">        -destination generic/platform=ios \\</span><br><span class=\"line\"></span><br><span class=\"line\">    fi</span><br><span class=\"line\">fi</span><br><span class=\"line\"></span><br><span class=\"line\"># æ£€æŸ¥æ˜¯å¦æ„å»ºæˆåŠŸ</span><br><span class=\"line\"># å› ä¸ºxxx.xcarchive æ˜¯ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸æ˜¯ä¸€ä¸ªæ–‡ä»¶</span><br><span class=\"line\">if [ -d $&#123;export_archive_path&#125; ]; then</span><br><span class=\"line\">    echo &quot;ğŸš€ ğŸš€ ğŸš€ é¡¹ç›®æ„å»ºæˆåŠŸ ğŸš€ ğŸš€ ğŸš€&quot;</span><br><span class=\"line\">else</span><br><span class=\"line\">    echo &quot;âš ï¸ âš ï¸ âš ï¸ é¡¹ç›®æ„å»ºå¤±è´¥ âš ï¸ âš ï¸ âš ï¸&quot;</span><br><span class=\"line\">    exit 1</span><br><span class=\"line\">fi</span><br><span class=\"line\"></span><br><span class=\"line\">echo &quot;å¼€å§‹å¯¼å‡ºipaæ–‡ä»¶&quot;</span><br><span class=\"line\"># å¯¼å‡ºipaæ–‡ä»¶</span><br><span class=\"line\">xcodebuild -exportArchive -archivePath $&#123;export_archive_path&#125; \\</span><br><span class=\"line\">-exportPath $&#123;export_ipa_path&#125; \\</span><br><span class=\"line\">-destination generic/platform=ios \\</span><br><span class=\"line\">-exportOptionsPlist $&#123;export_options_plist_path&#125; \\</span><br><span class=\"line\">-allowProvisioningUpdates</span><br><span class=\"line\"># é»˜è®¤å¯¼å‡ºipaæ–‡ä»¶è·¯å¾„</span><br><span class=\"line\">export_ipa_name=$export_ipa_path$package_scheme_name&quot;.ipa&quot;</span><br><span class=\"line\"></span><br><span class=\"line\"># åˆ¤æ–­æ˜¯å¦æœ‰è¿™ä¸ªå¯¼å‡ºipaæ–‡ä»¶</span><br><span class=\"line\">if [ -e $export_ipa_name ]; then</span><br><span class=\"line\">    # æ›´æ”¹åç§°ä¸º scheme_version.ipa schemeåç§°ä¸ºå·¥ç¨‹åç§°ï¼Œversionä¸ºsvnæœ€åæäº¤çš„ç‰ˆæœ¬</span><br><span class=\"line\">    mv $export_ipa_name $export_ipa_path$ipa_name</span><br><span class=\"line\">    # å°†å½“å‰ç‰ˆæœ¬è®¾ä¸ºå·²æ‰“åŒ…çŠ¶æ€</span><br><span class=\"line\">    echo lastestBuildVersion=$SVN_REVISION &gt; $package_root_path&quot;result.txt&quot;</span><br><span class=\"line\">    echo &quot;ğŸ‰ ğŸ‰ ğŸ‰ å¯¼å‡º $&#123;ipa_name&#125;.ipa åŒ…æˆåŠŸ ğŸ‰ ğŸ‰ ğŸ‰&quot;</span><br><span class=\"line\">else</span><br><span class=\"line\">    echo &quot;âŒ âŒ âŒ å¯¼å‡º $&#123;ipa_name&#125;.ipa åŒ…å¤±è´¥ âŒ âŒ âŒ&quot;</span><br><span class=\"line\">fi</span><br><span class=\"line\"></span><br><span class=\"line\"># è¾“å‡ºæ‰“åŒ…æ€»ç”¨æ—¶</span><br><span class=\"line\">echo &quot;æœ¬æ¬¡æ‰“åŒ…æ€»è€—æ—¶: $&#123;SECONDS&#125;s&quot;</span><br></pre></td></tr></table></figure>\n\n<p>æ˜¯ä¸æ˜¯æœ‰ç‚¹å¤´æ™•å“‡ï¼Œæˆ‘æ˜¯å¤´ç—›å•ŠğŸ¤—ğŸ¤—ï¼Œç©è¿‡ä½¿ç”¨<strong>Jenkins</strong>è„šæœ¬è‡ªåŠ¨æ‰“åŒ…çš„äººçœ‹å®Œè¿™ä¸ªåº”è¯¥çŸ¥é“æˆ‘çš„æ›²çº¿æ•‘å›½æ–¹å¼äº†ï¼Œæœ‰çš„åŒå­¦è‚¯å®šè¿˜åœ¨ğŸ˜³ğŸ˜³orğŸ¤”ğŸ¤”ã€‚æˆ‘ä»¬åœ¨<strong>é‡å¤´æˆ</strong>ä¸­è®²ğŸ¤—ğŸ¤—ã€‚</p>\n<h3 id=\"é‡å¤´æˆ\"><a href=\"#é‡å¤´æˆ\" class=\"headerlink\" title=\"é‡å¤´æˆ\"></a>é‡å¤´æˆ</h3><p>çœ‹é£æ ¼æˆ‘å°±ä¸æ˜¯å¼€è½¦çš„äººï¼Œå› ä¸ºå¼€è½¦å“ªæ¥è¿™ä¹ˆå¤šå‰æˆæ˜¯å§ï¼ŸğŸ¤”ğŸ¤”ï¼Œå¼€å§‹å‰¥ä¸æŠ½èŒ§å•¦ã€‚</p>\n<p>å‰é¢è¯´åˆ°åœ¨<strong>Jenkins</strong>ä¸­æ²¡æœ‰ç±»ä¼¼<strong>Git</strong>è¿™æ ·çš„æäº¤ä»£ç è‡ªåŠ¨æ‰“åŒ…çš„é’©å­æ’ä»¶ã€‚è€Œæˆ‘ä»¬ä½¿ç”¨<strong>Jenkins</strong>çš„ç›®çš„å°±æ˜¯ä¸ºäº†é‡Šæ”¾ç¨‹åºå‘˜çš„ğŸ‘ï¼Œç•™ç€æ›´å¤šæ—¶é—´å¹²æ­£äº‹ï¼Œå¦‚æœä¸èƒ½å®ç°æäº¤è‡ªåŠ¨æ‰“åŒ…é‚£æœ‰æ— <strong>Jenkins</strong>éƒ½ä¸€æ ·äº†ï¼Œè¿˜ä¸å¦‚è‡ªå·±å†™ä¸ªè„šæœ¬æ‰“åŒ…å‘¢ï¼Œæ˜¯å§ï¼Ÿå¦‚æœæ˜¯ä½ ä½ ä¼šæ€ä¹ˆåšå‘¢ï¼Ÿ</p>\n<p>æˆ‘ä»¬çŸ¥é“Jenkinsæœ‰ä¸ªå®šæœŸæ‰§è¡Œä»»åŠ¡çš„é€‰é¡¹ï¼Œæˆ‘ä»¬åªéœ€å¡«ä¸Šå‚æ•°ï¼šH/2 * * * *  ç„¶åå°±ä¼šæ¯ä¸¤åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ï¼Œæ˜¯ä¸æ˜¯æƒ³è¯´ä¸ºå•¥ä¸è®¾ç½®1åˆ†é’Ÿï¼Œæˆ‘ä¹Ÿæƒ³å“‡ï¼Œ<strong>Jenkins</strong>ä¸è®©å•ŠğŸ˜ğŸ˜ã€‚ä½†æ˜¯æ€»ä¸èƒ½è®©è¿™å®¶ä¼™æ¯ä¸¤åˆ†é’Ÿä¸€ç›´æ‰“å§ï¼Œè¦†ç›–è¿˜å¥½ï¼Œä½†æ˜¯æ¯ä¸¤åˆ†é’Ÿå°±æœ‰ä¸€ä¸ªæ–°çš„å®‰è£…åŒ…ä¸Šä¼ è‡³æµ‹è¯•æœåŠ¡å™¨ä¹Ÿä¸å¥½å§ï¼Œæ„Ÿè§‰ä¼šè¢«æµ‹è¯•äººå‘˜æ‰“å±ğŸ˜±ğŸ˜±ã€‚é‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦è§£å†³è¿™ä¸ªæ‰“æ–­æ‰“åŒ…çš„æ¡ä»¶ğŸ¤”ã€‚æ—¢ä¸èƒ½åœ¨å·¥ç¨‹ä¸­è®¾ç½®ï¼Œä¸ç„¶<strong>Jenkins</strong>æ¯æ¬¡æ‰§è¡Œä»»åŠ¡å°±è¦†ç›–äº†ï¼Œä¹Ÿå°±æ˜¯åªèƒ½åœ¨æ‰“åŒ…ç”µè„‘ä¸Šä¿å­˜ä¸€ä¸ªçŠ¶æ€ã€‚é‚£ä¹ˆå¾ˆå¥½è§£å†³å•¦ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨è„šæœ¬ä¸­åˆ›å»ºä¸€ä¸ªæ–‡ä»¶æ¥è®°å½•ä¸Šæ¬¡æ‰“åŒ…çš„<strong>SVN_REVISION</strong>ï¼Œå°±èƒ½è®©è„šæœ¬è¯»å–æ–‡ä»¶è®°å½•åˆ¤æ–­æ˜¯å¦å·²ç»æ‰“è¿‡åŒ…äº†ï¼Œæ²¡æœ‰æ‰“è¿‡åŒ…æ‰æ‰§è¡Œç¨‹åºï¼Œå¦åˆ™é€€å‡ºç¨‹åºã€‚ğŸ˜‰ğŸ˜‰ç°åœ¨æƒ³æƒ³æ˜¯ä¸æ˜¯å¾ˆç®€å•å“‡ï¼Œç„¶åå°±å¯ä»¥å°½æƒ…çš„å“’å“’å“’ã€‚</p>\n<p>ä½¿ç”¨FTPä¸Šä¼ è‡³æµ‹è¯•æœåŠ¡å™¨è¿™éƒ¨åˆ†è¯¥å¦‚ä½•è§£å†³å‘¢ï¼Ÿå› ä¸ºæ¶‰åŠåˆ°å¯å˜å‚æ•°ï¼Œè„šæœ¬é‚£ä¹ˆå·®çš„æˆ‘åªèƒ½ä½¿ç”¨åœŸåŠæ³•ï¼Œä¸€æ‹›ä¸€æ‹›æ¥ï¼Œå¹²åˆ°ä¸æœä¸ºæ­¢ğŸ˜ğŸ˜ã€‚è¿™éƒ¨åˆ†è„šæœ¬æ˜¯ä¸Šé¢é‚£é•¿ä¸²ä»£ç çš„æœ«å°¾åçš„ä»£ç ã€‚</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">############################ä¸Šä¼ éƒ¨åˆ†#####################################</span><br><span class=\"line\"></span><br><span class=\"line\">function createUploadShell()&#123;</span><br><span class=\"line\">    touch upload.sh</span><br><span class=\"line\">    chmod -R 777 upload.sh</span><br><span class=\"line\">    echo &quot;cd $&#123;package_archive_path&#125;&quot; &gt;&gt; upload.sh</span><br><span class=\"line\">    echo &quot;ftp -i -n -v &lt;&lt; !&quot; &gt;&gt; upload.sh</span><br><span class=\"line\">    echo &quot;open 117.xx.xxx.xxx&quot; &gt;&gt; upload.sh</span><br><span class=\"line\">    echo &quot;user oymuzi xxxx&quot; &gt;&gt; upload.sh</span><br><span class=\"line\">    echo &quot;cd ./$&#123;upload_dir_path&#125;&quot; &gt;&gt; upload.sh</span><br><span class=\"line\">    current_date=&quot;$(date +%Y%m%d%H%M%S)&quot;</span><br><span class=\"line\">    ipa_new_name=$package_scheme_name&quot;_&quot;$current_date&quot;.ipa&quot;</span><br><span class=\"line\">    echo &quot;binary&quot; &gt;&gt; upload.sh</span><br><span class=\"line\">    echo &quot;put $&#123;upload_volumes_name&#125;$&#123;package_archive_path&#125;$&#123;ipa_name&#125; ./$&#123;ipa_new_name&#125;&quot; &gt;&gt; upload.sh</span><br><span class=\"line\">    echo &quot;close&quot; &gt;&gt; upload.sh</span><br><span class=\"line\">    echo &quot;bye&quot; &gt;&gt; upload.sh</span><br><span class=\"line\">    echo &quot;!&quot; &gt;&gt; upload.sh</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">cd $package_archive_path</span><br><span class=\"line\">createUploadShell</span><br><span class=\"line\">echo &quot;åˆ›å»ºä¸Šä¼ è„šæœ¬æˆåŠŸ&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">echo &quot;ğŸš€ ğŸš€ ğŸš€ å¼€å§‹ä¸Šä¼ è‡³äº‘ç«¯  ğŸš€ ğŸš€ ğŸš€&quot;</span><br><span class=\"line\">sh upload.sh</span><br><span class=\"line\">echo &quot;ä¸Šä¼ è‡³äº‘ç«¯å®Œæˆ&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">rm -f upload.sh</span><br></pre></td></tr></table></figure>\n\n<p>å¯¹ï¼Œå°±æ˜¯è¿™ä¹ˆfeel å€çˆ½ï¼Œå¤§ä½¬å¯ä»¥è‡ªå·±è¿›è¡Œæ›´æ”¹è„šæœ¬ã€‚å…¶ä¸­ä¸€ç‚¹å°±æ˜¯ä½¿ç”¨FTPå‘½ä»¤å¿…é¡»ä½¿ç”¨<code>ftp -i -n -v &lt;&lt; !  ä½ æƒ³è¦çš„æ‰§è¡Œçš„FTPå‘½ä»¤  !</code>ã€‚è‡³äºä¸Šä¼ å…¬å¸æœåŠ¡å™¨è¿˜æ˜¯è’²å…¬è‹±ç­‰å¹³å°ï¼Œè¿™ä¸ªå¯ä»¥æ ¹æ®å„è‡ªå…¬å¸çš„è§„åˆ™å§ï¼Œè‡ªå·±è¿›è¡Œä¿®æ”¹å“ˆã€‚</p>\n<p>æºç åœ°å€ï¼š<a href=\"https://github.com/oymuzi/OMPackaging\" target=\"_blank\" rel=\"noopener\">OMPackaging</a>(æ³¨ï¼šæ­¤demoä»…ä¸ºäº†å±•ç¤ºæºç ï¼ŒæŒ‰ç…§æºç å’Œæ–‡ç« æ‰€è¯´çš„åŠæ³•è®¾ç½®ç¯å¢ƒå³å¯æ­£å¸¸æ‰“åŒ…)</p>\n<h3 id=\"è¨€å½’æ­£ä¼ \"><a href=\"#è¨€å½’æ­£ä¼ \" class=\"headerlink\" title=\"è¨€å½’æ­£ä¼ \"></a>è¨€å½’æ­£ä¼ </h3><p>åˆ©ç”¨<strong>Jenkins</strong>çš„å®šæ­»æ‰§è¡Œä»»åŠ¡åŠŸèƒ½ï¼Œåœ¨æœ¬åœ°ä¿å­˜ä¸€ä¸ªæ‰“åŒ…çš„çŠ¶æ€ï¼Œç„¶åå°±èƒ½æ¯æ¬¡æäº¤ä»£ç åè¿›è¡Œè‡ªåŠ¨æ‰“åŒ…ï¼Œæœ‰1-2åˆ†é’Ÿçš„å»¶è¿Ÿï¼Œè€Œä¸”è¦æ‰§è¡Œæ‰“åŒ…å¿…é¡»ç¡®ä¿é…ç½®æ–‡ä»¶ä¸­çš„<code>is_need_package</code>ä¸ºtrueå¹¶æäº¤ä¸€æ¬¡ä»£ç ã€‚åœ¨ä¸Šä¼ è‡³æµ‹è¯•æœåŠ¡å™¨ï¼Œæµ‹è¯•äººå‘˜å°±èƒ½ç›´æ¥ä¸‹è½½å®‰è£…ã€‚è¿™ä¸ªæ–¹æ¡ˆè™½ç„¶æœ‰äº›å»¶è¿Ÿï¼Œä½†æ˜¯è§£å†³äº†è‡ªåŠ¨æ‰“åŒ…çš„é—®é¢˜ã€‚</p>\n<p>å‚è€ƒï¼š</p>\n<p><a href=\"https://blog.csdn.net/weixinyi21cn/article/details/79151620\" target=\"_blank\" rel=\"noopener\">Mac shell ä¸Šä¼ æ–‡ä»¶(åœ¨shellä¸­ä½¿ç”¨FTPå‘½ä»¤)</a></p>\n<p><a href=\"https://developer.apple.com/library/archive/technotes/tn2339/_index.html\" target=\"_blank\" rel=\"noopener\">Building from the Command Line with Xcode FAQ</a></p>"}],"PostAsset":[],"PostCategory":[],"PostTag":[],"Tag":[]}}